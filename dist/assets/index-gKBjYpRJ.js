import{r as b,j as e}from"./react-BVBiHVO-.js";import{r as He,c as vt}from"./react-dom-C1qW5AtE.js";import{g as wt,o as kt,s as St,a as Dt}from"./firebase-DXYueZsg.js";import{y as Ct,z as zt,A as $t,B as he,D as ze,G as It,H as st,I as je,J as bt,K as Le,M as Se,N as At,O as Ze,P as Ot,Q as Et,R as Mt,T as Tt,U as Lt}from"./@firebase-BQo0rUhx.js";import{S as Fe,X as xe,M as gt,a as we,A as ke,C as Pe,b as Je,c as $e,N as nt,d as be,P as Ie,T as pt,U as ye,e as qe,f as Re,g as pe,h as _e,L as ut,i as Ft,D as at,j as De,k as Xe,W as Pt,l as de,m as Ae,n as Rt,Z as _t,o as We,p as ot,q as Ce,F as ft,r as Ut,s as qt,t as Gt,u as dt,v as et,w as ge,x as tt,y as Oe,B as Ye,z as it,E as ue,G as Ne,H as Ht,I as ve,J as jt,K as lt,O as Jt,Q as Wt,R as ct,V as Ee,Y as yt,_ as Yt,$ as Nt,a0 as Bt,a1 as Kt,a2 as Vt,a3 as Qt,a4 as Zt}from"./lucide-react-DgQRNr6b.js";import"./scheduler-DYLXRpC5.js";import"./idb-BXWtuYvb.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))x(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&x(s)}).observe(document,{childList:!0,subtree:!0});function n(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerPolicy&&(i.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?i.credentials="include":l.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function x(l){if(l.ep)return;l.ep=!0;const i=n(l);fetch(l.href,i)}})();const Xt={apiKey:"AIzaSyCKMrH2E_GP_MYZJrhF4LbxC1LmtVGx3Co",authDomain:"brave-academy.firebaseapp.com",projectId:"brave-academy",storageBucket:"brave-academy.firebasestorage.app",messagingSenderId:"862804404676",appId:"1:862804404676:web:871e3bb0796c354f1f5c91"},rt=Ct(Xt),Be=wt(rt),te=zt(rt),es=$t(rt),ce="brave-academy-live-data",le=(a,r=[])=>{const[n,x]=b.useState([]),[l,i]=b.useState(!0),s=JSON.stringify(r);return b.useEffect(()=>{let c=he(te,"artifacts",ce,"public","data",a),d;r&&r.length>0?d=ze(c,...r):d=ze(c);const S=It(d,u=>{const j=u.docs.map(h=>({...h.data(),id:h.id}));x(j),i(!1)},u=>{console.error(`Error fetching ${a}:`,u),i(!1)});return()=>S()},[a,s]),{data:n,loading:l,add:async c=>{try{const d={...c,createdAt:new Date().toISOString()};return await Le(he(te,"artifacts",ce,"public","data",a),d),!0}catch(d){return console.error(d),alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸ØŒ ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„"),!1}},update:async(c,d)=>{try{await bt(je(te,"artifacts",ce,"public","data",a,c),d)}catch(S){console.error(S)}},remove:async c=>{try{await st(je(te,"artifacts",ce,"public","data",a,c))}catch(d){console.error(d)}}}},L=({children:a,onClick:r,variant:n="primary",className:x="",type:l="button"})=>{const i={primary:"bg-yellow-500 text-black hover:bg-yellow-400 border border-yellow-600 font-bold",secondary:"bg-gray-800 text-white hover:bg-gray-700",danger:"bg-red-600 text-white hover:bg-red-700",outline:"border-2 border-yellow-500 text-yellow-600 hover:bg-yellow-50",ghost:"bg-transparent text-gray-600 hover:bg-gray-100"};return e.jsx("button",{type:l,onClick:r,className:`px-4 py-2 rounded-lg transition duration-200 flex items-center justify-center gap-2 shadow-sm ${i[n]} ${x}`,children:a})},J=({children:a,className:r="",title:n,action:x,noPadding:l=!1})=>e.jsxs("div",{className:`bg-white rounded-xl shadow-md border border-gray-100 overflow-hidden ${r}`,children:[(n||x)&&e.jsxs("div",{className:"px-4 py-3 md:px-6 md:py-4 border-b border-gray-100 flex flex-col md:flex-row justify-between items-start md:items-center bg-gray-50/50 gap-2",children:[n&&e.jsx("h3",{className:"font-bold text-gray-800 text-lg",children:n}),x&&e.jsx("div",{className:"self-end md:self-auto",children:x})]}),e.jsx("div",{className:l?"":"p-4 md:p-6",children:a})]}),Me=({status:a})=>{const r={active:{text:"ÙØ¹Ø§Ù„",style:"bg-green-100 text-green-800 border-green-200"},near_end:{text:"Ù‚Ø§Ø±Ø¨ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡",style:"bg-yellow-100 text-yellow-800 border-yellow-200"},expired:{text:"Ù…Ù†ØªÙ‡ÙŠ",style:"bg-red-100 text-red-800 border-red-200"}},n=r[a]||r.active;return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-bold border ${n.style}`,children:n.text})},Ge=({students:a,onSelect:r,placeholder:n="Ø¨Ø­Ø« Ø¹Ù† Ø·Ø§Ù„Ø¨...",showAllOption:x=!1,onClear:l})=>{const[i,s]=b.useState(""),[m,v]=b.useState(!1),w=b.useMemo(()=>i?a.filter(c=>c.name.includes(i)):a,[a,i]);return e.jsxs("div",{className:"relative w-full",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",className:"w-full border p-2 pr-8 rounded focus:ring-2 focus:ring-yellow-500 outline-none",placeholder:n,value:i,onChange:c=>{s(c.target.value),v(!0),c.target.value===""&&l&&l()},onFocus:()=>v(!0),onBlur:()=>setTimeout(()=>v(!1),200)}),e.jsx(Fe,{className:"absolute left-2 top-2.5 text-gray-400",size:16}),i&&e.jsx("button",{onClick:()=>{s(""),l&&l()},className:"absolute left-8 top-2.5 text-gray-400 hover:text-red-500",children:e.jsx(xe,{size:16})})]}),m&&e.jsxs("div",{className:"absolute z-50 w-full bg-white border rounded shadow-lg max-h-48 overflow-y-auto mt-1",children:[x&&e.jsx("div",{className:"p-2 hover:bg-gray-100 cursor-pointer text-sm border-b font-bold text-blue-600",onClick:()=>{s(""),l&&l(),v(!1)},children:"Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„"}),w.length>0?w.map(c=>e.jsxs("div",{className:"p-2 hover:bg-yellow-50 cursor-pointer text-sm border-b last:border-0 flex justify-between items-center",onClick:()=>{s(c.name),r(c),v(!1)},children:[e.jsx("span",{className:"font-bold",children:c.name}),e.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-0.5 rounded",children:c.belt})]},c.id)):e.jsx("div",{className:"p-2 text-gray-500 text-sm text-center",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬"})]})]})},oe={LOGO:"/logo.jpg",HERO_BG:"/hero.jpg",BRANCH_SHAFA:"/shafa.jpg",BRANCH_ABU_NSEIR:"/abunseir.jpg"},se={SHAFA:"Ø´ÙØ§ Ø¨Ø¯Ø±Ø§Ù†",ABU_NSEIR:"Ø£Ø¨Ùˆ Ù†ØµÙŠØ±"},V=["Ø£Ø¨ÙŠØ¶","Ø£ØµÙØ±","Ø£Ø®Ø¶Ø± 1","Ø£Ø®Ø¶Ø± 2","Ø£Ø²Ø±Ù‚ 1","Ø£Ø²Ø±Ù‚ 2","Ø¨Ù†ÙŠ 1","Ø¨Ù†ÙŠ 2","Ø£Ø­Ù…Ø± 1","Ø£Ø­Ù…Ø± 2","Ø£Ø³ÙˆØ¯"],ts=[{id:1,days:"Ø§Ù„Ø³Ø¨Øª / Ø§Ù„Ø§Ø«Ù†ÙŠÙ† / Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡",time:"4:00 Ù… - 5:00 Ù…",level:"Ù…Ø¨ØªØ¯Ø¦ÙŠÙ† (Ø£Ø¨ÙŠØ¶ - Ø£ØµÙØ±)",branch:"Ù…Ø´ØªØ±Ùƒ"},{id:2,days:"Ø§Ù„Ø³Ø¨Øª / Ø§Ù„Ø§Ø«Ù†ÙŠÙ† / Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡",time:"5:00 Ù… - 6:30 Ù…",level:"Ø£Ø­Ø²Ù…Ø© Ù…Ù„ÙˆÙ†Ø© (Ø£Ø®Ø¶Ø± - Ø£Ø²Ø±Ù‚)",branch:"Ù…Ø´ØªØ±Ùƒ"},{id:3,days:"Ø§Ù„Ø£Ø­Ø¯ / Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡ / Ø§Ù„Ø®Ù…ÙŠØ³",time:"5:00 Ù… - 6:30 Ù…",level:"Ù…ØªÙ‚Ø¯Ù… (Ø£Ø­Ù…Ø± - Ø£Ø³ÙˆØ¯)",branch:"Ù…Ø´ØªØ±Ùƒ"},{id:4,days:"Ø§Ù„Ø¬Ù…Ø¹Ø©",time:"9:00 Øµ - 11:00 Øµ",level:"ÙØ±ÙŠÙ‚ Ø§Ù„Ù…Ù†ØªØ®Ø¨Ø§Øª",branch:"Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ"}],ss=({setView:a,schedule:r})=>{const[n,x]=b.useState(!1),[l,i]=b.useState(!1),[s,m]=b.useState({name:"",phone:"",dob:"",address:"",branch:se.SHAFA}),[v,w]=b.useState(!1),{data:c}=le("news"),[d,S]=b.useState(0);b.useEffect(()=>{if(!c||c.length===0)return;const f=setInterval(()=>{S(p=>(p+1)%c.length)},8e3);return()=>clearInterval(f)},[c]);const u=async f=>{f.preventDefault(),w(!0);try{await Le(he(te,"artifacts",ce,"public","data","registrations"),{...s,date:new Date().toLocaleDateString("ar-JO"),status:"new",createdAt:new Date().toISOString()}),alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­! Ø³Ù†ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‚Ø±ÙŠØ¨Ø§Ù‹."),i(!1),m({name:"",phone:"",dob:"",address:"",branch:se.SHAFA})}catch(p){console.error("Error adding document: ",p),alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.")}finally{w(!1)}},j=f=>window.open(f,"_blank"),h=()=>window.open("https://wa.me/962795629606","_blank");return e.jsxs("div",{className:"min-h-screen font-sans text-right relative bg-white",dir:"rtl",children:[e.jsxs("header",{className:"bg-black text-white shadow-lg sticky top-0 z-50 border-b-2 border-yellow-500",children:[e.jsxs("div",{className:"container mx-auto px-6 py-4 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3 cursor-pointer group",onClick:()=>window.scrollTo(0,0),children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:oe.LOGO,alt:"Logo",className:"w-12 h-12 rounded-full bg-white p-1 object-contain transition-transform group-hover:scale-110"}),e.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-yellow-500 animate-pulse"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-extrabold leading-none text-yellow-500",children:"Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø§Ù„Ø´Ø¬Ø§Ø¹"}),e.jsx("p",{className:"text-[10px] text-gray-400 tracking-wider uppercase font-bold",children:"Brave Taekwondo"})]})]}),e.jsx("nav",{className:"hidden md:flex gap-8 font-bold text-sm",children:["Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©","Ù…Ù† Ù†Ø­Ù†","Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø­ØµØµ","Ø§Ù„ÙØ±ÙˆØ¹"].map(f=>e.jsxs("button",{className:"hover:text-yellow-500 transition-colors duration-300 relative group",onClick:()=>{var p,I;f==="Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø­ØµØµ"&&((p=document.getElementById("schedule"))==null||p.scrollIntoView({behavior:"smooth"})),f==="Ø§Ù„ÙØ±ÙˆØ¹"&&((I=document.getElementById("branches"))==null||I.scrollIntoView({behavior:"smooth"})),f==="Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"&&window.scrollTo(0,0)},children:[f,e.jsx("span",{className:"absolute -bottom-1 right-0 w-0 h-0.5 bg-yellow-500 transition-all group-hover:w-full"})]},f))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(L,{onClick:()=>a("login"),className:"bg-yellow-500 text-black hover:bg-yellow-400 font-black px-6 border-none hidden md:block transform hover:-translate-y-1 transition-transform",children:"Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡"}),e.jsx("button",{className:"md:hidden p-2 text-yellow-500",onClick:()=>x(!n),children:n?e.jsx(xe,{size:24}):e.jsx(gt,{size:24})})]})]}),n&&e.jsx("div",{className:"md:hidden bg-gray-900 border-t border-gray-800 p-4 flex flex-col gap-4",children:e.jsx(L,{onClick:()=>{x(!1),a("login")},className:"w-full py-3 bg-yellow-500 text-black font-bold",children:"Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡"})})]}),e.jsxs("div",{className:"relative bg-gray-900 text-white h-[600px] flex items-center shadow-2xl overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-1/2 h-full bg-yellow-500/10 -skew-x-12 transform origin-top translate-x-20"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-black via-black/70 to-transparent z-10"}),e.jsx("img",{src:oe.HERO_BG,alt:"Hero",className:"absolute inset-0 w-full h-full object-cover"}),e.jsxs("div",{className:"container mx-auto px-6 relative z-20 flex flex-col items-start pt-10",children:[e.jsx("div",{className:"inline-block bg-yellow-500 text-black font-black px-4 py-1 rounded-none skew-x-[-10deg] mb-6 animate-fade-in-up",children:e.jsx("span",{className:"block skew-x-[10deg] text-sm tracking-wider",children:"Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ù…ÙØªÙˆØ­ Ø§Ù„Ø¢Ù†"})}),e.jsxs("h2",{className:"text-6xl md:text-8xl font-black mb-6 leading-tight drop-shadow-lg",children:["Ø§ØµÙ†Ø¹ ",e.jsx("span",{className:"text-yellow-500",children:"Ù‚ÙˆØªÙƒ"}),e.jsx("br",{}),"Ø§Ø¨Ù†Ù Ù…Ø³ØªÙ‚Ø¨Ù„Ùƒ"]}),e.jsx("p",{className:"text-gray-300 text-lg mb-8 max-w-lg font-medium",children:"Ø§Ù†Ø¶Ù… Ø¥Ù„Ù‰ Ù†Ø®Ø¨Ø© Ø£Ø¨Ø·Ø§Ù„ Ø§Ù„Ø£Ø±Ø¯Ù† ÙÙŠ Ø§Ù„ØªØ§ÙŠÙƒÙˆÙ†Ø¯Ùˆ. ØªØ¯Ø±ÙŠØ¨ Ø§Ø­ØªØ±Ø§ÙÙŠØŒ Ø¨ÙŠØ¦Ø© Ø¢Ù…Ù†Ø©ØŒ ÙˆÙ…Ø³ØªÙ‚Ø¨Ù„ ÙˆØ§Ø¹Ø¯."}),e.jsx("div",{className:"flex gap-4",children:e.jsx(L,{onClick:()=>i(!0),className:"px-10 py-4 text-xl bg-yellow-500 text-black font-black hover:bg-yellow-400 hover:scale-105 transition-all shadow-[0_0_20px_rgba(234,179,8,0.5)] border-none",children:"Ø§Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙƒ"})})]})]}),c&&c.length>0&&e.jsx("section",{className:"relative -mt-16 z-30 mb-20",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsx("div",{className:"relative w-full max-w-5xl mx-auto h-[450px] bg-white rounded-2xl overflow-hidden shadow-2xl border-t-8 border-yellow-500 flex flex-col md:flex-row",children:c.map((f,p)=>e.jsxs("div",{className:`absolute inset-0 flex flex-col md:flex-row transition-all duration-700 ease-in-out ${p===d?"opacity-100 z-10":"opacity-0 z-0"}`,children:[e.jsxs("div",{className:"w-full md:w-1/2 h-1/2 md:h-full relative overflow-hidden",children:[f.image?e.jsx("img",{src:f.image,alt:f.title,className:"w-full h-full object-cover transition-transform duration-[10000ms] ease-linear transform scale-100 hover:scale-110"}):e.jsx("div",{className:"w-full h-full bg-gray-100 flex items-center justify-center",children:e.jsx(we,{size:64,className:"text-gray-300"})}),e.jsx("div",{className:"absolute top-4 right-4 bg-yellow-500 text-black text-xs font-bold px-3 py-1 shadow-md",children:f.branch})]}),e.jsxs("div",{className:"w-full md:w-1/2 h-1/2 md:h-full bg-white p-8 flex flex-col justify-center text-right relative",children:[e.jsxs("div",{className:"flex items-center gap-2 text-yellow-600 font-bold mb-2 text-sm uppercase tracking-wide",children:[e.jsx(ke,{size:16}),e.jsx("span",{children:"Ø£Ø­Ø¯Ø« Ø§Ù„Ø£Ø®Ø¨Ø§Ø±"})]}),e.jsx("h3",{className:"text-2xl md:text-4xl font-black text-gray-900 mb-4 leading-tight",children:f.title}),e.jsx("p",{className:"text-gray-600 leading-relaxed text-sm md:text-base",children:f.desc}),e.jsxs("div",{className:"flex gap-2 mt-8",children:[e.jsx("button",{onClick:()=>S(I=>(I-1+c.length)%c.length),className:"w-10 h-10 rounded-full border border-gray-200 flex items-center justify-center hover:bg-black hover:text-white transition-colors",children:e.jsx(Pe,{size:20})}),e.jsx("button",{onClick:()=>S(I=>(I+1)%c.length),className:"w-10 h-10 rounded-full border border-gray-200 flex items-center justify-center hover:bg-black hover:text-white transition-colors",children:e.jsx(Je,{size:20})})]})]})]},f.id))})})}),e.jsx("section",{id:"branches",className:"py-24 bg-white",children:e.jsxs("div",{className:"container mx-auto px-6",children:[e.jsxs("div",{className:"flex flex-col items-center mb-16",children:[e.jsx("h2",{className:"text-5xl font-black text-gray-900 mb-4 tracking-tight",children:"ÙØ±ÙˆØ¹Ù†Ø§"}),e.jsx("div",{className:"w-24 h-2 bg-yellow-500 rounded-full"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"group relative h-[500px] w-full rounded-[2.5rem] overflow-hidden shadow-2xl cursor-default",children:[e.jsx("img",{src:oe.BRANCH_SHAFA,alt:"Shafa",className:"absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/60 to-transparent opacity-90 transition-opacity duration-300"}),e.jsx("div",{className:"absolute inset-0 p-8 md:p-12 flex flex-col justify-end",children:e.jsxs("div",{className:"transform transition-transform duration-500 translate-y-4 group-hover:translate-y-0",children:[e.jsx("div",{className:"flex justify-between items-end mb-4",children:e.jsxs("div",{children:[e.jsx("span",{className:"inline-block bg-yellow-500 text-black text-xs font-black px-3 py-1 rounded-full mb-3 shadow-lg",children:"Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ"}),e.jsx("h3",{className:"text-4xl md:text-5xl font-black text-white leading-none mb-2",children:"Ø´ÙØ§ Ø¨Ø¯Ø±Ø§Ù†"}),e.jsxs("div",{className:"flex items-start gap-2 text-gray-300 text-sm md:text-base font-medium max-w-sm",children:[e.jsx($e,{className:"text-yellow-500 mt-1 shrink-0",size:18}),e.jsx("p",{children:"Ø´Ø§Ø±Ø¹ Ø±ÙØ¹Øª Ø´Ù…ÙˆØ· - Ø¨Ø¬Ø§Ù†Ø¨ Ù…Ø´Ø§ØªÙ„ Ø±Ø¨ÙŠØ¹ Ø§Ù„Ø§Ø±Ø¯Ù†"})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-6",children:[e.jsxs("button",{onClick:()=>j("https://maps.app.goo.gl/mTqvZD4Ftor3NALJ8?g_st=ic"),className:"flex items-center justify-center gap-2 bg-white/20 backdrop-blur-md border border-white/30 text-white font-bold py-4 rounded-2xl hover:bg-white hover:text-black transition-all duration-300",children:[e.jsx(nt,{size:20}),e.jsx("span",{children:"Ø§Ù„Ù…ÙˆÙ‚Ø¹"})]}),e.jsxs("button",{onClick:()=>window.open("https://wa.me/962795629606","_blank"),className:"flex items-center justify-center gap-2 bg-[#25D366]/90 backdrop-blur-md text-white font-bold py-4 rounded-2xl hover:bg-[#25D366] transition-all duration-300 shadow-lg shadow-green-900/20",children:[e.jsx(be,{size:20}),e.jsx("span",{children:"ÙˆØ§ØªØ³Ø§Ø¨"})]})]}),e.jsxs("a",{href:"tel:0795629606",className:"mt-3 flex items-center justify-center gap-2 bg-black/60 backdrop-blur-md border border-white/10 text-white font-bold py-4 rounded-2xl hover:bg-yellow-500 hover:text-black transition-all duration-300",children:[e.jsx(Ie,{size:20}),e.jsx("span",{dir:"ltr",children:"07 9562 9606"})]})]})})]}),e.jsxs("div",{className:"group relative h-[500px] w-full rounded-[2.5rem] overflow-hidden shadow-2xl cursor-default",children:[e.jsx("img",{src:oe.BRANCH_ABU_NSEIR,alt:"Abu Nseir",className:"absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/60 to-transparent opacity-90 transition-opacity duration-300"}),e.jsx("div",{className:"absolute inset-0 p-8 md:p-12 flex flex-col justify-end",children:e.jsxs("div",{className:"transform transition-transform duration-500 translate-y-4 group-hover:translate-y-0",children:[e.jsx("div",{className:"flex justify-between items-end mb-4",children:e.jsxs("div",{children:[e.jsx("span",{className:"inline-block bg-gray-800 text-white text-xs font-black px-3 py-1 rounded-full mb-3 shadow-lg border border-gray-600",children:"ÙØ±Ø¹ 2"}),e.jsx("h3",{className:"text-4xl md:text-5xl font-black text-white leading-none mb-2",children:"Ø£Ø¨Ùˆ Ù†ØµÙŠØ±"}),e.jsxs("div",{className:"flex items-start gap-2 text-gray-300 text-sm md:text-base font-medium max-w-sm",children:[e.jsx($e,{className:"text-yellow-500 mt-1 shrink-0",size:18}),e.jsx("p",{children:"Ø¯ÙˆØ§Ø± Ø§Ù„Ø¨Ø­Ø±ÙŠØ© - Ù…Ø¬Ù…Ø¹ Ø§Ù„ÙØ±Ø§"})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-6",children:[e.jsxs("button",{onClick:()=>j("https://maps.app.goo.gl/yqu6tWBiqrRWGCMJ8?g_st=ic"),className:"flex items-center justify-center gap-2 bg-white/20 backdrop-blur-md border border-white/30 text-white font-bold py-4 rounded-2xl hover:bg-white hover:text-black transition-all duration-300",children:[e.jsx(nt,{size:20}),e.jsx("span",{children:"Ø§Ù„Ù…ÙˆÙ‚Ø¹"})]}),e.jsxs("button",{onClick:()=>window.open("https://wa.me/962790368603","_blank"),className:"flex items-center justify-center gap-2 bg-[#25D366]/90 backdrop-blur-md text-white font-bold py-4 rounded-2xl hover:bg-[#25D366] transition-all duration-300 shadow-lg shadow-green-900/20",children:[e.jsx(be,{size:20}),e.jsx("span",{children:"ÙˆØ§ØªØ³Ø§Ø¨"})]})]}),e.jsxs("a",{href:"tel:0790368603",className:"mt-3 flex items-center justify-center gap-2 bg-black/60 backdrop-blur-md border border-white/10 text-white font-bold py-4 rounded-2xl hover:bg-yellow-500 hover:text-black transition-all duration-300",children:[e.jsx(Ie,{size:20}),e.jsx("span",{dir:"ltr",children:"07 9036 8603"})]})]})})]})]})]})}),e.jsx("section",{className:"py-24 relative overflow-hidden bg-gray-50",children:e.jsxs("div",{className:"container mx-auto px-6 relative z-10",children:[e.jsxs("div",{className:"flex flex-col items-center mb-16 text-center",children:[e.jsx("span",{className:"text-yellow-500 font-bold tracking-widest text-sm uppercase mb-2",children:"Ù„Ù…Ø§Ø°Ø§ Ù†Ø­Ù†ØŸ"}),e.jsxs("h2",{className:"text-4xl md:text-5xl font-black text-gray-900 mb-4",children:["Ø£ÙƒØ«Ø± Ù…Ù† Ù…Ø¬Ø±Ø¯ ",e.jsx("span",{className:"text-yellow-500",children:"Ø±ÙŠØ§Ø¶Ø©"})]}),e.jsx("p",{className:"text-gray-500 max-w-xl",children:"Ù†Ø­Ù† Ù†Ø¨Ù†ÙŠ Ø´Ø®ØµÙŠØ© Ø·ÙÙ„ÙƒØŒ Ù†Ø¹Ø²Ø² Ø«Ù‚ØªÙ‡ Ø¨Ù†ÙØ³Ù‡ØŒ ÙˆÙ†Ø¹Ø¯Ù‡ Ù„ÙŠÙƒÙˆÙ† Ù‚Ø§Ø¦Ø¯Ø§Ù‹ ÙÙŠ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„."})]}),e.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:[{icon:pt,title:"ØµÙ†Ø§Ø¹Ø© Ø§Ù„Ø£Ø¨Ø·Ø§Ù„",text:"Ù…Ù†Ù‡Ø¬ ØªØ¯Ø±ÙŠØ¨ÙŠ Ø§Ø­ØªØ±Ø§ÙÙŠ ÙŠÙ‡Ø¯Ù Ù„Ù„ÙˆØµÙˆÙ„ Ø¨Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ù„Ù…Ù†ØµØ§Øª Ø§Ù„ØªØªÙˆÙŠØ¬ Ø§Ù„Ù…Ø­Ù„ÙŠØ© ÙˆØ§Ù„Ø¯ÙˆÙ„ÙŠØ©."},{icon:ye,title:"ÙƒØ§Ø¯Ø± Ù…Ø­ØªØ±Ù",text:"Ù†Ø®Ø¨Ø© Ù…Ù† Ø§Ù„Ù…Ø¯Ø±Ø¨ÙŠÙ† Ø§Ù„ÙˆØ·Ù†ÙŠÙŠÙ† ÙˆØ§Ù„Ø¯ÙˆÙ„ÙŠÙŠÙ† Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ÙŠÙ† Ø°ÙˆÙŠ Ø§Ù„Ø®Ø¨Ø±Ø© Ø§Ù„Ø¹Ø§Ù„ÙŠØ©."},{icon:qe,title:"Ø¨ÙŠØ¦Ø© Ø¢Ù…Ù†Ø©",text:"Ù†Ù‡ØªÙ… Ø¨Ø§Ù„Ø¬Ø§Ù†Ø¨ Ø§Ù„ØªØ±Ø¨ÙˆÙŠ ÙˆØ§Ù„Ø£Ø®Ù„Ø§Ù‚ÙŠ Ù‚Ø¨Ù„ Ø§Ù„Ø¬Ø§Ù†Ø¨ Ø§Ù„Ø¨Ø¯Ù†ÙŠØŒ ÙÙŠ Ø¨ÙŠØ¦Ø© Ø¹Ø§Ø¦Ù„ÙŠØ© Ø¢Ù…Ù†Ø©."}].map((f,p)=>e.jsxs("div",{className:"bg-white p-8 rounded-3xl shadow-xl hover:shadow-2xl transition-all duration-300 border border-gray-100 relative group overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-yellow-500 to-yellow-200 transform origin-left scale-x-0 group-hover:scale-x-100 transition-transform duration-500"}),e.jsx("div",{className:"w-16 h-16 bg-yellow-100 rounded-2xl flex items-center justify-center text-yellow-600 mb-6 group-hover:scale-110 transition-transform group-hover:bg-yellow-500 group-hover:text-black",children:e.jsx(f.icon,{size:32,strokeWidth:2})}),e.jsx("h3",{className:"text-xl font-bold mb-3 text-gray-900",children:f.title}),e.jsx("p",{className:"text-gray-500 leading-relaxed text-sm",children:f.text})]},p))})]})}),e.jsxs("section",{id:"schedule",className:"py-20 bg-gray-900 text-white relative",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:"radial-gradient(#FDE047 1px, transparent 1px)",backgroundSize:"20px 20px"}}),e.jsxs("div",{className:"container mx-auto px-6 relative z-10",children:[e.jsxs("div",{className:"flex flex-col items-center mb-16",children:[e.jsx("h2",{className:"text-4xl font-black mb-4",children:"Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø­ØµØµ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ"}),e.jsx("div",{className:"w-20 h-1.5 bg-yellow-500 rounded-full"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:(r&&r.length>0?r:ts).map(f=>e.jsxs("div",{className:"bg-gray-800 rounded-2xl p-6 border border-gray-700 hover:border-yellow-500 transition-all duration-300 hover:-translate-y-2 group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center text-yellow-500 group-hover:bg-yellow-500 group-hover:text-black transition-colors",children:e.jsx(Re,{size:20})}),e.jsx("span",{className:"text-xs font-bold text-gray-400 bg-black/30 px-2 py-1 rounded",children:f.branch})]}),e.jsx("h3",{className:"font-bold text-xl mb-2 text-white",children:f.level}),e.jsxs("div",{className:"space-y-3 mt-6 border-t border-gray-700 pt-4",children:[e.jsxs("div",{className:"flex items-start gap-2 text-sm text-gray-400",children:[e.jsx(pe,{size:16,className:"text-yellow-500 mt-0.5"}),e.jsx("span",{children:f.days})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm font-bold text-white",children:[e.jsx(ke,{size:16,className:"text-yellow-500"}),e.jsx("span",{children:f.time})]})]})]},f.id))})]})]}),e.jsx("footer",{className:"bg-black text-white pt-16 pb-24 md:pb-8 border-t border-gray-800 relative z-10",children:e.jsxs("div",{className:"container mx-auto px-6 text-center",children:[e.jsxs("div",{className:"flex justify-center items-center gap-3 mb-6",children:[e.jsx("img",{src:oe.LOGO,alt:"Logo",className:"w-10 h-10 rounded-full grayscale opacity-80"}),e.jsx("span",{className:"font-bold text-lg text-gray-400",children:"Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø§Ù„Ø´Ø¬Ø§Ø¹ Ù„Ù„ØªØ§ÙŠÙƒÙˆÙ†Ø¯Ùˆ"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Â© 2023 Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©."})]})}),e.jsx("button",{onClick:h,className:"fixed bottom-6 right-6 z-50 bg-[#25D366] text-white p-4 rounded-full shadow-2xl hover:bg-[#20bd5a] transition-transform hover:scale-110 flex items-center justify-center animate-bounce-slow border-4 border-white",title:"ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨",children:e.jsx(be,{size:28,fill:"white",className:"text-transparent"})}),l&&e.jsx("div",{className:"fixed inset-0 bg-black/90 z-[100] flex items-center justify-center p-4 backdrop-blur-sm",children:e.jsx(J,{className:"w-full max-w-lg animate-fade-in border-t-8 border-yellow-500",title:"Ø·Ù„Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯",children:e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold mb-1 text-gray-600",children:"Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ"}),e.jsx("input",{required:!0,className:"w-full border-2 border-gray-100 p-3 rounded-lg focus:border-yellow-500 focus:ring-0 outline-none transition-colors",placeholder:"Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„",value:s.name,onChange:f=>m({...s,name:f.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold mb-1 text-gray-600",children:"ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯"}),e.jsx("input",{type:"date",required:!0,className:"w-full border-2 border-gray-100 p-3 rounded-lg focus:border-yellow-500 focus:ring-0 outline-none transition-colors",value:s.dob,onChange:f=>m({...s,dob:f.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold mb-1 text-gray-600",children:"Ø±Ù‚Ù… Ù‡Ø§ØªÙ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±"}),e.jsx("input",{required:!0,className:"w-full border-2 border-gray-100 p-3 rounded-lg focus:border-yellow-500 focus:ring-0 outline-none transition-colors",placeholder:"079xxxxxxx",value:s.phone,onChange:f=>m({...s,phone:f.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold mb-1 text-gray-600",children:"Ø§Ù„Ø¹Ù†ÙˆØ§Ù†"}),e.jsx("input",{required:!0,className:"w-full border-2 border-gray-100 p-3 rounded-lg focus:border-yellow-500 focus:ring-0 outline-none transition-colors",placeholder:"Ø§Ù„Ù…Ù†Ø·Ù‚Ø© - Ø§Ù„Ø´Ø§Ø±Ø¹",value:s.address,onChange:f=>m({...s,address:f.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold mb-1 text-gray-600",children:"Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨"}),e.jsxs("select",{className:"w-full border-2 border-gray-100 p-3 rounded-lg focus:border-yellow-500 focus:ring-0 outline-none transition-colors bg-white",value:s.branch,onChange:f=>m({...s,branch:f.target.value}),children:[e.jsx("option",{value:se.SHAFA,children:se.SHAFA}),e.jsx("option",{value:se.ABU_NSEIR,children:se.ABU_NSEIR})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-8 pt-4 border-t border-gray-100",children:[e.jsx(L,{variant:"ghost",className:"text-gray-500 hover:text-black",onClick:()=>i(!1),children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(L,{type:"submit",disabled:v,className:"bg-black text-white hover:bg-gray-800 px-8",children:v?"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...":"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨"})]})]})})})]})},as=({setView:a,handleLogin:r,loginError:n})=>{const[x,l]=b.useState(""),[i,s]=b.useState(""),m=v=>{v.preventDefault(),r(x,i)};return e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center px-4 relative overflow-hidden",dir:"rtl",children:e.jsxs(J,{className:"w-full max-w-md relative z-10 border-t-4 border-yellow-500",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-24 h-24 bg-white rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg p-2",children:e.jsx("img",{src:oe.LOGO,alt:"Logo",className:"w-full h-full object-contain"})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„"})]}),n&&e.jsx("div",{className:"bg-red-100 text-red-700 p-2 rounded mb-4 text-sm text-center",children:n}),e.jsxs("form",{className:"space-y-5",onSubmit:m,children:[e.jsx("input",{className:"w-full border p-3 rounded-lg",type:"text",placeholder:"Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ",value:x,onChange:v=>l(v.target.value),required:!0}),e.jsx("input",{className:"w-full border p-3 rounded-lg",type:"password",placeholder:"ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±",value:i,onChange:v=>s(v.target.value),required:!0}),e.jsx(L,{type:"submit",className:"w-full py-3 text-lg shadow-lg shadow-yellow-500/30",children:"Ø¯Ø®ÙˆÙ„"})]}),e.jsx("div",{className:"mt-8 text-center border-t pt-4",children:e.jsxs("button",{onClick:()=>a("home"),className:"text-gray-500 hover:text-gray-800 text-sm font-medium flex items-center justify-center gap-2 w-full",children:[e.jsx(Pe,{size:16})," Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"]})})]})})},ls=({user:a,students:r,schedule:n,news:x,handleLogout:l})=>{const[i,s]=b.useState(new Date),m=g=>{const R=new Date(i);R.setMonth(R.getMonth()+g),s(R)},v=i.getFullYear(),w=i.getMonth(),c=new Date(v,w+1,0).getDate(),d=["ÙŠÙ†Ø§ÙŠØ±","ÙØ¨Ø±Ø§ÙŠØ±","Ù…Ø§Ø±Ø³","Ø£Ø¨Ø±ÙŠÙ„","Ù…Ø§ÙŠÙˆ","ÙŠÙˆÙ†ÙŠÙˆ","ÙŠÙˆÙ„ÙŠÙˆ","Ø£ØºØ³Ø·Ø³","Ø³Ø¨ØªÙ…Ø¨Ø±","Ø£ÙƒØªÙˆØ¨Ø±","Ù†ÙˆÙÙ…Ø¨Ø±","Ø¯ÙŠØ³Ù…Ø¨Ø±"],u=le("payments").data||[],j=r.find(g=>g.id===a.id)||a,h=r.filter(g=>g.familyId===a.familyId);let f=j.familyName||"Ø¹Ø§Ø¦Ù„Ø©";if(f.trim()==="Ø¹Ø§Ø¦Ù„Ø©"||f.trim().toLowerCase()==="family"){const g={};h.forEach(K=>{const _=K.name.trim().split(/\s+/);if(_.length>1){const W=_[_.length-1];g[W]=(g[W]||0)+1}});const R=Object.entries(g).sort((K,_)=>_[1]-K[1]);R.length>0&&(f=`Ø¹Ø§Ø¦Ù„Ø© ${R[0][0]}`)}const p=u.filter(g=>h.some(R=>R.id===g.studentId)).sort((g,R)=>new Date(R.date)-new Date(g.date)),I=[...new Set(h.map(g=>g.branch))],o=(x||[]).filter(g=>!g.branch||g.branch==="Ø§Ù„ÙƒÙ„"||I.includes(g.branch)).sort((g,R)=>new Date(R.createdAt||0)-new Date(g.createdAt||0)),k=g=>{if(!g)return"expired";const R=new Date,K=new Date(g);R.setHours(0,0,0,0),K.setHours(0,0,0,0);const _=K-R,W=Math.ceil(_/(1e3*60*60*24));return W<0?"expired":W<=7?"near_end":"active"},[A,O]=b.useState(!1),[M,T]=b.useState({username:"",password:""}),[N,$]=b.useState(!1),H=async g=>{if(g.preventDefault(),!M.username||!M.password)return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„");$(!0);try{const R=je(te,"artifacts",ce,"public","data","students",j.id);await bt(R,{username:M.username,password:M.password});const K={...a,username:M.username,password:M.password};localStorage.setItem("braveUser",JSON.stringify(K)),alert("ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­!"),O(!1)}catch(R){console.error(R),alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠØ«")}finally{$(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gray-100 font-sans text-right",dir:"rtl",children:[e.jsx("header",{className:"bg-black text-yellow-500 p-4 shadow-lg sticky top-0 z-40",children:e.jsxs("div",{className:"container mx-auto flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:oe.LOGO,alt:"Logo",className:"w-10 h-10 bg-white rounded-full p-1"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"font-bold text-lg",children:["Ù…Ø±Ø­Ø¨Ø§Ù‹ ",f]}),e.jsx("p",{className:"text-xs text-gray-400",children:"Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(L,{variant:"secondary",onClick:()=>{T({username:j.username,password:j.password}),O(!0)},className:"text-sm bg-gray-800 hover:bg-gray-700 text-yellow-500 border border-gray-700",children:[e.jsx(_e,{size:16})," Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª"]}),e.jsxs(L,{variant:"secondary",onClick:l,className:"text-sm",children:[e.jsx(ut,{size:16})," Ø®Ø±ÙˆØ¬"]})]})]})}),e.jsxs("div",{className:"container mx-auto p-4 md:p-8 max-w-5xl space-y-8",children:[o.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border-r-4 border-yellow-500 overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-r from-yellow-50 to-white border-b border-yellow-100 flex items-center gap-2",children:[e.jsx("div",{className:"bg-yellow-500 text-white p-2 rounded-full shadow-sm animate-pulse",children:e.jsx(we,{size:20})}),e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Ø¢Ø®Ø± Ø§Ù„Ø£Ø®Ø¨Ø§Ø± ÙˆØ§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª"})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:o.slice(0,4).map(g=>e.jsxs("div",{className:"flex gap-4 items-start p-3 bg-gray-50 rounded-xl hover:shadow-md transition-all border border-gray-100",children:[g.image?e.jsx("img",{src:g.image,alt:"News",className:"w-20 h-20 object-cover rounded-lg border border-gray-200"}):e.jsx("div",{className:"w-20 h-20 bg-gray-200 rounded-lg flex items-center justify-center text-gray-400",children:e.jsx(we,{size:24})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-gray-900 mb-1",children:g.title}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 leading-relaxed",children:g.desc}),e.jsx("div",{className:"mt-2 flex items-center gap-2",children:e.jsx("span",{className:"text-[10px] bg-white border border-gray-200 px-2 py-0.5 rounded-full text-gray-500",children:g.branch||"Ø¹Ø§Ù…"})})]})]},g.id))})})]}),e.jsxs("div",{className:"bg-gradient-to-r from-gray-900 to-gray-800 text-white p-6 rounded-2xl shadow-lg",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(Re,{className:"text-yellow-500"})," Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ø­ØµØµ"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:n&&n.length>0?n.map(g=>e.jsxs("div",{className:"bg-white/10 p-4 rounded-lg",children:[e.jsx("p",{className:"font-bold text-yellow-400 mb-1",children:g.level}),e.jsxs("p",{className:"text-sm",children:[g.days," | ",g.time]})]},g.id)):e.jsx("p",{className:"text-gray-400",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¬Ø¯ÙˆÙ„ Ø­ØµØµ Ù…Ø¹Ù„Ù† Ø­Ø§Ù„ÙŠØ§Ù‹"})})]}),e.jsx(J,{title:"ÙƒØ´Ù Ø§Ù„Ø­Ø³Ø§Ø¨ (Ø§Ù„Ø¯ÙØ¹Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©)",children:p.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-right",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"Ø§Ù„ØªØ§Ø±ÙŠØ®"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„Ø·Ø§Ù„Ø¨"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„Ø¨ÙŠØ§Ù†"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„Ù…Ø¨Ù„Øº"})]})}),e.jsx("tbody",{children:p.map(g=>e.jsxs("tr",{className:"border-b hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"p-3 text-gray-500 font-mono",children:g.date}),e.jsx("td",{className:"p-3 font-bold text-gray-800",children:g.name}),e.jsxs("td",{className:"p-3 text-gray-700",children:[g.reason," ",g.details&&e.jsxs("span",{className:"block text-xs text-gray-400 mt-1",children:["(",g.details,")"]})]}),e.jsxs("td",{className:"p-3 text-green-600 font-bold",dir:"ltr",children:[g.amount," JD"]})]},g.id))})]})}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯ÙØ¹Ø§Øª Ù…Ø³Ø¬Ù„Ø©"})}),h.map(g=>e.jsxs(J,{className:"mb-8 border-t-4 border-yellow-500",title:g.name,children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center mb-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl",children:[e.jsx("p",{className:"text-gray-500 text-xs mb-1",children:"Ø§Ù„Ø­Ø²Ø§Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ"}),e.jsx("p",{className:"font-bold text-xl",children:g.belt})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl",children:[e.jsx("p",{className:"text-gray-500 text-xs mb-1",children:"Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ"}),e.jsx(Me,{status:k(g.subEnd)}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["ÙŠÙ†ØªÙ‡ÙŠ: ",g.subEnd]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl",children:[e.jsx("p",{className:"text-gray-500 text-xs mb-1",children:"Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø³ØªØ­Ù‚"}),e.jsxs("p",{className:`font-bold text-xl ${g.balance>0?"text-red-600":"text-green-600"}`,children:[g.balance," JOD"]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl",children:[e.jsx("p",{className:"text-gray-500 text-xs mb-1",children:"Ø§Ù„ÙØ±Ø¹"}),e.jsx("p",{className:"font-bold text-lg",children:g.branch})]})]}),g.notes&&g.notes.length>0&&e.jsxs("div",{className:"mb-6 bg-blue-50 p-4 rounded-xl border border-blue-100",children:[e.jsx("h4",{className:"font-bold text-blue-800 text-sm mb-2",children:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:"}),e.jsx("ul",{className:"list-disc list-inside text-sm text-blue-900",children:g.notes.map(R=>e.jsxs("li",{children:[R.text," (",R.date,")"]},R.id))})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"font-bold text-gray-700",children:["Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ±: ",d[w]," ",v]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(L,{variant:"ghost",onClick:()=>m(-1),children:e.jsx(Pe,{size:16})}),e.jsx(L,{variant:"ghost",onClick:()=>m(1),children:e.jsx(Je,{size:16})})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 justify-center md:justify-start",children:[...Array(c)].map((R,K)=>{const _=K+1,W=`${v}-${String(w+1).padStart(2,"0")}-${String(_).padStart(2,"0")}`,y=g.attendance&&g.attendance[W];return e.jsx("div",{className:`w-9 h-9 rounded-lg flex items-center justify-center text-xs font-bold border ${y?"bg-green-500 text-white":"bg-gray-100 text-gray-400"}`,children:_},_)})})]})]},g.id))]}),A&&e.jsx("div",{className:"fixed inset-0 bg-black/80 z-[100] flex items-center justify-center p-4 backdrop-blur-sm",children:e.jsxs(J,{className:"w-full max-w-sm relative bg-white rounded-2xl shadow-2xl",children:[e.jsx("button",{onClick:()=>O(!1),className:"absolute top-4 left-4 text-gray-400 hover:text-black transition-colors",children:e.jsx(xe,{size:24})}),e.jsx("h3",{className:"text-xl font-bold mb-6 text-center text-gray-800",children:"ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„"}),e.jsxs("form",{onSubmit:H,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯"}),e.jsx("input",{className:"w-full border-2 border-gray-200 p-3 rounded-xl focus:border-yellow-500 outline-none transition-colors font-mono text-left dir-ltr",value:M.username,onChange:g=>T({...M,username:g.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©"}),e.jsx("input",{className:"w-full border-2 border-gray-200 p-3 rounded-xl focus:border-yellow-500 outline-none transition-colors font-mono text-left dir-ltr",value:M.password,onChange:g=>T({...M,password:g.target.value}),required:!0})]}),e.jsx("div",{className:"pt-4",children:e.jsx(L,{type:"submit",disabled:N,className:"w-full py-3 bg-yellow-500 text-black font-bold hover:bg-yellow-400 transition-colors shadow-lg shadow-yellow-500/20",children:N?"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...":"Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª"})})]})]})})]})},rs=()=>{const[a,r]=b.useState(new Date),[n,x]=b.useState("notes"),[l,i]=b.useState([]),[s,m]=b.useState(!1),[v,w]=b.useState(!1),[c,d]=b.useState({text:"",amount:"",type:"note",transactionType:"expense"}),S=`${a.getMonth()+1}-${a.getFullYear()}`,u=["ÙŠÙ†Ø§ÙŠØ±","ÙØ¨Ø±Ø§ÙŠØ±","Ù…Ø§Ø±Ø³","Ø£Ø¨Ø±ÙŠÙ„","Ù…Ø§ÙŠÙˆ","ÙŠÙˆÙ†ÙŠÙˆ","ÙŠÙˆÙ„ÙŠÙˆ","Ø£ØºØ³Ø·Ø³","Ø³Ø¨ØªÙ…Ø¨Ø±","Ø£ÙƒØªÙˆØ¨Ø±","Ù†ÙˆÙÙ…Ø¨Ø±","Ø¯ÙŠØ³Ù…Ø¨Ø±"];b.useEffect(()=>{j()},[S]);const j=async()=>{m(!0);try{const o=ze(he(te,"admin_notes"),Se("monthKey","==",S),At("createdAt","desc")),A=(await Ze(o)).docs.map(O=>({id:O.id,...O.data()}));i(A)}catch(o){console.error("Error fetching notes:",o)}m(!1)},h=async o=>{if(o.preventDefault(),!!c.text)try{await Le(he(te,"admin_notes"),{...c,monthKey:S,createdAt:new Date().toISOString(),date:new Date().toLocaleDateString("ar-JO")}),w(!1),d({text:"",amount:"",type:"note",transactionType:"expense"}),j()}catch(k){console.error("Error adding item:",k)}},f=async o=>{if(confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ"))try{await st(je(te,"admin_notes",o)),i(l.filter(k=>k.id!==o))}catch(k){console.error("Error deleting:",k)}},p=o=>{const k=new Date(a);k.setMonth(k.getMonth()+o),r(k)},I=b.useMemo(()=>{const o=l.filter(O=>O.type==="account"),k=o.filter(O=>O.transactionType==="income").reduce((O,M)=>O+Number(M.amount),0),A=o.filter(O=>O.transactionType==="expense").reduce((O,M)=>O+Number(M.amount),0);return{income:k,expense:A,total:k-A}},[l]);return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-100 flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4 bg-gray-50 p-2 rounded-xl",children:[e.jsx(L,{variant:"ghost",onClick:()=>p(-1),children:e.jsx(Pe,{})}),e.jsxs("div",{className:"text-center min-w-[150px]",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:[u[a.getMonth()]," ",a.getFullYear()]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Ø³Ø¬Ù„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©"})]}),e.jsx(L,{variant:"ghost",onClick:()=>p(1),children:e.jsx(Je,{})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(L,{onClick:()=>{d({...c,type:"note"}),w(!0)},className:"bg-yellow-100 text-yellow-700 hover:bg-yellow-200 gap-2",children:[e.jsx(Ft,{size:18})," Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ø§Ø­Ø¸Ø©"]}),e.jsxs(L,{onClick:()=>{d({...c,type:"account"}),w(!0)},className:"bg-green-100 text-green-700 hover:bg-green-200 gap-2",children:[e.jsx(at,{size:18})," Ø­Ø±ÙƒØ© Ù…Ø§Ù„ÙŠØ©"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-green-50 p-4 rounded-2xl border border-green-100 flex flex-col items-center",children:[e.jsxs("span",{className:"text-green-600 text-xs font-bold mb-1 flex items-center gap-1",children:[e.jsx(De,{size:12})," Ø§Ù„Ø¯Ø®Ù„"]}),e.jsx("span",{className:"text-xl font-bold text-green-800",children:I.income})]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-2xl border border-red-100 flex flex-col items-center",children:[e.jsxs("span",{className:"text-red-600 text-xs font-bold mb-1 flex items-center gap-1",children:[e.jsx(Xe,{size:12})," Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ"]}),e.jsx("span",{className:"text-xl font-bold text-red-800",children:I.expense})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-2xl border border-blue-100 flex flex-col items-center",children:[e.jsxs("span",{className:"text-blue-600 text-xs font-bold mb-1 flex items-center gap-1",children:[e.jsx(Pt,{size:12})," Ø§Ù„ØµØ§ÙÙŠ"]}),e.jsx("span",{className:"text-xl font-bold text-blue-800",children:I.total})]})]}),e.jsxs("div",{className:"flex border-b border-gray-200 mb-4",children:[e.jsxs("button",{onClick:()=>x("notes"),className:`px-6 py-3 font-bold transition-all ${n==="notes"?"border-b-2 border-yellow-500 text-yellow-600":"text-gray-400 hover:text-gray-600"}`,children:["ğŸ“ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª (",l.filter(o=>o.type==="note").length,")"]}),e.jsxs("button",{onClick:()=>x("accounts"),className:`px-6 py-3 font-bold transition-all ${n==="accounts"?"border-b-2 border-green-500 text-green-600":"text-gray-400 hover:text-gray-600"}`,children:["ğŸ’° Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª (",l.filter(o=>o.type==="account").length,")"]})]}),e.jsx("div",{className:"min-h-[300px]",children:s?e.jsx("p",{className:"text-center text-gray-400 py-10",children:"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„..."}):l.length===0?e.jsx("div",{className:"text-center py-10 bg-gray-50 rounded-2xl border-2 border-dashed border-gray-200",children:e.jsx("p",{className:"text-gray-400",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.filter(o=>o.type===n).map(o=>e.jsxs("div",{className:`p-4 rounded-xl border shadow-sm relative group transition-all hover:-translate-y-1 ${o.type==="note"?"bg-yellow-50/50 border-yellow-100":"bg-white border-gray-100"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"text-[10px] text-gray-400 bg-white px-2 py-1 rounded-full border",children:o.date}),o.type==="account"&&e.jsx("span",{className:`text-xs font-bold px-2 py-1 rounded-full ${o.transactionType==="income"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:o.transactionType==="income"?"Ø¯Ø®Ù„ +":"ØµØ±Ù -"})]}),e.jsx("p",{className:"text-gray-800 font-bold mb-2 whitespace-pre-wrap",children:o.text}),o.type==="account"&&e.jsxs("div",{className:"text-xl font-bold text-gray-900 dir-ltr text-right mb-2",children:[o.amount," JD"]}),e.jsx("button",{onClick:()=>f(o.id),className:"absolute top-4 left-4 text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(de,{size:16})})]},o.id))})}),v&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:()=>w(!1),children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md p-6 shadow-2xl transform transition-all",onClick:o=>o.stopPropagation(),children:[e.jsx("h3",{className:"text-xl font-bold mb-4 border-b pb-2",children:c.type==="note"?"Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ø§Ø­Ø¸Ø© Ø¬Ø¯ÙŠØ¯Ø©":"Ø¥Ø¶Ø§ÙØ© Ø­Ø±ÙƒØ© Ù…Ø§Ù„ÙŠØ©"}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[c.type==="account"&&e.jsxs("div",{className:"flex gap-2 p-1 bg-gray-100 rounded-lg",children:[e.jsx("button",{type:"button",onClick:()=>d({...c,transactionType:"expense"}),className:`flex-1 py-2 rounded-md font-bold text-sm transition-colors ${c.transactionType==="expense"?"bg-white text-red-600 shadow-sm":"text-gray-500"}`,children:"Ù…ØµØ±ÙˆÙØ§Øª"}),e.jsx("button",{type:"button",onClick:()=>d({...c,transactionType:"income"}),className:`flex-1 py-2 rounded-md font-bold text-sm transition-colors ${c.transactionType==="income"?"bg-white text-green-600 shadow-sm":"text-gray-500"}`,children:"Ø¥ÙŠØ±Ø§Ø¯Ø§Øª"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:c.type==="note"?"Ù†Øµ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©":"Ø§Ù„ÙˆØµÙ / Ø§Ù„Ø¨ÙŠØ§Ù†"}),e.jsx("textarea",{className:"w-full border-2 border-gray-200 p-3 rounded-xl focus:border-yellow-500 outline-none h-24",placeholder:"Ø§ÙƒØªØ¨ Ù‡Ù†Ø§...",value:c.text,onChange:o=>d({...c,text:o.target.value}),autoFocus:!0})]}),c.type==="account"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Ø§Ù„Ù…Ø¨Ù„Øº (JD)"}),e.jsx("input",{type:"number",className:"w-full border-2 border-gray-200 p-3 rounded-xl focus:border-yellow-500 outline-none font-bold text-lg",value:c.amount,onChange:o=>d({...c,amount:o.target.value}),placeholder:"0.00"})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(L,{variant:"ghost",onClick:()=>w(!1),type:"button",children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(L,{type:"submit",className:"flex-1 bg-black text-yellow-500 hover:bg-gray-800",children:"Ø­ÙØ¸"})]})]})]})})]})},ns=({user:a,selectedBranch:r,branchStudents:n,netProfit:x,totalAttendance:l,expiredCount:i,activeStudentsCount:s,nearEndCount:m,totalStudents:v,activityLogs:w=[]})=>{const c=d=>{if(!d)return{date:"-",time:"-"};const S=new Date(d);return{date:S.toLocaleDateString("ar-JO"),time:S.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})}};return e.jsxs("div",{className:"space-y-8 animate-fade-in",children:[e.jsxs("div",{className:"bg-gradient-to-r from-yellow-500 to-orange-500 rounded-2xl p-8 text-white shadow-lg flex justify-between items-center relative overflow-hidden",children:[e.jsxs("div",{className:"relative z-10",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-2",children:["Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ ",a.name,"! ğŸ‘‹"]}),e.jsxs("p",{className:"opacity-90",children:["Ù†Ø¸Ø±Ø© Ø³Ø±ÙŠØ¹Ø© Ø¹Ù„Ù‰ Ø£Ø¯Ø§Ø¡ ÙØ±Ø¹ ",r]})]}),e.jsxs("div",{className:"relative z-10 bg-white/20 p-4 rounded-xl backdrop-blur-sm text-center",children:[e.jsx("span",{className:"block text-4xl font-bold",children:new Date().getDate()}),e.jsx("span",{className:"uppercase text-sm tracking-wider",children:new Date().toLocaleString("en-us",{month:"short"})})]}),e.jsx("div",{className:"absolute right-0 top-0 opacity-10 transform translate-x-10 -translate-y-10",children:e.jsx(pt,{size:200})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(J,{className:"border-l-4 border-blue-500 transform hover:-translate-y-1 transition-transform",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm mb-1",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø§Ø¨"}),e.jsx("h3",{className:"text-3xl font-bold text-gray-800",children:n.length})]}),e.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:e.jsx(ye,{className:"text-blue-600",size:24})})]}),e.jsxs("div",{className:"mt-4 text-xs text-gray-400 flex items-center gap-1",children:[e.jsx(Ae,{size:12,className:"text-green-500"})," ",e.jsx("span",{className:"text-green-500 font-bold",children:"+3"})," Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±"]})]}),e.jsx(J,{className:"border-l-4 border-green-500 transform hover:-translate-y-1 transition-transform",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm mb-1",children:"ØµØ§ÙÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­"}),e.jsxs("h3",{className:"text-3xl font-bold text-gray-800",children:[x," ",e.jsx("span",{className:"text-sm text-gray-400",children:"JOD"})]})]}),e.jsx("div",{className:"bg-green-100 p-2 rounded-lg",children:e.jsx(De,{className:"text-green-600",size:24})})]})}),e.jsx(J,{className:"border-l-4 border-purple-500 transform hover:-translate-y-1 transition-transform",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm mb-1",children:"Ø­Ø¶ÙˆØ± Ø§Ù„Ø´Ù‡Ø±"}),e.jsx("h3",{className:"text-3xl font-bold text-gray-800",children:l})]}),e.jsx("div",{className:"bg-purple-100 p-2 rounded-lg",children:e.jsx(ke,{className:"text-purple-600",size:24})})]})}),e.jsx(J,{className:"border-l-4 border-red-500 transform hover:-translate-y-1 transition-transform",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm mb-1",children:"Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ù…Ù†ØªÙ‡ÙŠØ©"}),e.jsx("h3",{className:"text-3xl font-bold text-gray-800",children:i})]}),e.jsx("div",{className:"bg-red-100 p-2 rounded-lg",children:e.jsx(Rt,{className:"text-red-600",size:24})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(J,{title:"ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª",className:"lg:col-span-1",children:[e.jsx("div",{className:"flex items-center justify-center py-6",children:e.jsx("div",{className:"relative w-48 h-48 rounded-full bg-gray-100 border-8 border-white shadow-inner flex items-center justify-center",style:{background:`conic-gradient(#22c55e 0% ${s/v*100||0}%, #eab308 ${s/v*100||0}% ${(s+m)/v*100||0}%, #ef4444 ${(s+m)/v*100||0}% 100%)`},children:e.jsxs("div",{className:"w-32 h-32 bg-white rounded-full flex flex-col items-center justify-center z-10 shadow-sm",children:[e.jsx("span",{className:"text-3xl font-bold text-gray-800",children:v}),e.jsx("span",{className:"text-xs text-gray-400",children:"Ø·Ø§Ù„Ø¨ ÙƒÙ„ÙŠ"})]})})}),e.jsxs("div",{className:"flex justify-around text-xs mt-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"})," ÙØ¹Ø§Ù„ (",s,")"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"})," Ù‚Ø§Ø±Ø¨ (",m,")"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"})," Ù…Ù†ØªÙ‡ÙŠ (",i,")"]})]})]}),e.jsx(J,{title:"Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ± (Live Log)",className:"lg:col-span-2",children:e.jsx("div",{className:"space-y-4 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:w.length===0?e.jsxs("div",{className:"text-center text-gray-400 py-10 flex flex-col items-center",children:[e.jsx(_t,{size:32,className:"mb-2 opacity-30"}),e.jsx("p",{children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Ø´Ø§Ø·Ø§Øª Ù…Ø³Ø¬Ù„Ø© Ø­Ø¯ÙŠØ«Ø§Ù‹"})]}):w.map((d,S)=>{const{date:u,time:j}=c(d.timestamp);return e.jsxs("div",{className:"flex gap-4 items-start p-3 hover:bg-gray-50 rounded-xl transition border border-gray-100 shadow-sm bg-white",children:[e.jsx("div",{className:"bg-blue-50 text-blue-600 p-2 rounded-full mt-1 shrink-0",children:e.jsx(We,{size:18})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("p",{className:"text-sm font-bold text-gray-900",children:d.action}),e.jsxs("span",{className:"text-[10px] bg-gray-100 text-gray-500 px-2 py-0.5 rounded-full font-mono flex items-center gap-1",children:[e.jsx(Re,{size:10})," ",j]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:d.details}),e.jsxs("div",{className:"flex justify-between items-center mt-2 border-t border-gray-50 pt-2",children:[e.jsxs("p",{className:"text-[10px] font-bold text-blue-800",children:["Ø¨ÙˆØ§Ø³Ø·Ø©: ",d.performedBy]}),e.jsx("p",{className:"text-[10px] text-gray-400",children:u})]})]})]},S)})})})]})]})},os=()=>{const r=`student${Math.floor(1e3+Math.random()*9e3)}`,n="ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz23456789";let x="";for(let l=0;l<8;l++)x+=n.charAt(Math.floor(Math.random()*n.length));return{username:r,password:x}},Ke=a=>{if(!a)return"expired";const r=new Date,n=new Date(a);r.setHours(0,0,0,0),n.setHours(0,0,0,0);const x=n-r,l=Math.ceil(x/(1e3*60*60*24));return l<0?"expired":l<=7?"near_end":"active"},xt=a=>{if(!a)return!1;const r=new Date,n=new Date(a),x=Math.abs(r-n);return Math.ceil(x/(1e3*60*60*24))<=7},Te=({children:a,onClose:r})=>typeof document>"u"?null:He.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[100] overflow-y-auto",role:"dialog",children:[e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm transition-opacity",onClick:r}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center sm:p-0",children:e.jsx("div",{className:"relative transform overflow-hidden rounded-2xl text-right shadow-2xl transition-all sm:my-8 sm:w-full sm:max-w-2xl bg-white",onClick:n=>n.stopPropagation(),children:a})})]}),document.body),ds=({isOpen:a,onClose:r,groups:n,allStudents:x,onSend:l})=>{const[i,s]=b.useState("all"),[m,v]=b.useState(""),[w,c]=b.useState([]),[d,S]=b.useState(""),[u,j]=b.useState(""),[h,f]=b.useState(!1);if(!a)return null;const p=x.filter(k=>k.name.toLowerCase().includes(d.toLowerCase())),I=k=>{w.includes(k)?c(A=>A.filter(O=>O!==k)):c(A=>[...A,k])},o=async()=>{if(!u.trim())return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø±Ø³Ø§Ù„Ø©");if(i==="custom"&&w.length===0)return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø·Ø§Ù„Ø¨ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„");f(!0),await l(i,m,u,w),f(!1),j(""),c([]),r()};return e.jsx(Te,{onClose:r,children:e.jsxs("div",{className:"p-6 max-h-[80vh] overflow-y-auto custom-scrollbar",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2 text-blue-700",children:[e.jsx(we,{size:24})," Ø¥Ø±Ø³Ø§Ù„ ØªØ¹Ù…ÙŠÙ… / Ø¥Ø¹Ù„Ø§Ù†"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Ù„Ù…Ù† ØªØ±ÙŠØ¯ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ØŸ"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer bg-gray-50 p-3 rounded-xl border border-gray-200",children:[e.jsx("input",{type:"radio",name:"target",value:"all",checked:i==="all",onChange:()=>s("all")}),e.jsx("span",{children:"Ø§Ù„ÙƒÙ„ (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø§Ø¨)"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer bg-gray-50 p-3 rounded-xl border border-gray-200",children:[e.jsx("input",{type:"radio",name:"target",value:"group",checked:i==="group",onChange:()=>{s("group"),n.length>0&&v(n[0])}}),e.jsx("span",{children:"ÙØªØ±Ø© / Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ø­Ø¯Ø¯Ø©"})]}),i==="group"&&e.jsx("div",{className:"mr-6 mb-2",children:e.jsx("select",{className:"w-full border-2 border-gray-200 p-2 rounded-xl outline-none",value:m,onChange:k=>v(k.target.value),children:n.map((k,A)=>e.jsx("option",{value:k,children:k},A))})}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer bg-gray-50 p-3 rounded-xl border border-gray-200",children:[e.jsx("input",{type:"radio",name:"target",value:"custom",checked:i==="custom",onChange:()=>s("custom")}),e.jsx("span",{children:"ØªØ­Ø¯ÙŠØ¯ Ø·Ù„Ø§Ø¨ (ÙŠØ¯ÙˆÙŠØ§Ù‹)"})]}),i==="custom"&&e.jsxs("div",{className:"mr-6 p-3 border border-gray-200 rounded-xl bg-white",children:[e.jsx("input",{className:"w-full border-b border-gray-100 p-2 mb-2 text-sm outline-none",placeholder:"Ø§Ø¨Ø­Ø« Ø¹Ù† Ø·Ø§Ù„Ø¨...",value:d,onChange:k=>S(k.target.value)}),e.jsx("div",{className:"max-h-40 overflow-y-auto space-y-1 custom-scrollbar",children:p.map(k=>e.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:w.includes(k.id),onChange:()=>I(k.id)}),e.jsx("span",{className:"text-sm",children:k.name})]},k.id))}),e.jsxs("div",{className:"mt-2 text-xs text-blue-600 font-bold",children:["ØªÙ… Ø§Ø®ØªÙŠØ§Ø±: ",w.length," Ø·Ø§Ù„Ø¨"]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Ù†Øµ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†"}),e.jsx("textarea",{className:"w-full border-2 border-gray-200 p-3 rounded-xl outline-none h-32 focus:border-blue-500",placeholder:"Ø§ÙƒØªØ¨ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù‡Ù†Ø§... (Ø³ÙŠØ¸Ù‡Ø± ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø·Ù„Ø§Ø¨)",value:u,onChange:k=>j(k.target.value)})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsx(L,{variant:"ghost",onClick:r,children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(L,{onClick:o,disabled:h,className:"bg-blue-600 text-white hover:bg-blue-700",children:h?"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...":"Ù†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†"})]})]})]})})},is=({student:a,onClose:r,onSave:n})=>{const[x,l]=b.useState("private"),[i,s]=b.useState(""),m=()=>{if(!i.trim())return;const c={id:Date.now().toString(),text:i,date:new Date().toLocaleDateString("ar-JO"),timestamp:new Date().toISOString()};n(a.id,x,"add",c),s("")},v=(c,d)=>{confirm("Ø­Ø°Ù Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©ØŸ")&&n(a.id,x,"delete",{id:c,isLegacy:d})},w=b.useMemo(()=>{if(x==="private"){let c=a.internalNotes||[];return a.note&&a.note.trim()!==""&&(c=[...c,{id:"legacy_note",text:a.note,date:"Ø³Ø¬Ù„ Ù‚Ø¯ÙŠÙ…",isLegacy:!0}]),c}else return a.notes||[]},[a,x]);return e.jsx(Te,{onClose:r,children:e.jsxs("div",{className:"p-0 overflow-hidden flex flex-col h-[500px]",children:[e.jsxs("div",{className:`p-4 text-white flex justify-between items-center ${x==="private"?"bg-red-600":"bg-blue-600"}`,children:[e.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[x==="private"?e.jsx(ge,{size:20}):e.jsx(Ye,{size:20}),x==="private"?`Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø®Ø§ØµØ©: ${a.name}`:`Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù„Ù„Ø·Ø§Ù„Ø¨: ${a.name}`]}),e.jsx("button",{onClick:r,children:e.jsx(xe,{size:20})})]}),e.jsxs("div",{className:"flex border-b",children:[e.jsxs("button",{onClick:()=>l("private"),className:`flex-1 py-3 font-bold text-sm flex items-center justify-center gap-2 ${x==="private"?"text-red-600 border-b-2 border-red-600 bg-red-50":"text-gray-500 hover:bg-gray-50"}`,children:[e.jsx(ge,{size:16})," Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø®Ø§ØµØ© (Ù„Ù„Ø¥Ø¯Ø§Ø±Ø©)"]}),e.jsxs("button",{onClick:()=>l("public"),className:`flex-1 py-3 font-bold text-sm flex items-center justify-center gap-2 ${x==="public"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-500 hover:bg-gray-50"}`,children:[e.jsx(Ye,{size:16})," Ø¥Ø¹Ù„Ø§Ù†Ø§Øª (Ù„Ù„Ø·Ø§Ù„Ø¨)"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-gray-50",children:w.length===0?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-400",children:[x==="private"?e.jsx(ge,{size:48,className:"mb-2 opacity-20"}):e.jsx(Ye,{size:48,className:"mb-2 opacity-20"}),e.jsx("p",{children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ø³Ø¬Ù„Ø©"})]}):e.jsx("div",{className:"space-y-3",children:w.map((c,d)=>e.jsxs("div",{className:"bg-white p-3 rounded-xl border border-gray-200 shadow-sm relative group",children:[e.jsx("p",{className:"text-gray-800 text-sm whitespace-pre-wrap",children:c.text}),e.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("span",{className:"text-[10px] text-gray-400 bg-gray-100 px-2 py-1 rounded-full",children:c.date}),c.isLegacy&&e.jsx("span",{className:"text-[10px] text-red-600 bg-red-100 px-2 py-1 rounded-full font-bold",children:"Ù‚Ø¯ÙŠÙ…"})]}),e.jsx("button",{onClick:()=>v(c.id,c.isLegacy),className:"text-red-400 hover:text-red-600 p-1",children:e.jsx(de,{size:16})})]})]},c.id||d))})}),e.jsx("div",{className:"p-4 bg-white border-t",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"flex-1 border-2 border-gray-200 rounded-xl px-4 py-2 focus:outline-none focus:border-yellow-500",placeholder:x==="private"?"Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø© Ø³Ø±ÙŠØ©...":"Ø§ÙƒØªØ¨ Ø¥Ø¹Ù„Ø§Ù†Ø§Ù‹ Ù„Ù„Ø·Ø§Ù„Ø¨...",value:i,onChange:c=>s(c.target.value),onKeyDown:c=>c.key==="Enter"&&m()}),e.jsx(L,{onClick:m,className:x==="private"?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700",children:e.jsx(Ce,{size:18})})]})})]})})},cs=({student:a,onClose:r,onSave:n})=>{const[x,l]=b.useState(a.subEnd||new Date().toISOString().split("T")[0]),i=s=>{const m=new Date(x);m.setMonth(m.getMonth()+s),l(m.toISOString().split("T")[0])};return e.jsx(Te,{onClose:r,children:e.jsxs("div",{className:"p-6 text-right",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 text-green-700 flex items-center gap-2",children:[e.jsx(et,{size:24})," ØªØ¬Ø¯ÙŠØ¯ Ø§Ø´ØªØ±Ø§Ùƒ: ",a.name]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø¬Ø¯ÙŠØ¯"}),e.jsx("input",{type:"date",className:"w-full border-2 border-green-100 focus:border-green-500 p-3 rounded-xl outline-none text-lg font-bold text-center bg-green-50/20",value:x,onChange:s=>l(s.target.value)})]}),e.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-2",children:"Ø¥Ø¶Ø§ÙØ© Ø³Ø±ÙŠØ¹Ø©:"}),e.jsxs("div",{className:"flex gap-2 mb-6",children:[e.jsx("button",{onClick:()=>i(1),className:"flex-1 bg-white hover:bg-green-50 text-green-700 border border-green-200 py-3 rounded-xl font-bold text-sm transition shadow-sm hover:shadow-md",children:"+ Ø´Ù‡Ø±"}),e.jsx("button",{onClick:()=>i(2),className:"flex-1 bg-white hover:bg-green-50 text-green-700 border border-green-200 py-3 rounded-xl font-bold text-sm transition shadow-sm hover:shadow-md",children:"+ Ø´Ù‡Ø±ÙŠÙ†"}),e.jsx("button",{onClick:()=>i(3),className:"flex-1 bg-white hover:bg-green-50 text-green-700 border border-green-200 py-3 rounded-xl font-bold text-sm transition shadow-sm hover:shadow-md",children:"+ 3 Ø´Ù‡ÙˆØ±"})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsx(L,{variant:"ghost",onClick:r,children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(L,{onClick:()=>n(a.id,x),className:"flex-1 bg-green-600 text-white hover:bg-green-700 shadow-lg shadow-green-600/20",children:"Ø­ÙØ¸ Ø§Ù„ØªØ¬Ø¯ÙŠØ¯"})]})]})})},xs=({students:a,studentsCollection:r,archiveCollection:n,selectedBranch:x,logActivity:l,groups:i})=>{const[s,m]=b.useState(""),[v,w]=b.useState("all"),[c,d]=b.useState("joinDateDesc"),[S,u]=b.useState(!1),[j,h]=b.useState(null),[f,p]=b.useState(null),[I,o]=b.useState(null),[k,A]=b.useState(!1),[O,M]=b.useState(null),T=b.useMemo(()=>i?i.map(t=>t.name):[],[i]),N={name:"",phone:"",belt:"Ø£Ø¨ÙŠØ¶",group:"",joinDate:new Date().toISOString().split("T")[0],dob:"",address:"",balance:0,subEnd:"",username:"",password:""},[$,H]=b.useState(N),[g,R]=b.useState("new"),K=b.useMemo(()=>{const t={};return a.forEach(C=>{if(C.familyId&&C.familyId!=="new"){t[C.familyId]||(t[C.familyId]={name:C.familyName,members:[],lastNames:{}});const F=C.name.trim().split(/\s+/),G=F[0],Y=F.length>1?F[F.length-1]:"";t[C.familyId].members.length<3&&t[C.familyId].members.push(G),Y&&(t[C.familyId].lastNames[Y]=(t[C.familyId].lastNames[Y]||0)+1)}}),Object.entries(t).map(([C,F])=>{let G=F.name||"Ø¹Ø§Ø¦Ù„Ø©";if(!G||G.trim()==="Ø¹Ø§Ø¦Ù„Ø©"||G.trim().toLowerCase()==="family"){const Q=Object.entries(F.lastNames);Q.length>0&&(G=`Ø¹Ø§Ø¦Ù„Ø© ${Q.sort((ee,ne)=>ne[1]-ee[1])[0][0]}`)}return{id:C,displayName:`${G} (ÙŠØ´Ù…Ù„: ${F.members.join("ØŒ ")}...)`}})},[a]),_=b.useMemo(()=>{let t=[...a];if(s){const C=s.toLowerCase();t=t.filter(F=>F.name.toLowerCase().includes(C)||F.phone.includes(C)||F.username.toLowerCase().includes(C))}return v!=="all"&&(t=t.filter(C=>Ke(C.subEnd)===v)),t.sort((C,F)=>{switch(c){case"joinDateDesc":return new Date(F.joinDate||0)-new Date(C.joinDate||0);case"joinDateAsc":return new Date(C.joinDate||0)-new Date(F.joinDate||0);case"beltDesc":return V.indexOf(F.belt)-V.indexOf(C.belt);case"beltAsc":return V.indexOf(C.belt)-V.indexOf(F.belt);case"balanceDesc":return F.balance-C.balance;default:return 0}}),t},[a,s,v,c]),W=async t=>{var ie;t.preventDefault();let C=$.username,F=$.password;if(!C||!F){const z=os();C=z.username,F=z.password}let G,Y;if(g==="new")G=Math.floor(Date.now()/1e3),Y=`Ø¹Ø§Ø¦Ù„Ø© ${$.name.trim().split(/\s+/).pop()}`;else{G=parseInt(g);const z=K.find(Z=>Z.id===g.toString());z?Y=z.displayName.split(" (")[0]:Y=((ie=a.find(Z=>Z.familyId===G))==null?void 0:ie.familyName)||"Ø¹Ø§Ø¦Ù„Ø©"}let Q=$.subEnd;if(!Q){const z=new Date($.joinDate||new Date),Z=new Date(z);Z.setMonth(Z.getMonth()+1),Q=Z.toISOString().split("T")[0]}const B=$.group||(T.length>0?T[0]:"Ø§Ù„ÙƒÙ„"),ee={...$,branch:x,status:"active",subEnd:Q,notes:[],internalNotes:[],attendance:{},familyId:G,familyName:Y,customOrder:Date.now(),group:B,username:C,password:F};await r.add(ee)&&(l&&l("Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨",`ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ø§Ù„Ø¨ ${ee.name}`),p({name:ee.name,username:C,password:F,phone:ee.phone}),q())},y=t=>{h(t),H({name:t.name,phone:t.phone,belt:t.belt,group:t.group||"",joinDate:t.joinDate,dob:t.dob,address:t.address||"",subEnd:t.subEnd,balance:t.balance,username:t.username,password:t.password}),R(t.familyId),u(!0)},q=()=>{u(!1),h(null),H(N),R("new")},X=async t=>{t.preventDefault(),await r.update(j.id,$),q()},re=async t=>{const C=V.indexOf(t.belt);C<V.length-1&&await r.update(t.id,{belt:V[C+1]})},ae=async t=>{confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ø±Ø´ÙØ© Ø§Ù„Ø·Ø§Ù„Ø¨ ${t.name}ØŸ`)&&(await n.add({...t,archivedAt:new Date().toISOString().split("T")[0],originalId:t.id}),await r.remove(t.id),l&&l("Ø£Ø±Ø´ÙØ©",`Ø£Ø±Ø´ÙØ© Ø§Ù„Ø·Ø§Ù„Ø¨ ${t.name}`))},me=async(t,C,F,G)=>{const Y=a.find(ne=>ne.id===t);if(!Y)return;if(F==="delete"&&G.isLegacy){await r.update(t,{note:""});return}const Q=C==="private"?"internalNotes":"notes";let B=Y[Q]||[],ee;F==="add"?ee=[G,...B]:ee=B.filter(ne=>ne.id!==G.id),await r.update(t,{[Q]:ee})},D=async(t,C,F,G=[])=>{let Y=[];if(t==="all"?Y=a:t==="group"?Y=a.filter(B=>B.group===C):t==="custom"&&(Y=a.filter(B=>G.includes(B.id))),Y.length===0)return alert("Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø§Ø¨ Ù…Ø³ØªÙ‡Ø¯ÙÙŠÙ†");if(!confirm(`Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù„Ù€ ${Y.length} Ø·Ø§Ù„Ø¨. Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ`))return;const Q={id:Date.now().toString(),text:F,date:new Date().toLocaleDateString("ar-JO"),timestamp:new Date().toISOString()};try{const B=Ot(te);let ee=0;Y.forEach(ne=>{const ie=je(te,"artifacts",ce,"public","data","students",ne.id),z=ne.notes||[];B.update(ie,{notes:[Q,...z]}),ee++}),ee>0&&(await B.commit(),alert("ØªÙ… Ù†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø¨Ù†Ø¬Ø§Ø­!"))}catch(B){console.error("Broadcast Error:",B),alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù†Ø´Ø± Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ. ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª.")}},P=async(t,C)=>{await r.update(t,{subEnd:C}),l&&O&&l("ØªØ¬Ø¯ÙŠØ¯ Ø§Ø´ØªØ±Ø§Ùƒ",`ØªØ¬Ø¯ÙŠØ¯ Ø§Ø´ØªØ±Ø§Ùƒ Ù„Ù„Ø·Ø§Ù„Ø¨ ${O.name} (ØªØ§Ø±ÙŠØ® Ø¬Ø¯ÙŠØ¯: ${C})`),M(null)},U=t=>{if(!t)return;let C=t.replace(/\D/g,"");C.startsWith("0")&&(C=C.substring(1)),window.open(`https://wa.me/962${C}`,"_blank")},E=t=>{if(!t.phone)return;let C=t.phone.replace(/\D/g,"");C.startsWith("0")&&(C=C.substring(1));const F=`Ù…Ø±Ø­Ø¨Ø§Ù‹ ${t.name} ğŸ”¥

Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø§Ù„Ø´Ø¬Ø§Ø¹ Ù„Ù„ØªØ§ÙŠÙƒÙˆØ§Ù†Ø¯Ùˆ !
Ø¥Ù„ÙŠÙƒ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ Ø¨Ø§Ù„Ù…ÙˆÙ‚Ø¹ :

ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${t.username}
ğŸ”‘ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: ${t.password}

Ù…ÙˆÙ‚Ø¹Ù†Ø§ Ø§Ù„Ø§Ù„ÙƒØªØ±ÙˆÙ†ÙŠ :
https://bravetkd.bar/

Ù†ØªÙ…Ù†Ù‰ Ù„Ùƒ Ø§Ù„ØªÙˆÙÙŠÙ‚ ÙŠØ§ Ø¨Ø·Ù„! ğŸ¥‹

ğŸ“ ÙØ±ÙˆØ¹Ù†Ø§ :
âœ… Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø£ÙˆÙ„: Ø´ÙØ§Ø¨Ø¯Ø±Ø§Ù† â€“ Ø´Ø§Ø±Ø¹ Ø±ÙØ¹Øª Ø´Ù…ÙˆØ·
ğŸ“ 0795629606

âœ… Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø«Ø§Ù†ÙŠ: Ø£Ø¨Ùˆ Ù†ØµÙŠØ± â€“ Ø¯ÙˆØ§Ø± Ø§Ù„Ø¨Ø­Ø±ÙŠØ© - Ù…Ø¬Ù…Ø¹ Ø§Ù„ÙØ±Ù‘Ø§ Ø§Ù„ØªØ¬Ø§Ø±ÙŠ
ğŸ“ 0790368603`;window.open(`https://wa.me/962${C}?text=${encodeURIComponent(F)}`,"_blank")};return e.jsxs("div",{className:"space-y-6 animate-fade-in font-sans",children:[e.jsx(ds,{isOpen:k,onClose:()=>A(!1),groups:T,allStudents:a,onSend:D}),I&&e.jsx(is,{student:I,onClose:()=>o(null),onSave:me}),O&&e.jsx(cs,{student:O,onClose:()=>M(null),onSave:P}),f&&e.jsx(Te,{onClose:()=>p(null),children:e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-4 animate-bounce",children:e.jsx(ot,{size:32})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¨Ø·Ù„ Ø¨Ù†Ø¬Ø§Ø­!"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["Ø§Ù„Ø·Ø§Ù„Ø¨: ",e.jsx("strong",{children:f.name})]}),e.jsxs("div",{className:"bg-gray-50 p-4 border rounded-xl mb-6 dir-ltr text-left relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 p-2 bg-yellow-400 text-xs font-bold text-black rounded-bl-lg",children:"Credentials"}),e.jsxs("p",{className:"font-mono text-sm mb-1",children:["User: ",e.jsx("strong",{className:"text-lg text-blue-900 select-all",children:f.username})]}),e.jsxs("p",{className:"font-mono text-sm",children:["Pass: ",e.jsx("strong",{className:"text-lg text-red-600 select-all",children:f.password})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(L,{onClick:()=>E(f),className:"bg-[#25D366] hover:bg-[#20bd5a] text-white flex items-center justify-center gap-2",children:[e.jsx(Ce,{size:18})," Ø¥Ø±Ø³Ø§Ù„ ÙˆØ§ØªØ³Ø§Ø¨"]}),e.jsx(L,{variant:"outline",onClick:()=>p(null),children:"Ø¥ØºÙ„Ø§Ù‚"})]})]})}),e.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-100 flex flex-col md:flex-row gap-4 justify-between items-center sticky top-0 z-20",children:[e.jsxs("div",{className:"relative w-full md:w-1/3",children:[e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:e.jsx(Fe,{size:18,className:"text-gray-400"})}),e.jsx("input",{className:"w-full pl-4 pr-10 py-2.5 border-2 border-gray-100 rounded-xl focus:border-yellow-500 focus:ring-4 focus:ring-yellow-500/10 outline-none transition-all",placeholder:"Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³Ù…ØŒ Ù‡Ø§ØªÙØŒ ÙŠÙˆØ²Ø±...",value:s,onChange:t=>m(t.target.value),list:"students-suggestions"}),e.jsx("datalist",{id:"students-suggestions",children:a.map(t=>e.jsx("option",{value:t.name},t.id))})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto overflow-x-auto pb-1 md:pb-0 hide-scrollbar",children:[e.jsxs(L,{onClick:()=>A(!0),className:"bg-blue-50 text-blue-600 border border-blue-100 hover:bg-blue-100 whitespace-nowrap flex items-center gap-2",children:[e.jsx(we,{size:18})," ",e.jsx("span",{className:"hidden sm:inline",children:"Ø¥Ø¹Ù„Ø§Ù† Ù„Ù„ÙƒÙ„"})]}),e.jsxs("div",{className:"relative min-w-[120px]",children:[e.jsxs("select",{className:"w-full appearance-none bg-gray-50 border border-gray-200 text-gray-700 py-2.5 pr-8 pl-8 rounded-xl focus:outline-none focus:border-yellow-500 cursor-pointer text-sm font-bold",value:v,onChange:t=>w(t.target.value),children:[e.jsx("option",{value:"all",children:"ÙƒÙ„ Ø§Ù„Ø­Ø§Ù„Ø§Øª"}),e.jsx("option",{value:"active",children:"ğŸŸ¢ ÙØ¹Ø§Ù„"}),e.jsx("option",{value:"near_end",children:"ğŸŸ¡ Ù‚Ø§Ø±Ø¨ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡"}),e.jsx("option",{value:"expired",children:"ğŸ”´ Ù…Ù†ØªÙ‡ÙŠ"})]}),e.jsx(ft,{size:14,className:"absolute top-1/2 -translate-y-1/2 right-3 text-gray-500 pointer-events-none"})]}),e.jsxs("div",{className:"relative min-w-[140px]",children:[e.jsxs("select",{className:"w-full appearance-none bg-gray-50 border border-gray-200 text-gray-700 py-2.5 pr-8 pl-8 rounded-xl focus:outline-none focus:border-yellow-500 cursor-pointer text-sm font-bold",value:c,onChange:t=>d(t.target.value),children:[e.jsx("option",{value:"joinDateDesc",children:"ğŸ“… Ø§Ù„Ø£Ø­Ø¯Ø«"}),e.jsx("option",{value:"joinDateAsc",children:"ğŸ“… Ø§Ù„Ø£Ù‚Ø¯Ù…"}),e.jsx("option",{value:"beltDesc",children:"ğŸ¥‹ Ø£Ø¹Ù„Ù‰ Ø­Ø²Ø§Ù…"}),e.jsx("option",{value:"balanceDesc",children:"ğŸ’° Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†ÙŠØ©"})]}),c.includes("Desc")?e.jsx(Ut,{size:14,className:"absolute top-1/2 -translate-y-1/2 right-3 text-gray-500 pointer-events-none"}):e.jsx(qt,{size:14,className:"absolute top-1/2 -translate-y-1/2 right-3 text-gray-500 pointer-events-none"})]}),e.jsxs(L,{onClick:()=>{h(null),u(!0)},className:"whitespace-nowrap flex items-center gap-2 shadow-lg shadow-yellow-500/20",children:[e.jsx(Gt,{size:18})," ",e.jsx("span",{className:"hidden sm:inline",children:"Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯"}),e.jsx("span",{className:"inline sm:hidden",children:"Ø¬Ø¯ÙŠØ¯"})]})]})]}),e.jsx(J,{className:"hidden md:block overflow-hidden border-none shadow-md rounded-2xl p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-right",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 border-b border-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 font-bold",children:"Ø§Ù„Ø·Ø§Ù„Ø¨"}),e.jsx("th",{className:"p-4 font-bold",children:"Ø§Ù„ÙØªØ±Ø©"}),e.jsx("th",{className:"p-4 font-bold",children:"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„"}),e.jsx("th",{className:"p-4 font-bold",children:"Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„"}),e.jsx("th",{className:"p-4 font-bold",children:"Ø§Ù„Ø­Ø²Ø§Ù…"}),e.jsx("th",{className:"p-4 font-bold",children:"Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ©"}),e.jsx("th",{className:"p-4 font-bold",children:"Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ"}),e.jsx("th",{className:"p-4 font-bold",children:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 bg-white",children:_.map(t=>{const C=xt(t.joinDate),F=t.internalNotes&&t.internalNotes.length>0||t.note&&t.note.trim()!=="",G=t.notes&&t.notes.length>0;return e.jsxs("tr",{className:"hover:bg-yellow-50/50 transition-colors group",children:[e.jsxs("td",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[F&&e.jsx("button",{onClick:()=>o(t),className:"text-red-500 hover:scale-110 transition-transform",title:"ÙŠÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø®Ø§ØµØ©!",children:e.jsx(dt,{size:20,fill:"currentColor",className:"text-red-100"})}),e.jsx("div",{className:"font-bold text-gray-800 text-base cursor-pointer hover:text-blue-600",onClick:()=>o(t),children:t.name}),C&&e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-red-100 text-red-600 text-[10px] font-bold border border-red-200 animate-pulse",children:"NEW"})]}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:t.joinDate})]}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"px-2 py-1 bg-blue-50 text-blue-700 rounded text-xs font-bold border border-blue-100",children:t.group||"ØºÙŠØ± Ù…Ø­Ø¯Ø¯"})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("a",{href:`tel:${t.phone}`,className:"font-mono text-gray-600 hover:text-blue-600 font-bold flex items-center gap-1",title:"Ø§ØªØµØ§Ù„",children:[t.phone," ",e.jsx(Ie,{size:12,className:"opacity-50"})]}),e.jsx("button",{onClick:()=>U(t.phone),className:"w-8 h-8 rounded-full bg-green-50 text-[#25D366] flex items-center justify-center hover:bg-[#25D366] hover:text-white transition-all shadow-sm",children:e.jsx(be,{size:16})})]})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"bg-gray-50 p-1.5 rounded-lg text-xs font-mono border border-gray-100",children:[e.jsxs("div",{className:"text-blue-900",children:["U: ",t.username]}),e.jsxs("div",{className:"text-red-600 font-bold",children:["P: ",t.password]})]}),e.jsx("button",{onClick:()=>E(t),className:"text-gray-400 hover:text-[#25D366] transition-colors",children:e.jsx(Ce,{size:16})})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"px-3 py-1 bg-gray-100 rounded-lg font-bold text-xs border border-gray-200",children:t.belt})}),e.jsx("td",{className:"p-4",children:t.balance>0?e.jsxs("span",{className:"text-red-600 font-bold bg-red-50 px-2 py-1 rounded text-xs",children:["Ø¹Ù„ÙŠÙ‡ ",t.balance]}):e.jsx("span",{className:"text-green-600 font-bold text-xs",children:"Ø®Ø§Ù„Øµ"})}),e.jsx("td",{className:"p-4",children:e.jsx(Me,{status:Ke(t.subEnd)})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>M(t),className:"bg-green-100 text-green-700 p-2 rounded-lg hover:bg-green-600 hover:text-white transition",title:"ØªØ¬Ø¯ÙŠØ¯ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ",children:e.jsx(et,{size:16})}),e.jsx("button",{onClick:()=>o(t),className:`p-2 rounded-lg transition ${G||F?"bg-yellow-100 text-yellow-700":"bg-gray-50 text-gray-400 hover:text-yellow-600"}`,title:"Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª",children:e.jsx(ge,{size:16})}),e.jsx("button",{onClick:()=>re(t),className:"bg-blue-50 text-blue-600 p-2 rounded-lg hover:bg-blue-600 hover:text-white transition",title:"ØªØ±ÙÙŠØ¹",children:e.jsx(Ae,{size:16})}),e.jsx("button",{onClick:()=>y(t),className:"bg-gray-100 text-gray-600 p-2 rounded-lg hover:bg-gray-600 hover:text-white transition",title:"ØªØ¹Ø¯ÙŠÙ„",children:e.jsx(tt,{size:16})}),e.jsx("button",{onClick:()=>ae(t),className:"bg-red-50 text-red-600 p-2 rounded-lg hover:bg-red-600 hover:text-white transition",title:"Ø£Ø±Ø´ÙØ©",children:e.jsx(Oe,{size:16})})]})})]},t.id)})})]})})}),e.jsxs("div",{className:"md:hidden grid grid-cols-1 gap-4",children:[_.map(t=>{const C=xt(t.joinDate),F=Ke(t.subEnd),G=t.internalNotes&&t.internalNotes.length>0||t.note&&t.note.trim()!=="";return e.jsxs("div",{className:`bg-white p-4 rounded-xl shadow-sm border ${G?"border-red-200 ring-1 ring-red-100":"border-gray-100"} flex flex-col gap-3 relative`,children:[G&&e.jsx("div",{className:"absolute top-4 left-14 animate-pulse",children:e.jsx(dt,{size:20,className:"text-red-500 fill-red-100"})}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-bold text-gray-800 text-lg",children:t.name}),C&&e.jsx("span",{className:"text-[10px] bg-red-100 text-red-600 px-2 rounded-full animate-pulse",children:"NEW"})]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-0.5",children:["Ù…Ù†Ø°: ",t.joinDate]}),e.jsx("span",{className:"text-[10px] bg-blue-50 text-blue-700 px-1.5 py-0.5 rounded font-bold mt-1 inline-block",children:t.group||"ØºÙŠØ± Ù…Ø­Ø¯Ø¯"})]}),e.jsx(Me,{status:F})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"bg-gray-50 p-2 rounded-lg",children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"Ø§Ù„Ø­Ø²Ø§Ù…"}),e.jsx("span",{className:"font-bold text-gray-800",children:t.belt})]}),e.jsxs("div",{className:`p-2 rounded-lg ${t.balance>0?"bg-red-50 text-red-700":"bg-green-50 text-green-700"}`,children:[e.jsx("span",{className:"text-xs block opacity-70",children:"Ø§Ù„Ø±ØµÙŠØ¯"}),e.jsx("span",{className:"font-bold",children:t.balance>0?`Ø¹Ù„ÙŠÙ‡ ${t.balance}`:"Ø®Ø§Ù„Øµ"})]})]}),e.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-2 rounded-lg border border-gray-100 border-dashed",children:[e.jsxs("div",{className:"text-xs font-mono text-gray-600",children:[e.jsxs("div",{className:"mb-1",children:[e.jsx("span",{className:"font-bold text-blue-800",children:"U:"})," ",t.username]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-red-600",children:"P:"})," ",t.password]})]}),e.jsx("button",{onClick:()=>E(t),className:"p-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200",children:e.jsx(Ce,{size:16})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-100 mt-1",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("a",{href:`tel:${t.phone}`,className:"p-2 bg-gray-100 rounded-full text-gray-600",children:e.jsx(Ie,{size:16})}),e.jsx("button",{onClick:()=>U(t.phone),className:"p-2 bg-green-100 rounded-full text-[#25D366]",children:e.jsx(be,{size:16})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>M(t),className:"p-2 bg-green-100 text-green-700 rounded-lg",children:e.jsx(et,{size:16})}),e.jsx("button",{onClick:()=>o(t),className:`p-2 rounded-lg ${G?"bg-red-100 text-red-600":"bg-gray-100 text-gray-600"}`,children:e.jsx(ge,{size:16})}),e.jsx("button",{onClick:()=>re(t),className:"p-2 bg-blue-50 text-blue-600 rounded-lg",children:e.jsx(Ae,{size:16})}),e.jsx("button",{onClick:()=>y(t),className:"p-2 bg-yellow-50 text-yellow-600 rounded-lg",children:e.jsx(tt,{size:16})}),e.jsx("button",{onClick:()=>ae(t),className:"p-2 bg-red-50 text-red-600 rounded-lg",children:e.jsx(Oe,{size:16})})]})]})]},t.id)}),_.length===0&&e.jsx("div",{className:"text-center p-8 text-gray-400",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬"})]}),S&&e.jsx(Te,{onClose:q,children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 border-b pb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:j?"ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨":"Ø¥Ø¶Ø§ÙØ© 'Ø·Ø§Ù„Ø¨' Ø¬Ø¯ÙŠØ¯"}),e.jsx("button",{onClick:q,className:"text-gray-400 hover:text-red-500 transition-colors",children:e.jsx(xe,{size:24})})]}),e.jsxs("form",{onSubmit:j?X:W,className:"space-y-4 text-right",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2 bg-gradient-to-r from-yellow-50 to-white p-4 rounded-xl border border-yellow-200 mb-2",children:[e.jsxs("p",{className:"text-xs font-bold text-yellow-700 mb-3 flex items-center gap-1",children:[e.jsx(ot,{size:12})," Ø¨ÙŠØ§Ù†Ø§Øª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ (Ø§ØªØ±ÙƒÙ‡Ø§ ÙØ§Ø±ØºØ© Ù„Ù„ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ)"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold text-gray-500 mb-1 uppercase tracking-wider",children:"Username"}),e.jsx("input",{className:"w-full border border-gray-200 p-2 rounded-lg bg-white font-mono text-left dir-ltr focus:border-yellow-500 outline-none",value:$.username,onChange:t=>H({...$,username:t.target.value}),placeholder:"Auto-generated"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold text-gray-500 mb-1 uppercase tracking-wider",children:"Password"}),e.jsx("input",{className:"w-full border border-gray-200 p-2 rounded-lg bg-white font-mono text-left dir-ltr focus:border-yellow-500 outline-none",value:$.password,onChange:t=>H({...$,password:t.target.value}),placeholder:"Auto-generated"})]})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ"}),e.jsx("input",{required:!0,className:"w-full border-2 border-gray-100 focus:border-yellow-500 p-2.5 rounded-xl outline-none transition-all",value:$.name,onChange:t=>H({...$,name:t.target.value}),placeholder:"Ù…Ø«Ø§Ù„: Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-bold text-blue-800 mb-1",children:"Ø§Ù„ÙØªØ±Ø© / Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©"}),e.jsxs("select",{className:"w-full border-2 border-blue-100 focus:border-blue-500 p-2.5 rounded-xl bg-blue-50/50 outline-none",value:$.group,onChange:t=>H({...$,group:t.target.value}),children:[e.jsx("option",{value:"",children:"Ø¨Ø¯ÙˆÙ† ØªØ­Ø¯ÙŠØ¯"}),T.map((t,C)=>e.jsx("option",{value:t,children:t},C))]})]}),!j&&e.jsxs("div",{className:"md:col-span-2 bg-blue-50 p-3 rounded-xl border border-blue-100",children:[e.jsx("label",{className:"block text-xs font-bold text-blue-800 mb-1",children:"Ø§Ù„Ø¹Ø§Ø¦Ù„Ø© (Ù„Ù„Ø®ØµÙˆÙ…Ø§Øª)"}),e.jsxs("select",{className:"w-full border border-blue-200 p-2 rounded-lg bg-white focus:ring-2 focus:ring-blue-200 outline-none",value:g,onChange:t=>R(t.target.value),children:[e.jsx("option",{value:"new",children:"ØªØ³Ø¬ÙŠÙ„ ÙƒØ¹Ø§Ø¦Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©"}),K.map(t=>e.jsxs("option",{value:t.id,children:["Ø§Ù†Ø¶Ù…Ø§Ù… Ù„Ù€ ",t.displayName]},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ"}),e.jsx("input",{required:!0,className:"w-full border-2 border-gray-100 focus:border-yellow-500 p-2.5 rounded-xl outline-none",value:$.phone,onChange:t=>H({...$,phone:t.target.value}),placeholder:"079xxxxxxx"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"Ø§Ù„Ø­Ø²Ø§Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ"}),e.jsx("select",{className:"w-full border-2 border-gray-100 focus:border-yellow-500 p-2.5 rounded-xl bg-white outline-none",value:$.belt,onChange:t=>H({...$,belt:t.target.value}),children:V.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-red-600 mb-1",children:"Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø§ÙØªØªØ§Ø­ÙŠ (Ø¯ÙŠÙ†Ø§Ø±)"}),e.jsx("input",{type:"number",className:"w-full border-2 border-red-50 focus:border-red-500 p-2.5 rounded-xl outline-none bg-red-50/30",value:$.balance,onChange:t=>H({...$,balance:t.target.value}),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯"}),e.jsx("input",{type:"date",className:"w-full border-2 border-gray-100 focus:border-yellow-500 p-2.5 rounded-xl outline-none",value:$.dob,onChange:t=>H({...$,dob:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù„ØªØ­Ø§Ù‚"}),e.jsx("input",{type:"date",className:"w-full border-2 border-gray-100 focus:border-yellow-500 p-2.5 rounded-xl outline-none",value:$.joinDate,onChange:t=>H({...$,joinDate:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-green-600 mb-1",children:"Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ"}),e.jsx("input",{type:"date",className:"w-full border-2 border-green-50 focus:border-green-500 p-2.5 rounded-xl outline-none bg-green-50/30",value:$.subEnd,onChange:t=>H({...$,subEnd:t.target.value})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"Ø§Ù„Ø¹Ù†ÙˆØ§Ù†"}),e.jsx("input",{className:"w-full border-2 border-gray-100 focus:border-yellow-500 p-2.5 rounded-xl outline-none",value:$.address,onChange:t=>H({...$,address:t.target.value}),placeholder:"Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© - Ø§Ù„Ù…Ù†Ø·Ù‚Ø© - Ø§Ù„Ø´Ø§Ø±Ø¹"})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end mt-8 pt-4 border-t border-gray-100",children:[e.jsx(L,{type:"button",variant:"ghost",onClick:q,className:"text-gray-500 hover:bg-gray-100",children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(L,{type:"submit",className:"bg-yellow-500 text-black font-bold hover:bg-yellow-400 shadow-lg shadow-yellow-500/20 px-8",children:j?"Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª":"Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ø§Ù„Ø¨"})]})]})]})})]})},ms=({archiveCollection:a,studentsCollection:r,payments:n,logActivity:x})=>{const[l,i]=b.useState(null),[s,m]=b.useState(null),[v,w]=b.useState(""),c=a.data.filter(h=>h.name.includes(v)),d=async h=>{if(!window.confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© ØªÙØ¹ÙŠÙ„ Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø·Ø§Ù„Ø¨ ${h.name}ØŸ

(Ø³ÙŠØªÙ… Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù„ØªØ­Ø§Ù‚ Ø§Ù„Ø£ØµÙ„ÙŠ)`))return;const{archivedAt:f,originalId:p,id:I,...o}=h;await r.add({...o,status:"active",joinDate:o.joinDate||new Date().toISOString().split("T")[0]}),await a.remove(h.id),x("Ø§Ø³ØªØ¹Ø§Ø¯Ø©",`ØªÙ…Øª Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø·Ø§Ù„Ø¨ ${h.name} Ù…Ù† Ø§Ù„Ø£Ø±Ø´ÙŠÙ`)},S=(h,f)=>{alert("Print functionality for: "+h.id)},u=h=>{if(!h)return;let f=h.replace(/\D/g,"");f.startsWith("0")&&(f=f.substring(1)),window.open(`https://wa.me/962${f}`,"_blank")},j=h=>{const f=h.originalId||h.id;return n.filter(p=>p.studentId===f||p.studentIds&&p.studentIds.includes(f))};return e.jsxs("div",{className:"space-y-6",children:[s&&e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-[60] p-4 backdrop-blur-sm",children:e.jsxs(J,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",title:`Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ù…Ø¤Ø±Ø´Ù: ${s.name}`,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl border border-gray-100",children:[e.jsxs("h4",{className:"font-bold text-gray-800 border-b pb-2 mb-3 flex items-center gap-2",children:[e.jsx(We,{size:16,className:"text-blue-600"})," Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500 font-bold",children:"Ø§Ù„Ø§Ø³Ù…:"})," ",s.name]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500 font-bold",children:"Ø§Ù„Ù‡Ø§ØªÙ:"})," ",s.phone]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500 font-bold",children:"Ø§Ù„Ø­Ø²Ø§Ù…:"})," ",s.belt]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500 font-bold",children:"Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©:"})," ",s.group||"ØºÙŠØ± Ù…Ø­Ø¯Ø¯"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500 font-bold",children:"ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯:"})," ",s.dob||"ØºÙŠØ± Ù…Ø¯Ø®Ù„"]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl border border-gray-100",children:[e.jsxs("h4",{className:"font-bold text-gray-800 border-b pb-2 mb-3 flex items-center gap-2",children:[e.jsx(pe,{size:16,className:"text-green-600"})," Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® ÙˆØ§Ù„Ø¹Ù†ÙˆØ§Ù†"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500 font-bold",children:"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù„ØªØ­Ø§Ù‚ Ø§Ù„Ø£ØµÙ„ÙŠ:"})," ",s.joinDate]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500 font-bold",children:"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø£Ø±Ø´ÙØ©:"})," ",s.archivedAt]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500 font-bold",children:"ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ (Ø¹Ù†Ø¯ Ø§Ù„Ø£Ø±Ø´ÙØ©):"})," ",s.subEnd]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx($e,{size:14,className:"text-gray-400 mt-1"}),e.jsx("span",{className:"text-gray-800",children:s.address||"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù†ÙˆØ§Ù† Ù…Ø³Ø¬Ù„"})]})]})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-xl border border-yellow-200",children:[e.jsxs("h4",{className:"font-bold text-gray-800 border-b border-yellow-200 pb-2 mb-3 flex items-center gap-2",children:[e.jsx(ge,{size:16,className:"text-yellow-600"})," Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„"]}),e.jsxs("div",{className:"space-y-2 text-sm font-mono dir-ltr text-right",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500 font-sans font-bold float-right ml-2",children:":Username"})," ",s.username]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500 font-sans font-bold float-right ml-2",children:":Password"})," ",s.password]})]})]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-xl border border-red-200",children:[e.jsxs("h4",{className:"font-bold text-gray-800 border-b border-red-200 pb-2 mb-3 flex items-center gap-2",children:[e.jsx(qe,{size:16,className:"text-red-600"})," Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¯Ø§Ø±ÙŠØ©"]}),e.jsx("div",{className:"max-h-32 overflow-y-auto custom-scrollbar text-sm",children:s.internalNotes&&s.internalNotes.length>0?e.jsx("ul",{className:"list-disc list-inside space-y-1",children:s.internalNotes.map((h,f)=>e.jsxs("li",{className:"text-gray-700",children:[h.text," ",e.jsxs("span",{className:"text-xs text-gray-400",children:["(",h.date,")"]})]},f))}):e.jsx("p",{className:"text-gray-400 italic",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª"})})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx(L,{onClick:()=>m(null),children:"Ø¥ØºÙ„Ø§Ù‚"}),e.jsxs(L,{className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>{d(s),m(null)},children:[e.jsx(it,{size:16,className:"ml-2"})," Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø·Ø§Ù„Ø¨"]})]})]})}),l&&e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-[60] p-4 backdrop-blur-sm",children:e.jsxs(J,{className:"w-full max-w-2xl max-h-[80vh] overflow-y-auto",title:`Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø§Ù„ÙŠ: ${l.name}`,children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:`p-4 rounded-xl border-2 text-center ${l.balance>0?"bg-red-50 border-red-500":"bg-green-50 border-green-500"}`,children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ (Ø°Ù…Ù…)"}),e.jsxs("p",{className:`text-2xl font-bold ${l.balance>0?"text-red-600":"text-green-600"}`,children:[l.balance," JOD"]})]}),e.jsxs("div",{className:"p-4 rounded-xl border bg-gray-50 text-center",children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø£Ø±Ø´ÙØ©"}),e.jsx("p",{className:"text-xl font-bold",children:l.archivedAt||"ØºÙŠØ± Ù…Ø³Ø¬Ù„"})]})]}),e.jsxs("h4",{className:"font-bold border-b pb-2 mb-4 text-gray-800 flex items-center gap-2",children:[e.jsx(at,{size:18,className:"text-green-600"})," Ø³Ø¬Ù„ Ø§Ù„Ø¯ÙØ¹Ø§Øª ÙˆØ§Ù„ÙˆØµÙ„Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©"]}),j(l).length>0?e.jsx("div",{className:"space-y-3",children:j(l).map(h=>e.jsxs("div",{className:"flex justify-between items-center bg-white p-3 rounded-lg border hover:shadow-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-800",children:h.reason}),e.jsxs("p",{className:"text-xs text-gray-500",children:[h.date," - ",h.branch]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"font-bold text-green-600",children:[h.amount," JOD"]}),e.jsx("button",{onClick:()=>S(h,h.branch),className:"text-gray-400 hover:text-black",title:"Ø·Ø¨Ø§Ø¹Ø© Ù†Ø³Ø®Ø©",children:e.jsx(ue,{size:16})})]})]},h.id))}):e.jsx("div",{className:"text-center py-8 bg-gray-50 rounded border-2 border-dashed",children:e.jsx("p",{className:"text-gray-400",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª Ù…Ø§Ù„ÙŠØ© Ù…Ø¤Ø±Ø´ÙØ© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø·Ø§Ù„Ø¨"})}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx(L,{onClick:()=>i(null),children:"Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…Ù„Ù"})})]})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(Oe,{className:"text-red-500"})," Ø£Ø±Ø´ÙŠÙ Ø§Ù„Ø·Ù„Ø§Ø¨"]}),e.jsx("div",{className:"w-64",children:e.jsx("input",{className:"w-full border p-2 rounded shadow-sm",placeholder:"Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø£Ø±Ø´ÙŠÙ...",value:v,onChange:h=>w(h.target.value)})})]}),e.jsx(J,{noPadding:!0,children:c.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Oe,{size:48,className:"mx-auto text-gray-300 mb-2"}),e.jsx("p",{className:"text-gray-500",children:"Ø§Ù„Ø£Ø±Ø´ÙŠÙ ÙØ§Ø±Øº Ø­Ø§Ù„ÙŠØ§Ù‹"})]}):e.jsxs("table",{className:"w-full text-right text-sm",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨"}),e.jsx("th",{className:"p-4",children:"Ø§Ù„Ù‡Ø§ØªÙ"}),e.jsx("th",{className:"p-4",children:"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø£Ø±Ø´ÙØ©"}),e.jsx("th",{className:"p-4",children:"Ø§Ù„Ø°Ù…Ù… Ø§Ù„Ù…Ø§Ù„ÙŠØ©"}),e.jsx("th",{className:"p-4",children:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsx("tbody",{className:"divide-y",children:c.map(h=>e.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[e.jsxs("td",{className:"p-4 font-bold text-gray-800",children:[h.name," ",e.jsx("br",{}),e.jsx("span",{className:"text-xs font-normal text-gray-500",children:h.belt})]}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("a",{href:`tel:${h.phone}`,className:"hover:text-blue-600",children:h.phone}),e.jsx("button",{onClick:()=>u(h.phone),className:"text-green-500 hover:bg-green-100 p-1 rounded-full",children:e.jsx(be,{size:16})})]})}),e.jsx("td",{className:"p-4 text-gray-600",children:h.archivedAt}),e.jsx("td",{className:"p-4",children:Number(h.balance)>0?e.jsxs("span",{className:"bg-red-100 text-red-700 px-3 py-1 rounded-full font-bold text-xs",children:["Ø¹Ù„ÙŠÙ‡ ",h.balance," JOD"]}):e.jsxs("span",{className:"bg-green-100 text-green-700 px-3 py-1 rounded-full font-bold text-xs flex items-center gap-1 w-fit",children:[e.jsx(Ne,{size:12})," Ø®Ø§Ù„Øµ"]})}),e.jsxs("td",{className:"p-4 flex gap-2",children:[e.jsx("button",{onClick:()=>m(h),className:"bg-gray-50 text-gray-600 p-2 rounded hover:bg-gray-200 border border-gray-200",title:"Ø¹Ø±Ø¶ ÙƒØ§ÙØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª",children:e.jsx(Ht,{size:16})}),e.jsxs(L,{variant:"outline",className:"py-1 px-3 text-xs border-gray-300 hover:bg-gray-100 text-gray-700",onClick:()=>i(h),children:[e.jsx(ve,{size:14,className:"ml-1"})," Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø§Ù„ÙŠ"]}),e.jsx("button",{onClick:()=>d(h),className:"bg-blue-50 text-blue-600 p-2 rounded hover:bg-blue-100 border border-blue-200",title:"Ø¥Ø¹Ø§Ø¯Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨ (Ø§Ø³ØªØ±Ø¬Ø§Ø¹)",children:e.jsx(it,{size:16})}),e.jsx("button",{onClick:async()=>{window.confirm("Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠ Ù…Ù† Ø§Ù„Ø³Ø¬Ù„Ø§ØªØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹!")&&await a.remove(h.id)},className:"bg-red-50 text-red-600 p-2 rounded hover:bg-red-100 border border-red-200",title:"Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠ",children:e.jsx(de,{size:16})})]})]},h.id))})]})})]})},hs=({isOpen:a,onClose:r,reasons:n,onAdd:x,onDelete:l})=>{const[i,s]=b.useState("");return a?He.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm",onClick:r}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-md p-6 animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(_e,{size:20,className:"text-gray-600"})," Ø¥Ø¯Ø§Ø±Ø© Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø¯ÙØ¹"]}),e.jsx("button",{onClick:r,children:e.jsx(xe,{size:20,className:"text-gray-400 hover:text-red-500"})})]}),e.jsxs("div",{className:"flex gap-2 mb-6",children:[e.jsx("input",{className:"flex-1 border-2 border-gray-200 rounded-xl px-4 py-2 focus:border-green-500 outline-none",placeholder:"Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ø¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯...",value:i,onChange:m=>s(m.target.value)}),e.jsx("button",{onClick:()=>{i&&(x(i),s(""))},className:"bg-green-600 text-white p-3 rounded-xl hover:bg-green-700",children:e.jsx(lt,{size:20})})]}),e.jsxs("div",{className:"space-y-2 max-h-60 overflow-y-auto mb-4 custom-scrollbar",children:[n.map((m,v)=>e.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-3 rounded-xl border border-gray-100",children:[e.jsx("span",{className:"font-bold text-gray-700",children:m.title}),e.jsx("button",{onClick:()=>l(m),className:"text-red-500 hover:bg-red-50 p-2 rounded-lg transition-colors",children:e.jsx(de,{size:18})})]},v)),n.length===0&&e.jsx("p",{className:"text-center text-gray-400 text-sm",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨Ù†ÙˆØ¯ Ù…Ø¶Ø§ÙØ©"})]})]})]}),document.body):null},bs=({isOpen:a,onClose:r,onGenerate:n})=>{const[x,l]=b.useState(new Date().toISOString().split("T")[0]),[i,s]=b.useState(new Date().toISOString().split("T")[0]);return a?He.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm",onClick:r}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-md p-6 animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-xl font-bold flex items-center gap-2 text-blue-800",children:[e.jsx(jt,{size:24})," Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙØµÙ„"]}),e.jsx("button",{onClick:r,children:e.jsx(xe,{size:20,className:"text-gray-400 hover:text-red-500"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Ù…Ù† ØªØ§Ø±ÙŠØ®"}),e.jsx("input",{type:"date",value:x,onChange:m=>l(m.target.value),className:"w-full border-2 border-gray-200 p-3 rounded-xl outline-none focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®"}),e.jsx("input",{type:"date",value:i,onChange:m=>s(m.target.value),className:"w-full border-2 border-gray-200 p-3 rounded-xl outline-none focus:border-blue-500"})]}),e.jsx("div",{className:"pt-4",children:e.jsxs(L,{onClick:()=>n(x,i),className:"w-full bg-blue-600 text-white hover:bg-blue-700 py-3 shadow-lg shadow-blue-600/20",children:[e.jsx(ue,{size:18,className:"ml-2"})," Ø§Ø³ØªØ®Ø±Ø§Ø¬ ÙˆØ·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±"]})})]})]})]}),document.body):null};function gs({students:a,payments:r,expenses:n,paymentsCollection:x,expensesCollection:l,selectedBranch:i,logActivity:s,financeReasons:m=[],financeReasonsCollection:v}){const[w,c]=b.useState("income"),[d,S]=b.useState({sid:"",amount:"",reason:"",customReason:"",details:"",method:"cash"}),[u,j]=b.useState({title:"",amount:"",date:new Date().toISOString().split("T")[0]}),[h,f]=b.useState(null),[p,I]=b.useState(!1),[o,k]=b.useState(!1),A=r.filter(y=>y.branch===i),O=n.filter(y=>y.branch===i),M=(h?A.filter(y=>y.studentId===h):A).sort((y,q)=>new Date(q.createdAt||q.date)-new Date(y.createdAt||y.date)),T=[...O].sort((y,q)=>new Date(q.date)-new Date(y.date)),N=async y=>{if(m.some(q=>q.title===y))return alert("Ù‡Ø°Ø§ Ø§Ù„Ø¨Ù†Ø¯ Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹");await v.add({title:y,branch:i,createdAt:new Date().toISOString()})},$=async y=>{confirm(`Ø­Ø°Ù Ø§Ù„Ø¨Ù†Ø¯ "${y.title}"ØŸ`)&&await v.remove(y.id)},H=async y=>{if(y.preventDefault(),!d.studentObjId)return alert("Ø§Ø®ØªØ± Ø·Ø§Ù„Ø¨Ø§Ù‹");const q=a.find(ae=>ae.id===d.studentObjId);if(!q)return alert("Ø·Ø§Ù„Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯");if(!d.reason&&m.length>0)return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø³Ø¨Ø¨ Ø§Ù„Ø¯ÙØ¹");const X=d.reason==="Ø£Ø®Ø±Ù‰"?d.customReason:d.reason,re={id:Date.now().toString(),studentId:q.id,name:q.name,amount:Number(d.amount),reason:X,details:d.details,method:d.method||"cash",date:new Date().toISOString().split("T")[0],branch:i};await x.add(re),s("Ù‚Ø¨Ø¶ Ù…Ø§Ù„ÙŠ",`Ø§Ø³ØªÙ„Ø§Ù… ${d.amount} (${d.method==="cliq"?"ÙƒÙ„ÙŠÙƒ":"ÙƒØ§Ø´"}) Ù…Ù† ${q.name}`),S({sid:"",amount:"",reason:"",customReason:"",details:"",method:"cash"})},g=async y=>{y.preventDefault(),await l.add({id:Date.now().toString(),title:u.title,amount:Number(u.amount),date:u.date,branch:i}),s("Ù…ØµØ±ÙˆÙ",`ØµØ±Ù ${u.amount} Ù„Ù€ ${u.title}`),j({title:"",amount:"",date:new Date().toISOString().split("T")[0]})},R=async y=>{confirm("Ø­Ø°Ù Ø§Ù„Ø³Ù†Ø¯ØŸ")&&await x.remove(y)},K=async y=>{confirm("Ø­Ø°Ù Ø§Ù„Ù…ØµØ±ÙˆÙØŸ")&&await l.remove(y)},_=(y,q)=>{const X=A.filter(E=>{const t=new Date(E.date),C=new Date(y),F=new Date(q);return t>=C&&t<=F}).sort((E,t)=>new Date(E.date)-new Date(t.date)),re=X.filter(E=>!E.method||E.method==="cash").reduce((E,t)=>E+t.amount,0),ae=X.filter(E=>E.method==="cliq").reduce((E,t)=>E+t.amount,0),me=re+ae,D=window.open("","REPORT","height=800,width=1000"),P=window.location.origin+oe.LOGO,U=`
      <!DOCTYPE html>
      <html lang="ar" dir="rtl">
        <head>
          <meta charset="UTF-8">
          <title>ØªÙ‚Ø±ÙŠØ± Ù…Ø§Ù„ÙŠ - ${i}</title>
          <style>
             @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');
             body { font-family: 'Cairo', sans-serif; padding: 20px; }
             .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 20px; }
             .logo { height: 80px; margin-bottom: 10px; }
             .stats-box { display: flex; gap: 20px; margin-bottom: 30px; justify-content: center; }
             .stat { border: 1px solid #ddd; padding: 15px; border-radius: 10px; width: 200px; text-align: center; }
             .stat-title { font-size: 14px; color: #666; font-weight: bold; }
             .stat-value { font-size: 24px; font-weight: bold; margin-top: 5px; }
             .cash { border-color: #16a34a; background: #f0fdf4; color: #16a34a; }
             .cliq { border-color: #2563eb; background: #eff6ff; color: #2563eb; }
             .total { border-color: #000; background: #fafafa; color: #000; }
             
             table { width: 100%; border-collapse: collapse; font-size: 14px; }
             th, td { border: 1px solid #ddd; padding: 10px; text-align: right; }
             th { background-color: #f3f4f6; }
             tr:nth-child(even) { background-color: #f9fafb; }
             
             @media print {
                button { display: none; }
                body { padding: 0; }
             }
          </style>
        </head>
        <body>
            <div class="header">
                <img src="${P}" class="logo" onerror="this.style.display='none'"/>
                <h2>ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ù‚Ø¨ÙˆØ¶Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠ</h2>
                <p>Ø§Ù„ÙØ±Ø¹: ${i}</p>
                <p>Ø§Ù„ÙØªØ±Ø©: Ù…Ù† <strong>${y}</strong> Ø¥Ù„Ù‰ <strong>${q}</strong></p>
            </div>

            <div class="stats-box">
                <div class="stat cash">
                    <div class="stat-title">Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒØ§Ø´</div>
                    <div class="stat-value">${re} JD</div>
                </div>
                <div class="stat cliq">
                    <div class="stat-title">Ù…Ø¬Ù…ÙˆØ¹ ÙƒÙ„ÙŠÙƒ (CliQ)</div>
                    <div class="stat-value">${ae} JD</div>
                </div>
                <div class="stat total">
                    <div class="stat-title">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒÙ„ÙŠ</div>
                    <div class="stat-value">${me} JD</div>
                </div>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                        <th>Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                        <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                        <th>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</th>
                        <th>Ø§Ù„Ø¨ÙŠØ§Ù†</th>
                    </tr>
                </thead>
                <tbody>
                    ${X.map((E,t)=>`
                        <tr>
                            <td>${t+1}</td>
                            <td>${E.date}</td>
                            <td>${E.name}</td>
                            <td style="font-weight:bold">${E.amount}</td>
                            <td>${E.method==="cliq"?"ÙƒÙ„ÙŠÙƒ (CliQ)":"ÙƒØ§Ø´"}</td>
                            <td>${E.reason} ${E.details?`(${E.details})`:""}</td>
                        </tr>
                    `).join("")}
                    ${X.length===0?'<tr><td colspan="6" style="text-align:center">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©</td></tr>':""}
                </tbody>
            </table>

            <div style="margin-top: 40px; display: flex; justify-content: space-between; padding: 0 50px;">
                <div> </div>
                <div>ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</div>
            </div>
            
            <script>
               window.onload = function() { window.print(); }
            <\/script>
        </body>
      </html>
    `;D.document.write(U),D.document.close(),k(!1)},W=y=>{const q=window.open("","PRINT","height=800,width=1000"),X=window.location.origin+oe.LOGO,re=y.method==="cliq"?"ÙƒÙ„ÙŠÙƒ (CliQ)":"Ù†Ù‚Ø¯Ù‹Ø§ (Cash)",ae=`
      <!DOCTYPE html>
      <html lang="ar" dir="rtl">
        <head>
          <meta charset="UTF-8">
          <title>Ø³Ù†Ø¯ Ù‚Ø¨Ø¶ - ${y.name}</title>
          <style>
            @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap');
            @page { size: A5 landscape; margin: 0; }
            body { font-family: 'Cairo', sans-serif; margin: 0; padding: 10mm; background-color: white; -webkit-print-color-adjust: exact; print-color-adjust: exact; height: 100vh; box-sizing: border-box; }
            .receipt-border { border: 3px double #444; height: 96%; position: relative; padding: 20px; box-sizing: border-box; display: flex; flex-direction: column; justify-content: space-between; overflow: hidden; }
            .watermark { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-25deg); width: 50%; opacity: 0.08; z-index: 0; pointer-events: none; filter: grayscale(100%); }
            .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #b45309; padding-bottom: 10px; margin-bottom: 15px; position: relative; z-index: 2; }
            .company-info h1 { margin: 0; font-size: 22px; color: #b45309; font-weight: 900; }
            .company-info p { margin: 2px 0; font-size: 12px; font-weight: bold; color: #555; }
            .logo img { height: 70px; object-fit: contain; }
            .meta-info { text-align: left; font-size: 12px; border-right: 2px solid #eee; padding-right: 10px; }
            .meta-info div { margin-bottom: 3px; }
            .content { position: relative; z-index: 2; flex-grow: 1; }
            .title { text-align: center; font-size: 24px; font-weight: 900; margin: 10px 0 20px; text-decoration: underline; text-decoration-color: #b45309; text-underline-offset: 5px; }
            .row { display: flex; align-items: baseline; margin-bottom: 12px; font-size: 16px; }
            .label { font-weight: bold; width: 110px; color: #333; }
            .value { flex: 1; border-bottom: 1px dotted #888; font-weight: 700; padding: 0 5px; }
            .amount-container { position: absolute; left: 20px; top: 40px; border: 2px solid #333; padding: 5px 15px; border-radius: 8px; background: #f9f9f9; transform: rotate(-5deg); box-shadow: 2px 2px 0 #ccc; }
            .amount-number { font-size: 20px; font-weight: 900; direction: ltr; }
            .footer { margin-top: 20px; position: relative; z-index: 2; }
            .signatures { display: flex; justify-content: space-between; padding: 0 40px; margin-bottom: 15px; }
            .sign-box { text-align: center; width: 150px; }
            .sign-line { border-top: 1px solid #333; margin-bottom: 5px; }
            .sign-title { font-size: 12px; font-weight: bold; color: #555; }
            .branches-box { border-top: 2px solid #b45309; padding-top: 8px; font-size: 10px; display: flex; justify-content: space-between; background: #fff; }
            .branch { display: flex; flex-direction: column; width: 48%; }
            .branch span { display: block; margin-bottom: 2px; }
            .phone { direction: ltr; text-align: right; font-weight: bold; }
          </style>
        </head>
        <body>
          <div class="receipt-border">
            <img src="${X}" class="watermark" onerror="this.style.display='none'"/>
            <div class="header">
              <div class="company-info">
                <h1>Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø§Ù„Ø´Ø¬Ø§Ø¹ Ù„Ù„ØªØ§ÙŠÙƒÙˆØ§Ù†Ø¯Ùˆ</h1>
                <p>ÙØ±Ø¹: ${i}</p>
              </div>
              <div class="logo">
                <img src="${X}" onerror="this.style.display='none'"/>
              </div>
              <div class="meta-info">
                <div>Ø±Ù‚Ù… Ø§Ù„Ø³Ù†Ø¯: <strong>${y.id.slice(-6)}</strong></div>
                <div>Ø§Ù„ØªØ§Ø±ÙŠØ®: <strong>${y.date}</strong></div>
              </div>
            </div>
            <div class="content">
              <div class="title">Ø³Ù†Ø¯ Ù‚Ø¨Ø¶</div>
              <div class="amount-container">
                <div class="amount-number">${y.amount} JD</div>
              </div>
              <div class="row">
                <span class="label">Ø§Ø³ØªÙ„Ù…Ù†Ø§ Ù…Ù†:</span>
                <span class="value">${y.name}</span>
              </div>
              <div class="row">
                <span class="label">Ù…Ø¨Ù„Øº ÙˆÙ‚Ø¯Ø±Ù‡:</span>
                <span class="value">${y.amount} Ø¯ÙŠÙ†Ø§Ø± Ø£Ø±Ø¯Ù†ÙŠ</span>
              </div>
              <div class="row">
                <span class="label">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹:</span>
                <span class="value">${re}</span>
              </div>
              <div class="row">
                <span class="label">ÙˆØ°Ù„Ùƒ Ø¹Ù†:</span>
                <span class="value">${y.reason} ${y.details?`(${y.details})`:""}</span>
              </div>
            </div>
            <div class="footer">
              <div class="signatures">
                <div class="sign-box">
                  <div class="sign-line"></div>
                  <div class="sign-title">ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø§Ø¯Ø§Ø±Ø©</div>
                </div>
                <div class="sign-box">
                  <div class="sign-line"></div>
                  <div class="sign-title">ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙ„Ù…</div>
                </div>
              </div>
              <div class="branches-box">
                <div class="branch">
                  <span style="font-weight:bold; color:#b45309">Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø£ÙˆÙ„: Ø´ÙØ§Ø¨Ø¯Ø±Ø§Ù†</span>
                  <span>Ø´Ø§Ø±Ø¹ Ø±ÙØ¹Øª Ø´Ù…ÙˆØ·</span>
                  <span class="phone">079 5629 606</span>
                </div>
                <div class="branch">
                  <span style="font-weight:bold; color:#b45309">Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø«Ø§Ù†ÙŠ: Ø£Ø¨Ùˆ Ù†ØµÙŠØ±</span>
                  <span>Ø¯ÙˆØ§Ø± Ø§Ù„Ø¨Ø­Ø±ÙŠØ© - Ù…Ø¬Ù…Ø¹ Ø§Ù„ÙØ±Ù‘Ø§</span>
                  <span class="phone">079 0368 603</span>
                </div>
              </div>
            </div>
          </div>
        </body>
      </html>
    `;q.document.write(ae),q.document.close(),q.onload=()=>{q.focus(),setTimeout(()=>{q.print(),q.close()},500)}};return e.jsxs("div",{className:"space-y-6 animate-fade-in pb-20 md:pb-0",children:[e.jsx(hs,{isOpen:p,onClose:()=>I(!1),reasons:m,onAdd:N,onDelete:$}),e.jsx(bs,{isOpen:o,onClose:()=>k(!1),onGenerate:_}),e.jsxs("div",{className:"flex gap-4 mb-6 bg-gray-100 p-1 rounded-2xl",children:[e.jsx("button",{onClick:()=>c("income"),className:`flex-1 py-3 rounded-xl font-bold transition-all shadow-sm ${w==="income"?"bg-green-600 text-white shadow-green-200":"bg-white text-gray-500 hover:bg-gray-50"}`,children:"Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª (Ø§Ù„Ù‚Ø¨Ø¶)"}),e.jsx("button",{onClick:()=>c("expense"),className:`flex-1 py-3 rounded-xl font-bold transition-all shadow-sm ${w==="expense"?"bg-red-600 text-white shadow-red-200":"bg-white text-gray-500 hover:bg-gray-50"}`,children:"Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ"})]}),w==="income"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsxs(L,{onClick:()=>k(!0),className:"bg-blue-600 text-white hover:bg-blue-700 shadow-blue-500/20 shadow-lg flex items-center gap-2",children:[e.jsx(jt,{size:18})," Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©"]})}),e.jsx(J,{title:"Ø³Ù†Ø¯ Ù‚Ø¨Ø¶ Ø¬Ø¯ÙŠØ¯",className:"border-green-100 shadow-green-50",children:e.jsxs("form",{onSubmit:H,className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[e.jsxs("div",{className:"relative col-span-1 md:col-span-1",children:[e.jsx("label",{className:"text-xs block mb-1 font-bold text-gray-700",children:"Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨"}),e.jsx(Ge,{students:a,onSelect:y=>S({...d,sid:y.name,studentObjId:y.id}),placeholder:"Ø§Ø¨Ø­Ø«..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs block mb-1 font-bold text-gray-700",children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),e.jsx("input",{type:"number",className:"w-full border-2 border-gray-100 p-2 rounded-xl focus:border-green-500 outline-none",value:d.amount,onChange:y=>S({...d,amount:y.target.value}),required:!0,placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs block mb-1 font-bold text-gray-700",children:"Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹"}),e.jsxs("select",{className:"w-full border-2 border-gray-100 p-2 rounded-xl focus:border-green-500 outline-none bg-white h-[45px]",value:d.method,onChange:y=>S({...d,method:y.target.value}),children:[e.jsx("option",{value:"cash",children:"ÙƒØ§Ø´ (Cash)"}),e.jsx("option",{value:"cliq",children:"ÙƒÙ„ÙŠÙƒ (CliQ)"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("label",{className:"text-xs block mb-1 font-bold text-gray-700 flex justify-between",children:["Ø§Ù„Ø³Ø¨Ø¨",e.jsxs("button",{type:"button",onClick:()=>I(!0),className:"text-green-600 hover:text-green-800 text-[10px] flex items-center gap-1 bg-green-50 px-2 py-0.5 rounded cursor-pointer",children:[e.jsx(_e,{size:10})," ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©"]})]}),e.jsxs("select",{className:"w-full border-2 border-gray-100 p-2 rounded-xl focus:border-green-500 outline-none bg-white cursor-pointer h-[45px]",value:d.reason,onChange:y=>S({...d,reason:y.target.value}),children:[e.jsx("option",{value:"",disabled:!0,children:"Ø§Ø®ØªØ± Ø§Ù„Ø³Ø¨Ø¨..."}),m.map((y,q)=>e.jsx("option",{value:y.title,children:y.title},q)),e.jsx("option",{value:"Ø£Ø®Ø±Ù‰",children:"Ø£Ø®Ø±Ù‰ (ÙƒØªØ§Ø¨Ø© ÙŠØ¯ÙˆÙŠØ©)"})]})]}),d.reason==="Ø£Ø®Ø±Ù‰"&&e.jsxs("div",{className:"col-span-1 md:col-span-4",children:[e.jsx("label",{className:"text-xs block mb-1 font-bold text-gray-700",children:"ÙˆØ¶Ø­ Ø§Ù„Ø³Ø¨Ø¨"}),e.jsx("input",{className:"w-full border-2 border-gray-100 p-2 rounded-xl outline-none",value:d.customReason,onChange:y=>S({...d,customReason:y.target.value}),required:!0})]}),e.jsxs("div",{className:"col-span-1 md:col-span-4",children:[e.jsx("label",{className:"text-xs block mb-1 font-bold text-gray-700",children:"ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),e.jsx("input",{className:"w-full border-2 border-gray-100 p-2 rounded-xl outline-none",value:d.details,onChange:y=>S({...d,details:y.target.value}),placeholder:"Ù…Ø«Ø§Ù„: Ø¹Ù† Ø´Ù‡Ø± 12 + 1"})]}),e.jsx("div",{className:"col-span-1 md:col-span-4 mt-2",children:e.jsx(L,{type:"submit",className:"w-full bg-green-600 hover:bg-green-700 text-white shadow-lg shadow-green-600/20 py-3",children:"Ø­ÙØ¸ ÙˆÙ‚Ø¨Ø¶"})})]})}),e.jsx("div",{className:"flex items-center gap-2 mb-2 w-full md:w-64",children:e.jsx(Ge,{students:a,onSelect:y=>f(y.id),onClear:()=>f(null),placeholder:"ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ø·Ø§Ù„Ø¨...",showAllOption:!0})}),e.jsx("div",{className:"hidden md:block",children:e.jsx(J,{children:e.jsxs("table",{className:"w-full text-sm text-right",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 rounded-r-lg",children:"#"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„Ø·Ø§Ù„Ø¨"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„Ø¨ÙŠØ§Ù†"}),e.jsx("th",{className:"p-3",children:"Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„ØªØ§Ø±ÙŠØ®"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),e.jsx("th",{className:"p-3",children:"Ø·Ø¨Ø§Ø¹Ø©"}),e.jsx("th",{className:"p-3 rounded-l-lg",children:"Ø­Ø°Ù"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100",children:[M.map(y=>e.jsxs("tr",{className:"hover:bg-green-50 transition-colors",children:[e.jsx("td",{className:"p-3 text-gray-400 font-mono text-xs",children:y.id.slice(-6)}),e.jsx("td",{className:"p-3 font-bold text-gray-800",children:y.name}),e.jsxs("td",{className:"p-3 text-gray-600",children:[e.jsx("span",{className:"block font-bold text-xs",children:y.reason}),e.jsx("span",{className:"text-[10px] text-gray-400",children:y.details})]}),e.jsx("td",{className:"p-3",children:e.jsx("span",{className:`text-[10px] font-bold px-2 py-1 rounded-full ${y.method==="cliq"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:y.method==="cliq"?"ÙƒÙ„ÙŠÙƒ":"ÙƒØ§Ø´"})}),e.jsx("td",{className:"p-3 text-xs text-gray-500",children:y.date}),e.jsxs("td",{className:"p-3 font-bold text-green-600",children:["+",y.amount]}),e.jsx("td",{className:"p-3",children:e.jsx("button",{onClick:()=>W(y),className:"p-2 bg-gray-100 rounded-lg hover:bg-gray-200 text-gray-600",children:e.jsx(ue,{size:16})})}),e.jsx("td",{className:"p-3",children:e.jsx("button",{onClick:()=>R(y.id),className:"p-2 bg-red-50 rounded-lg hover:bg-red-100 text-red-500",children:e.jsx(de,{size:16})})})]},y.id)),M.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"p-8 text-center text-gray-400",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ù†Ø¯Ø§Øª"})})]})]})})}),e.jsxs("div",{className:"md:hidden grid gap-4",children:[M.map(y=>e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex flex-col gap-3 relative overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 left-0 w-1 h-full ${y.method==="cliq"?"bg-blue-500":"bg-green-500"}`}),e.jsxs("div",{className:"flex justify-between items-start pl-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(We,{size:14,className:"text-gray-400"}),e.jsx("span",{className:"font-bold text-gray-800",children:y.name})]}),e.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-2",children:[e.jsx(pe,{size:12})," ",y.date]})]}),e.jsxs("div",{className:"text-green-600 font-bold text-lg bg-green-50 px-2 py-1 rounded-lg",children:["+",y.amount]})]}),e.jsxs("div",{className:"bg-gray-50 p-2 rounded-lg text-sm text-gray-600",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{size:14,className:"text-gray-400"}),e.jsx("span",{className:"font-bold text-xs text-gray-700",children:y.reason})]}),e.jsx("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded ${y.method==="cliq"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:y.method==="cliq"?"ÙƒÙ„ÙŠÙƒ":"ÙƒØ§Ø´"})]}),e.jsx("span",{className:"text-[10px] pr-6 block",children:y.details})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-1 border-t pt-3 border-gray-100",children:[e.jsxs("button",{onClick:()=>W(y),className:"flex items-center gap-1 text-xs bg-blue-50 text-blue-600 px-3 py-2 rounded-lg font-bold",children:[e.jsx(ue,{size:14})," Ø·Ø¨Ø§Ø¹Ø©"]}),e.jsxs("button",{onClick:()=>R(y.id),className:"flex items-center gap-1 text-xs bg-red-50 text-red-600 px-3 py-2 rounded-lg font-bold",children:[e.jsx(de,{size:14})," Ø­Ø°Ù"]})]})]},y.id)),M.length===0&&e.jsx("div",{className:"text-center p-8 text-gray-400 bg-gray-50 rounded-xl border border-dashed",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ù†Ø¯Ø§Øª"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(J,{title:"ØªØ³Ø¬ÙŠÙ„ Ù…ØµØ±ÙˆÙ",className:"border-red-100 shadow-red-50",children:e.jsxs("form",{onSubmit:g,className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[e.jsxs("div",{className:"col-span-1 md:col-span-2",children:[e.jsx("label",{className:"text-xs block mb-1 font-bold text-gray-700",children:"Ø§Ù„Ø¨Ù†Ø¯ (Ø³Ø¨Ø¨ Ø§Ù„ØµØ±Ù)"}),e.jsx("input",{className:"w-full border-2 border-gray-100 p-2 rounded-xl focus:border-red-500 outline-none",value:u.title,onChange:y=>j({...u,title:y.target.value}),required:!0,placeholder:"Ù…Ø«Ø§Ù„: ÙØ§ØªÙˆØ±Ø© ÙƒÙ‡Ø±Ø¨Ø§Ø¡"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs block mb-1 font-bold text-gray-700",children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),e.jsx("input",{type:"number",className:"w-full border-2 border-gray-100 p-2 rounded-xl focus:border-red-500 outline-none",value:u.amount,onChange:y=>j({...u,amount:y.target.value}),required:!0,placeholder:"0.00"})]}),e.jsx("div",{children:e.jsx(L,{type:"submit",className:"w-full bg-red-600 hover:bg-red-700 text-white shadow-lg shadow-red-600/20 py-2.5",children:"Ø­ÙØ¸"})})]})}),e.jsx("div",{className:"hidden md:block",children:e.jsx(J,{children:e.jsxs("table",{className:"w-full text-sm text-right",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 rounded-r-lg",children:"Ø§Ù„Ø¨Ù†Ø¯"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„ØªØ§Ø±ÙŠØ®"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),e.jsx("th",{className:"p-3 rounded-l-lg",children:"Ø­Ø°Ù"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:T.map(y=>e.jsxs("tr",{className:"hover:bg-red-50 transition-colors",children:[e.jsx("td",{className:"p-3 font-bold text-gray-700",children:y.title}),e.jsx("td",{className:"p-3 text-gray-500 text-xs",children:y.date}),e.jsxs("td",{className:"p-3 text-red-600 font-bold",children:["-",y.amount]}),e.jsx("td",{className:"p-3",children:e.jsx("button",{onClick:()=>K(y.id),className:"text-red-500 p-2 bg-red-50 rounded-lg hover:bg-red-100",children:e.jsx(de,{size:16})})})]},y.id))})]})})}),e.jsxs("div",{className:"md:hidden grid gap-4",children:[T.map(y=>e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex justify-between items-center relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-red-500"}),e.jsxs("div",{className:"pl-3",children:[e.jsx("h4",{className:"font-bold text-gray-800",children:y.title}),e.jsx("span",{className:"text-xs text-gray-400 block mt-1",children:y.date})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsxs("span",{className:"font-bold text-red-600 text-lg",children:["-",y.amount]}),e.jsx("button",{onClick:()=>K(y.id),className:"text-red-400 hover:text-red-600 bg-red-50 p-1.5 rounded-lg",children:e.jsx(de,{size:16})})]})]},y.id)),T.length===0&&e.jsx("div",{className:"text-center p-8 text-gray-400 bg-gray-50 rounded-xl border border-dashed",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ØµØ§Ø±ÙŠÙ"})]})]})]})}const ps=({isOpen:a,onClose:r,groups:n,onAdd:x,onDelete:l})=>{const[i,s]=b.useState("");return a?He.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm",onClick:r}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-md p-6 animate-fade-in",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(_e,{size:20,className:"text-gray-600"})," Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙØªØ±Ø§Øª ÙˆØ§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª"]}),e.jsxs("div",{className:"flex gap-2 mb-6",children:[e.jsx("input",{className:"flex-1 border-2 border-gray-200 rounded-xl px-4 py-2 focus:border-blue-500 outline-none",placeholder:"Ø§Ø³Ù… Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©...",value:i,onChange:m=>s(m.target.value)}),e.jsx("button",{onClick:()=>{i&&(x(i),s(""))},className:"bg-blue-600 text-white p-3 rounded-xl hover:bg-blue-700",children:e.jsx(lt,{size:20})})]}),e.jsxs("div",{className:"space-y-2 max-h-60 overflow-y-auto mb-4",children:[n.map((m,v)=>e.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-3 rounded-xl border border-gray-100",children:[e.jsx("span",{className:"font-bold text-gray-700",children:m.name}),e.jsx("button",{onClick:()=>l(m),className:"text-red-500 hover:bg-red-50 p-2 rounded-lg transition-colors",children:e.jsx(de,{size:18})})]},v)),n.length===0&&e.jsx("p",{className:"text-center text-gray-400 text-sm",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙØªØ±Ø§Øª Ù…Ø¶Ø§ÙØ©"})]}),e.jsx(L,{onClick:r,variant:"outline",className:"w-full",children:"Ø¥ØºÙ„Ø§Ù‚"})]})]}),document.body):null};function us({students:a,studentsCollection:r,groups:n=[],groupsCollection:x,selectedBranch:l}){const[i,s]=b.useState(new Date),[m,v]=b.useState(new Date().getDate()),[w,c]=b.useState(""),[d,S]=b.useState(1),[u,j]=b.useState(10),[h,f]=b.useState(!1),[p,I]=b.useState(!1),[o,k]=b.useState("Ø§Ù„ÙƒÙ„"),A=b.useMemo(()=>n?n.map(D=>D.name):[],[n]),O=async D=>{var P;if(A.includes(D))return alert("Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø© Ù…ÙˆØ¬ÙˆØ¯Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹");await x.add({name:D,branch:l||((P=a[0])==null?void 0:P.branch)||"Ø¹Ø§Ù…"})},M=async D=>{confirm(`Ø­Ø°Ù Ø§Ù„ÙØªØ±Ø© "${D.name}"ØŸ`)&&(await x.remove(D.id),o===D.name&&k("Ø§Ù„ÙƒÙ„"))},T=i.getFullYear(),N=i.getMonth(),$=new Date(T,N+1,0).getDate(),H=["ÙŠÙ†Ø§ÙŠØ±","ÙØ¨Ø±Ø§ÙŠØ±","Ù…Ø§Ø±Ø³","Ø£Ø¨Ø±ÙŠÙ„","Ù…Ø§ÙŠÙˆ","ÙŠÙˆÙ†ÙŠÙˆ","ÙŠÙˆÙ„ÙŠÙˆ","Ø£ØºØ³Ø·Ø³","Ø³Ø¨ØªÙ…Ø¨Ø±","Ø£ÙƒØªÙˆØ¨Ø±","Ù†ÙˆÙÙ…Ø¨Ø±","Ø¯ÙŠØ³Ù…Ø¨Ø±"],g=["Ø£Ø­Ø¯","Ø¥Ø«Ù†ÙŠÙ†","Ø«Ù„Ø§Ø«Ø§Ø¡","Ø£Ø±Ø¨Ø¹Ø§Ø¡","Ø®Ù…ÙŠØ³","Ø¬Ù…Ø¹Ø©","Ø³Ø¨Øª"],R=Array.from({length:8},(D,P)=>2023+P),K=(D,P)=>{const U=new Date(i);D!==null&&U.setFullYear(D),P!==null&&U.setMonth(P),s(U),v(1)},_=D=>{const P=new Date(T,N+1,0).getDate();let U=m+D;U>P&&(U=P),U<1&&(U=1),v(U)},W=b.useMemo(()=>{let D=Array.isArray(a)?[...a]:[];return o!=="Ø§Ù„ÙƒÙ„"&&(D=D.filter(P=>P.group===o)),D.sort((P,U)=>(P.customOrder||999999)-(U.customOrder||999999)),w&&(D=D.filter(P=>P.name.toLowerCase().includes(w.toLowerCase()))),D},[a,w,o]),y=Math.ceil(W.length/u),q=h?W:W.slice((d-1)*u,d*u),X=async(D,P)=>{const U=`${T}-${String(N+1).padStart(2,"0")}-${String(P).padStart(2,"0")}`,t={...a.find(C=>C.id===D).attendance||{}};t[U]?delete t[U]:t[U]=!0,await r.update(D,{attendance:t})},re=async(D,P)=>{let U=P-1;if(U<0&&(U=0),U>=W.length&&(U=W.length-1),U===D)return;const E=[...W],[t]=E.splice(D,1);E.splice(U,0,t);const C=E.map((F,G)=>r.update(F.id,{customOrder:G+1}));await Promise.all(C)},ae=async(D,P)=>{confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù†Ù‚Ù„ Ø§Ù„Ø·Ø§Ù„Ø¨ Ù„Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©ØŸ")&&await r.update(D,{group:P})},me=()=>{const D=window.open("","PRINT","height=800,width=1200"),P=window.location.origin+oe.LOGO;let U="";for(let C=1;C<=$;C++)U+=`<th style="font-size:10px; width:20px; border:1px solid #ccc; background:#f9f9f9;">${C}</th>`;let E="";W.forEach((C,F)=>{var Y;let G="";for(let Q=1;Q<=$;Q++){const B=`${T}-${String(N+1).padStart(2,"0")}-${String(Q).padStart(2,"0")}`,ee=(Y=C.attendance)==null?void 0:Y[B],ne=new Date(T,N,Q).getDay()===5;let ie="",z="";ne?z="#eee":ee&&(ie="âœ“",z="#dcfce7"),G+=`<td style="border:1px solid #ccc; background:${z}; text-align:center; font-size:12px; color:#166534; font-weight:bold;">${ie}</td>`}E+=`
            <tr>
                <td style="border:1px solid #ccc; padding:5px; font-weight:bold; text-align:center;">${F+1}</td>
                <td style="border:1px solid #ccc; padding:5px; text-align:right;">${C.name}</td>
                <td style="border:1px solid #ccc; padding:5px; text-align:center; font-size:11px;">${C.group||"-"}</td>
                ${G}
            </tr>
        `});const t=`
      <!DOCTYPE html>
      <html lang="ar" dir="rtl">
        <head>
          <title>ÙƒØ´Ù Ø§Ù„Ø­Ø¶ÙˆØ± - ${H[N]} ${T}</title>
          <style>
            @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap');
            body { font-family: 'Cairo', sans-serif; padding: 20px; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; }
            h1 { text-align: center; color: #b45309; margin-bottom: 5px; }
            .header-info { text-align: center; margin-bottom: 20px; font-weight:bold; color:#555; }
            @page { size: A4 landscape; margin: 10mm; }
          </style>
        </head>
        <body>
            <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:2px solid #b45309; padding-bottom:10px;">
                <div>
                    <h1>Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø§Ù„Ø´Ø¬Ø§Ø¹ Ù„Ù„ØªØ§ÙŠÙƒÙˆØ§Ù†Ø¯Ùˆ</h1>
                    <div style="font-size:12px;">ÙØ±Ø¹: ${l}</div>
                </div>
                <img src="${P}" style="height:60px;" onerror="this.style.display='none'"/>
            </div>

            <div class="header-info">
                Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨ | Ø´Ù‡Ø±: ${H[N]} ${T} | Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©: ${o}
            </div>

            <table>
                <thead>
                    <tr>
                        <th style="border:1px solid #ccc; background:#eee; width:30px;">#</th>
                        <th style="border:1px solid #ccc; background:#eee; width:200px;">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                        <th style="border:1px solid #ccc; background:#eee; width:80px;">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©</th>
                        ${U}
                    </tr>
                </thead>
                <tbody>
                    ${E}
                </tbody>
            </table>
            
            <div style="margin-top:20px; font-size:10px; text-align:left; color:#777;">
                ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©: ${new Date().toLocaleDateString("ar-JO")}
            </div>
        </body>
      </html>
    `;D.document.write(t),D.document.close(),D.onload=()=>{D.focus(),setTimeout(()=>{D.print(),D.close()},500)}};return e.jsxs("div",{className:"space-y-6 animate-fade-in font-sans",children:[e.jsx(ps,{isOpen:p,onClose:()=>I(!1),groups:n||[],onAdd:O,onDelete:M}),e.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-100 flex flex-col xl:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 bg-gray-50 p-2 rounded-xl border border-gray-200 justify-center w-full md:w-auto",children:[e.jsx(pe,{size:18,className:"text-gray-500 ml-1"}),e.jsx("select",{className:"bg-transparent font-bold text-gray-700 outline-none cursor-pointer",value:N,onChange:D=>K(null,parseInt(D.target.value)),children:H.map((D,P)=>e.jsx("option",{value:P,children:D},P))}),e.jsx("select",{className:"bg-transparent font-bold text-gray-700 outline-none cursor-pointer",value:T,onChange:D=>K(parseInt(D.target.value),null),children:R.map(D=>e.jsx("option",{value:D,children:D},D))})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-blue-50 p-2 pl-3 rounded-xl border border-blue-100 w-full md:w-auto",children:[e.jsx(ye,{size:18,className:"text-blue-500 ml-1"}),e.jsx("span",{className:"text-xs font-bold text-blue-800 ml-1 hidden sm:inline",children:"Ø§Ù„ÙØªØ±Ø©:"}),e.jsx("div",{className:"relative group",children:e.jsxs("select",{className:"bg-transparent text-blue-900 font-bold outline-none w-full md:w-40 cursor-pointer appearance-none pr-4",value:o,onChange:D=>{k(D.target.value),S(1)},children:[e.jsx("option",{value:"Ø§Ù„ÙƒÙ„",children:"Ø§Ù„ÙƒÙ„ (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø§Ø¨)"}),A.map((D,P)=>e.jsx("option",{value:D,children:D},P))]})}),e.jsx("button",{onClick:()=>I(!0),className:"bg-white p-1.5 rounded-lg text-blue-500 hover:text-blue-700 hover:shadow-sm border border-transparent hover:border-blue-200 transition-all",title:"Ø¥Ø¶Ø§ÙØ©/Ø­Ø°Ù ÙØªØ±Ø§Øª",children:e.jsx(_e,{size:16})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-3 w-full xl:w-auto",children:[e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx(Fe,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Ø¨Ø­Ø«...",className:"w-full pl-4 pr-10 py-2.5 border-2 border-gray-100 rounded-xl focus:border-yellow-500 outline-none",value:w,onChange:D=>{c(D.target.value),S(1)}})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(L,{variant:h?"default":"outline",onClick:()=>f(!h),className:`gap-2 whitespace-nowrap ${h?"bg-yellow-500 text-black border-none":""}`,children:[h?e.jsx(Jt,{size:18}):e.jsx(Wt,{size:18}),h?"Ø­ÙØ¸ Ø§Ù„ØªØ±ØªÙŠØ¨":"ØªØ±ØªÙŠØ¨"]}),e.jsxs(L,{onClick:me,className:"bg-gray-800 text-white gap-2 hover:bg-black",title:"Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙƒØ´Ù",children:[e.jsx(ue,{size:18})," ",e.jsx("span",{className:"hidden md:inline",children:"Ø·Ø¨Ø§Ø¹Ø©"})]})]})]})]}),e.jsxs("div",{className:"md:hidden space-y-4",children:[e.jsxs("div",{className:"bg-yellow-500 text-black p-4 rounded-xl shadow-lg flex justify-between items-center",children:[e.jsx("button",{onClick:()=>_(-1),className:"p-2 bg-white/20 rounded-lg",children:e.jsx(Pe,{})}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs opacity-75 font-bold mb-1",children:"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ±"}),e.jsx("div",{className:"text-xl font-bold flex flex-col",children:e.jsxs("span",{children:[m," ",H[N]]})})]}),e.jsx("button",{onClick:()=>_(1),className:"p-2 bg-white/20 rounded-lg",children:e.jsx(Je,{})})]}),e.jsx("div",{className:"grid gap-3",children:q.map((D,P)=>{var C;const U=`${T}-${String(N+1).padStart(2,"0")}-${String(m).padStart(2,"0")}`,E=!!((C=D.attendance)!=null&&C[U]),t=new Date(T,N,m).getDay()===5;return e.jsx("div",{className:"p-4 rounded-xl border border-gray-100 bg-white shadow-sm",children:e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center font-bold text-gray-500 text-sm",children:(d-1)*u+P+1}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-800",children:D.name}),e.jsx("div",{className:"relative mt-1",children:e.jsx("select",{className:"text-[10px] bg-blue-50 text-blue-700 px-2 py-0.5 rounded-md outline-none border-none font-bold w-full appearance-none",value:D.group||(A.length>0?A[0]:""),onChange:F=>ae(D.id,F.target.value),children:A.map((F,G)=>e.jsx("option",{value:F,children:F},G))})})]})]}),!h&&(t?e.jsx("span",{className:"text-xs font-bold text-red-500 bg-red-50 px-2 py-1 rounded",children:"Ø¹Ø·Ù„Ø©"}):e.jsx("button",{onClick:()=>X(D.id,m),className:`w-10 h-10 rounded-full flex items-center justify-center ${E?"bg-green-500 text-white":"bg-gray-100 text-gray-300"}`,children:E?e.jsx(ct,{size:20}):e.jsx("span",{className:"w-3 h-3 bg-gray-300 rounded-full"})}))]})},D.id)})})]}),e.jsx(J,{className:"hidden md:block overflow-visible p-0 border-none shadow-md rounded-2xl",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-xs border-collapse",children:[e.jsx("thead",{className:"bg-gray-800 text-white sticky top-0 z-20",children:e.jsxs("tr",{children:[e.jsxs("th",{className:"p-4 sticky right-0 bg-gray-800 z-30 text-right min-w-[280px] font-bold text-base shadow-lg",children:["Ø§Ù„Ø·Ù„Ø§Ø¨ ",o!=="Ø§Ù„ÙƒÙ„"&&e.jsxs("span",{className:"text-yellow-400 text-sm",children:["(",o,")"]})]}),!h&&[...Array($)].map((D,P)=>{const U=P+1,E=new Date(T,N,U).getDay()===5;return e.jsx("th",{className:`p-2 border-l border-gray-700 text-center min-w-[40px] ${E?"bg-red-900/40 text-red-100":""}`,children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"opacity-60 text-[10px]",children:g[new Date(T,N,U).getDay()]}),e.jsx("span",{children:U})]})},P)}),h&&e.jsx("th",{className:"p-4 text-center w-64 bg-yellow-600/90 text-white",children:"Ø§Ù„ØªØ±ØªÙŠØ¨"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 bg-white",children:q.map((D,P)=>{const U=(d-1)*u+P+1;return e.jsxs("tr",{className:"hover:bg-yellow-50 transition-colors group",children:[e.jsx("td",{className:"p-3 sticky right-0 bg-white group-hover:bg-yellow-50 font-bold border-l border-gray-100 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)] z-10 text-gray-800 text-sm flex items-center justify-between h-[50px]",children:e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsx("span",{className:`text-xs w-6 h-6 flex items-center justify-center rounded-full font-mono ${h?"bg-yellow-100 text-yellow-800 font-bold":"bg-gray-100 text-gray-500"}`,children:U}),e.jsxs("div",{className:"flex flex-col flex-1",children:[e.jsx("span",{className:"truncate",children:D.name}),e.jsxs("div",{className:"flex items-center gap-1 mt-0.5 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx(Ee,{size:10,className:"text-gray-400"}),e.jsxs("select",{className:"bg-transparent text-[10px] text-gray-500 outline-none cursor-pointer hover:text-blue-600 w-full",value:D.group||(A.length>0?A[0]:""),onChange:E=>ae(D.id,E.target.value),onClick:E=>E.stopPropagation(),children:[e.jsx("option",{value:"",disabled:!0,children:"Ù†Ù‚Ù„ Ø¥Ù„Ù‰..."}),A.map((E,t)=>e.jsx("option",{value:E,children:E},t))]})]})]})]})}),!h&&[...Array($)].map((E,t)=>{var Q;const C=t+1,F=`${T}-${String(N+1).padStart(2,"0")}-${String(C).padStart(2,"0")}`,G=!!((Q=D.attendance)!=null&&Q[F]),Y=new Date(T,N,C).getDay()===5;return e.jsx("td",{className:`border-l border-gray-100 text-center p-0 ${Y?"bg-gray-50":""}`,children:Y?e.jsx("div",{className:"w-full h-full flex items-center justify-center opacity-20 pointer-events-none",children:e.jsx(xe,{size:12})}):e.jsxs("label",{className:"cursor-pointer w-full h-full flex items-center justify-center hover:bg-gray-100",children:[e.jsx("input",{type:"checkbox",checked:G,onChange:()=>X(D.id,C),className:"hidden"}),e.jsx("div",{className:`w-6 h-6 rounded flex items-center justify-center transition-all ${G?"bg-green-500 text-white scale-110":"bg-gray-100 hover:bg-gray-300"}`,children:e.jsx(ct,{size:14})})]})},t)}),h&&e.jsx("td",{className:"p-2 text-center bg-yellow-50/20 border-l border-yellow-100",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{className:"text-gray-400 text-xs",children:"Ø±Ù‚Ù…:"}),e.jsx("input",{type:"number",className:"w-20 p-2 text-center border-2 border-yellow-300 rounded-lg focus:border-yellow-600 outline-none font-bold text-lg",placeholder:U,onKeyDown:E=>{E.key==="Enter"&&(re(P,parseInt(E.target.value)),E.target.value="",E.target.blur())},onBlur:E=>{E.target.value&&(re(P,parseInt(E.target.value)),E.target.value="")}})]})})]},D.id)})})]})})}),!h&&y>1&&e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 bg-white p-4 rounded-xl shadow-sm border border-gray-100 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsx("span",{children:"Ø¹Ø±Ø¶"}),e.jsxs("select",{className:"bg-gray-50 border border-gray-200 rounded-lg p-1.5 focus:outline-none font-bold cursor-pointer",value:u,onChange:D=>{j(Number(D.target.value)),S(1)},children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:W.length,children:"Ø§Ù„ÙƒÙ„"})]}),e.jsxs("span",{children:["Ù…Ù† Ø£ØµÙ„ ",W.length," Ø·Ø§Ù„Ø¨"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(L,{variant:"outline",disabled:d===1,onClick:()=>S(D=>D-1),className:"px-4 text-sm",children:"Ø§Ù„Ø³Ø§Ø¨Ù‚"}),e.jsx("div",{className:"flex gap-1 overflow-x-auto hide-scrollbar max-w-[150px] md:max-w-none px-1",children:[...Array(y)].map((D,P)=>e.jsx("button",{onClick:()=>S(P+1),className:`w-9 h-9 flex items-center justify-center rounded-lg text-sm font-bold transition-all ${d===P+1?"bg-yellow-500 text-black shadow-md scale-105":"bg-gray-50 text-gray-600 hover:bg-gray-200"}`,children:P+1},P))}),e.jsx(L,{variant:"outline",disabled:d===y,onClick:()=>S(D=>D+1),className:"px-4 text-sm",children:"Ø§Ù„ØªØ§Ù„ÙŠ"})]})]})]})}const fs=()=>{const r=`student${Math.floor(1e3+Math.random()*9e3)}`;let n="";const x="ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz23456789";for(let l=0;l<8;l++)n+=x.charAt(Math.floor(Math.random()*x.length));return{username:r,password:n}};function js({registrations:a,students:r,registrationsCollection:n,studentsCollection:x,selectedBranch:l,logActivity:i}){const[s,m]=b.useState(null),[v,w]=b.useState({}),c=[...new Map(r.map(u=>[u.familyId,u.familyName])).entries()],d=u=>{const j=new Date().toISOString().split("T")[0],h=new Date;h.setMonth(h.getMonth()+1),w({name:u.name,phone:u.phone,dob:u.dob,address:u.address,belt:"Ø£Ø¨ÙŠØ¶",joinDate:j,subEnd:h.toISOString().split("T")[0],balance:0,linkFamily:"new"}),m(u)},S=async u=>{var o;u.preventDefault();const{username:j,password:h}=fs();let f,p;v.linkFamily==="new"?(f=Math.floor(Date.now()/1e3),p=`Ø¹Ø§Ø¦Ù„Ø© ${v.name.split(" ").slice(-1)[0]}`):(f=parseInt(v.linkFamily),p=((o=r.find(k=>k.familyId===f))==null?void 0:o.familyName)||"Ø¹Ø§Ø¦Ù„Ø©");const I={branch:l,status:"active",notes:[],internalNotes:[],attendance:{},username:j,password:h,familyId:f,familyName:p,customOrder:Date.now(),...v};delete I.linkFamily,await x.add(I),await n.remove(s.id),i("ØªØ³Ø¬ÙŠÙ„ Ø·Ø§Ù„Ø¨",`ØªÙ… Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨ ${v.name}`),alert(`ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­!
User: ${j}
Pass: ${h}`),m(null)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid gap-4",children:a.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border-2 border-dashed border-gray-200",children:[e.jsx(yt,{size:48,className:"mx-auto text-gray-300 mb-2"}),e.jsx("p",{className:"text-gray-500",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© Ø­Ø§Ù„ÙŠØ§Ù‹."})]}):a.map(u=>e.jsx(J,{className:"border-r-4 border-blue-500",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-bold text-lg flex items-center gap-2",children:[u.name," ",e.jsx("span",{className:"text-xs bg-blue-100 text-blue-600 px-2 py-0.5 rounded",children:"Ø¬Ø¯ÙŠØ¯"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-sm text-gray-600 mt-1",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ie,{size:14})," ",u.phone]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx($e,{size:14})," ",u.address]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(pe,{size:14})," ",u.dob]})]})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[e.jsx(L,{onClick:()=>d(u),className:"bg-green-600 hover:bg-green-700 text-white text-sm flex-1 md:flex-none",children:"Ø§Ø¹ØªÙ…Ø§Ø¯ ÙƒØ·Ø§Ù„Ø¨"}),e.jsx("button",{onClick:()=>{confirm("Ø­Ø°Ù Ø§Ù„Ø·Ù„Ø¨ØŸ")&&n.remove(u.id)},className:"text-red-500 p-2 hover:bg-red-50 rounded border border-red-200",children:e.jsx(de,{size:18})})]})]})},u.id))}),s&&e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60] p-4 backdrop-blur-sm",children:e.jsx(J,{className:"w-full max-w-2xl animate-fade-in",title:"Ø¥ÙƒÙ…Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯",children:e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs mb-1 font-bold",children:"Ø§Ù„Ø§Ø³Ù…"}),e.jsx("input",{className:"w-full border p-2 bg-gray-100 rounded text-gray-500",value:v.name,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs mb-1 font-bold",children:"Ø§Ù„Ù‡Ø§ØªÙ"}),e.jsx("input",{className:"w-full border p-2 bg-gray-100 rounded text-gray-500",value:v.phone,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs mb-1 font-bold",children:"Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©"}),e.jsxs("select",{className:"w-full border p-2 rounded",value:v.linkFamily,onChange:u=>w({...v,linkFamily:u.target.value}),children:[e.jsx("option",{value:"new",children:"Ø¹Ø§Ø¦Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©"}),c.map(([u,j])=>e.jsx("option",{value:u,children:j},u))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs mb-1 font-bold",children:"Ø§Ù„Ø­Ø²Ø§Ù…"}),e.jsx("select",{className:"w-full border p-2 rounded",value:v.belt,onChange:u=>w({...v,belt:u.target.value}),children:V.map(u=>e.jsx("option",{children:u},u))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs mb-1 font-bold",children:"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù„ØªØ­Ø§Ù‚"}),e.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:v.joinDate,onChange:u=>w({...v,joinDate:u.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs mb-1 font-bold text-green-600",children:"Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ"}),e.jsx("input",{type:"date",className:"w-full border p-2 rounded bg-green-50",value:v.subEnd,onChange:u=>w({...v,subEnd:u.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs mb-1 text-red-600 font-bold",children:"Ø±ØµÙŠØ¯ Ù…Ø³ØªØ­Ù‚ (JOD)"}),e.jsx("input",{type:"number",className:"w-full border p-2 rounded focus:ring-2 ring-red-500 outline-none",value:v.balance,onChange:u=>w({...v,balance:u.target.value})})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4 pt-4 border-t",children:[e.jsx(L,{variant:"ghost",onClick:()=>m(null),children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(L,{type:"submit",children:"ØªØ£ÙƒÙŠØ¯ ÙˆØ¥Ø¶Ø§ÙØ©"})]})]})})})]})}function ys({schedule:a,scheduleCollection:r}){const[n,x]=b.useState({level:"",days:"",time:"",branch:""}),l=async s=>{s.preventDefault(),await r.add({...n}),x({level:"",days:"",time:"",branch:""})},i=async s=>{confirm("Ø­Ø°ÙØŸ")&&await r.remove(s)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(J,{title:"Ø¥Ø¶Ø§ÙØ© Ø­ØµØ©",children:e.jsxs("form",{onSubmit:l,className:"grid grid-cols-2 gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs block mb-1",children:"Ø§Ù„Ù…Ø³ØªÙˆÙ‰"}),e.jsx("input",{className:"w-full border p-2 rounded",value:n.level,onChange:s=>x({...n,level:s.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs block mb-1",children:"Ø§Ù„Ø£ÙŠØ§Ù…"}),e.jsx("input",{className:"w-full border p-2 rounded",value:n.days,onChange:s=>x({...n,days:s.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs block mb-1",children:"Ø§Ù„ÙˆÙ‚Øª"}),e.jsx("input",{className:"w-full border p-2 rounded",value:n.time,onChange:s=>x({...n,time:s.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs block mb-1",children:"Ø§Ù„ÙØ±Ø¹"}),e.jsx("input",{className:"w-full border p-2 rounded",value:n.branch,onChange:s=>x({...n,branch:s.target.value}),required:!0})]}),e.jsx(L,{type:"submit",children:"Ø¥Ø¶Ø§ÙØ©"})]})}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:a.map(s=>e.jsxs("div",{className:"bg-white p-4 rounded border flex justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold",children:s.level}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.days," | ",s.time]})]}),e.jsx("button",{onClick:()=>i(s.id),className:"text-red-500",children:e.jsx(de,{size:16})})]},s.id))})]})}function Ns({captains:a,captainsCollection:r}){const[n,x]=b.useState({name:"",branch:se.SHAFA,username:"",password:"",salary:"",holidays:[],withdrawals:[]}),[l,i]=b.useState(null),s=async m=>{m.preventDefault(),l?(await r.update(l,n),i(null)):await r.add({...n,role:"captain"}),x({name:"",branch:se.SHAFA,username:"",password:"",salary:"",holidays:[],withdrawals:[]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(J,{title:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙƒØ¨Ø§ØªÙ†",children:e.jsxs("form",{onSubmit:s,className:"grid gap-4 md:grid-cols-2",children:[e.jsx("input",{className:"border p-2 rounded",placeholder:"Ø§Ù„Ø§Ø³Ù…",value:n.name,onChange:m=>x({...n,name:m.target.value}),required:!0}),e.jsxs("select",{className:"border p-2 rounded",value:n.branch,onChange:m=>x({...n,branch:m.target.value}),children:[e.jsx("option",{value:se.SHAFA,children:"Ø´ÙØ§ Ø¨Ø¯Ø±Ø§Ù†"}),e.jsx("option",{value:se.ABU_NSEIR,children:"Ø£Ø¨Ùˆ Ù†ØµÙŠØ±"})]}),e.jsx("input",{className:"border p-2 rounded",placeholder:"User",value:n.username,onChange:m=>x({...n,username:m.target.value}),required:!0}),e.jsx("input",{className:"border p-2 rounded",placeholder:"Pass",value:n.password,onChange:m=>x({...n,password:m.target.value}),required:!0}),e.jsx("input",{className:"border p-2 rounded",type:"number",placeholder:"Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ",value:n.salary,onChange:m=>x({...n,salary:m.target.value})}),e.jsx(L,{type:"submit",children:l?"Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„":"Ø¥Ø¶Ø§ÙØ© ÙƒØ§Ø¨ØªÙ†"})]})}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:a.map(m=>e.jsx(J,{className:"border-l-4 border-purple-500",children:e.jsxs("div",{className:"flex justify-between flex-wrap gap-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold",children:m.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Ø§Ù„Ø±Ø§ØªØ¨: ",m.salary," | User: ",m.username," | Pass: ",m.password]})]}),e.jsxs("div",{className:"flex gap-2 items-start",children:[e.jsx("button",{onClick:()=>{i(m.id),x(m)},className:"text-blue-500",children:e.jsx(tt,{size:16})}),e.jsx("button",{onClick:()=>r.remove(m.id),className:"text-red-500",children:e.jsx(de,{size:16})})]})]})},m.id))})]})}const vs=({news:a,newsCollection:r,selectedBranch:n})=>{const[x,l]=b.useState(!1),[i,s]=b.useState({title:"",desc:"",image:"",branch:n}),[m,v]=b.useState(null),[w,c]=b.useState(!1),d=j=>{const h=j.target.files[0];if(h){v(h);const f=new FileReader;f.onloadend=()=>{s({...i,image:f.result})},f.readAsDataURL(h)}},S=async j=>{j.preventDefault(),c(!0);try{let h="";if(m){const f=Et(es,`news/${Date.now()}_${m.name}`),p=await Mt(f,m);h=await Tt(p.ref)}await Le(he(te,"artifacts",ce,"public","data","news"),{title:i.title,desc:i.desc,branch:i.branch,image:h,createdAt:new Date().toISOString()}),alert("ØªÙ… Ù†Ø´Ø± Ø§Ù„Ø®Ø¨Ø± Ø¨Ù†Ø¬Ø§Ø­!"),l(!1),s({title:"",desc:"",image:"",branch:n}),v(null)}catch(h){console.error("Error adding news:",h),alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù†Ø´Ø±ØŒ ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙˆØ§Ù„Ø§ØªØµØ§Ù„.")}c(!1)},u=async j=>{confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø®Ø¨Ø±ØŸ")&&await st(je(te,"artifacts",ce,"public","data","news",j))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center bg-white p-4 rounded-xl shadow-sm",children:[e.jsx("h2",{className:"font-bold text-lg",children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø®Ø¨Ø§Ø± ÙˆØ§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª"}),e.jsxs(L,{onClick:()=>l(!0),children:[e.jsx(lt,{size:18})," Ø®Ø¨Ø± Ø¬Ø¯ÙŠØ¯"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.map(j=>e.jsxs(J,{className:"relative overflow-hidden group",children:[e.jsxs("div",{className:"aspect-video w-full bg-gray-100 relative",children:[j.image?e.jsx("img",{src:j.image,alt:j.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-300",children:e.jsx(Yt,{size:48})}),e.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsxs(L,{variant:"danger",onClick:()=>u(j.id),children:[e.jsx(de,{size:18})," Ø­Ø°Ù"]})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-bold text-lg",children:j.title}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:j.desc}),e.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded mt-2 inline-block",children:j.branch})]})]},j.id))}),x&&e.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",children:e.jsx(J,{className:"w-full max-w-lg",title:"Ø¥Ø¶Ø§ÙØ© Ø®Ø¨Ø± Ø¬Ø¯ÙŠØ¯",children:e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold block mb-1",children:"Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø®Ø¨Ø±"}),e.jsx("input",{required:!0,className:"w-full border p-2 rounded",value:i.title,onChange:j=>s({...i,title:j.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold block mb-1",children:"Ø§Ù„ØªÙØ§ØµÙŠÙ„"}),e.jsx("textarea",{required:!0,className:"w-full border p-2 rounded h-24",value:i.desc,onChange:j=>s({...i,desc:j.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold block mb-1",children:"ØµÙˆØ±Ø© Ø§Ù„Ø®Ø¨Ø±"}),e.jsx("input",{type:"file",accept:"image/*",onChange:d,className:"w-full border p-2 rounded bg-gray-50"}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"ÙŠÙØ¶Ù„ ØµÙˆØ± Ø¨Ø§Ù„Ø¹Ø±Ø¶ (Landscape)"})]}),i.image&&e.jsx("img",{src:i.image,alt:"preview",className:"w-full h-32 object-cover rounded border"}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(L,{variant:"ghost",onClick:()=>l(!1),children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx(L,{type:"submit",disabled:w,children:w?"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±ÙØ¹...":"Ù†Ø´Ø±"})]})]})})})]})},mt=a=>a?a.includes("Ø£Ø¨ÙŠØ¶")?"bg-white text-gray-800 border-gray-200 border":a.includes("Ø£ØµÙØ±")?"bg-yellow-300 text-yellow-900 border-yellow-400":a.includes("Ø£Ø®Ø¶Ø±")?"bg-green-600 text-white border-green-700":a.includes("Ø£Ø²Ø±Ù‚")?"bg-blue-600 text-white border-blue-700":a.includes("Ø¨Ù†ÙŠ")?"bg-[#8B4513] text-white border-[#5D2906]":a.includes("Ø£Ø­Ù…Ø±")?"bg-red-600 text-white border-red-700":a.includes("Ø£Ø³ÙˆØ¯")?"bg-black text-white border-gray-800":"bg-gray-100 text-gray-800":"bg-gray-100 text-gray-800 border-gray-200";function ws({students:a,studentsCollection:r,logActivity:n}){const[x,l]=b.useState(""),[i,s]=b.useState("dateAsc"),m=async d=>{const S=V.indexOf(d.belt);if(S===-1||S>=V.length-1)return alert("Ù‡Ø°Ø§ Ø§Ù„Ø·Ø§Ù„Ø¨ ÙÙŠ Ø£Ø¹Ù„Ù‰ Ø­Ø²Ø§Ù… Ù…Ø³Ø¬Ù„ Ø£Ùˆ Ø§Ù„Ø­Ø²Ø§Ù… ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ");const u=V[S+1];confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ØªØ±ÙÙŠØ¹ ${d.name} Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø²Ø§Ù… (${u})ØŸ`)&&(await r.update(d.id,{belt:u}),n&&n("ØªØ±ÙÙŠØ¹ Ø­Ø²Ø§Ù…",`ØªÙ… ØªØ±ÙÙŠØ¹ ${d.name} Ø¥Ù„Ù‰ ${u}`))},v=async(d,S)=>{d.belt!==S&&confirm(`ØªØºÙŠÙŠØ± Ø­Ø²Ø§Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ ${d.name} ÙŠØ¯ÙˆÙŠØ§Ù‹ Ø¥Ù„Ù‰ ${S}ØŸ`)&&(await r.update(d.id,{belt:S}),n&&n("ØªØ¹Ø¯ÙŠÙ„ Ø­Ø²Ø§Ù… ÙŠØ¯ÙˆÙŠ",`ØªØºÙŠÙŠØ± Ø­Ø²Ø§Ù… ${d.name} Ù…Ù† ${d.belt} Ø¥Ù„Ù‰ ${S}`))},w=async(d,S)=>{await r.update(d,{nextTestDate:S})},c=b.useMemo(()=>{let d=[...a];return x&&(d=d.filter(S=>S.name.toLowerCase().includes(x.toLowerCase()))),d.sort((S,u)=>{if(i==="dateAsc"||i==="dateDesc"){const j=S.nextTestDate?new Date(S.nextTestDate):new Date("2099-12-31"),h=u.nextTestDate?new Date(u.nextTestDate):new Date("2099-12-31");return i==="dateAsc"?j-h:h-j}return i==="beltAsc"?V.indexOf(S.belt)-V.indexOf(u.belt):i==="beltDesc"?V.indexOf(u.belt)-V.indexOf(S.belt):0}),d},[a,x,i]);return e.jsxs("div",{className:"space-y-6 animate-fade-in pb-20 md:pb-0",children:[e.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-100 flex flex-col md:flex-row gap-4 justify-between items-center sticky top-0 z-20",children:[e.jsxs("div",{className:"relative w-full md:w-1/3",children:[e.jsx(Fe,{size:18,className:"absolute top-1/2 -translate-y-1/2 right-3 text-gray-400 pointer-events-none"}),e.jsx("input",{className:"w-full pl-4 pr-10 py-2.5 border-2 border-gray-100 rounded-xl focus:border-yellow-500 outline-none transition-all",placeholder:"Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨...",value:x,onChange:d=>l(d.target.value)})]}),e.jsx("div",{className:"flex items-center gap-2 w-full md:w-auto",children:e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsxs("select",{className:"w-full appearance-none bg-gray-50 border border-gray-200 text-gray-700 py-2.5 pr-10 pl-4 rounded-xl focus:outline-none focus:border-yellow-500 cursor-pointer text-sm font-bold",value:i,onChange:d=>s(d.target.value),children:[e.jsx("option",{value:"dateAsc",children:"ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„ÙØ­Øµ (Ø§Ù„Ø£Ù‚Ø±Ø¨ Ø£ÙˆÙ„Ø§Ù‹)"}),e.jsx("option",{value:"dateDesc",children:"ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„ÙØ­Øµ (Ø§Ù„Ø£Ø¨Ø¹Ø¯ Ø£ÙˆÙ„Ø§Ù‹)"}),e.jsx("option",{value:"beltDesc",children:"ğŸ¥‹ ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ø­Ø²Ù…Ø© (Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰)"}),e.jsx("option",{value:"beltAsc",children:"ğŸ¥‹ ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ø­Ø²Ù…Ø© (Ù…Ù† Ø§Ù„Ù…Ø¨ØªØ¯Ø¦)"})]}),e.jsx(ft,{size:16,className:"absolute top-1/2 -translate-y-1/2 right-3 text-gray-500 pointer-events-none"})]})})]}),e.jsx("div",{className:"hidden md:block",children:e.jsx(J,{className:"p-0 overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm text-right",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Ø§Ù„Ø·Ø§Ù„Ø¨"}),e.jsx("th",{className:"p-4",children:"Ø§Ù„Ø­Ø²Ø§Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ (ØªØ¹Ø¯ÙŠÙ„ ÙŠØ¯ÙˆÙŠ)"}),e.jsx("th",{className:"p-4",children:"ØªØ§Ø±ÙŠØ® Ø§Ù„ÙØ­Øµ Ø§Ù„Ù‚Ø§Ø¯Ù…"}),e.jsx("th",{className:"p-4 text-center",children:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:c.map(d=>{const u=V.indexOf(d.belt)>=V.length-1;return e.jsxs("tr",{className:"hover:bg-yellow-50/30 transition-colors",children:[e.jsx("td",{className:"p-4 font-bold text-gray-800",children:d.name}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"relative w-fit",children:[e.jsx("select",{className:`appearance-none pl-8 pr-3 py-1.5 rounded-lg font-bold text-xs shadow-sm border cursor-pointer outline-none focus:ring-2 focus:ring-offset-1 focus:ring-yellow-400 ${mt(d.belt)}`,value:d.belt,onChange:j=>v(d,j.target.value),children:V.map(j=>e.jsx("option",{value:j,className:"bg-white text-gray-800",children:j},j))}),e.jsx(Ee,{size:12,className:"absolute top-1/2 -translate-y-1/2 left-2 opacity-50 pointer-events-none"})]})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 w-fit p-1 rounded-lg border border-gray-200",children:[e.jsx(pe,{size:16,className:"text-gray-400 mr-1"}),e.jsx("input",{type:"date",className:"bg-transparent outline-none text-gray-700 font-mono text-xs cursor-pointer",value:d.nextTestDate||"",onChange:j=>w(d.id,j.target.value)})]})}),e.jsx("td",{className:"p-4 text-center",children:e.jsxs("button",{onClick:()=>m(d),disabled:u,className:`flex items-center gap-1 px-4 py-2 rounded-xl text-xs font-bold transition-all mx-auto
                                                    ${u?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-green-100 text-green-700 hover:bg-green-600 hover:text-white hover:shadow-lg hover:shadow-green-500/20"}`,title:"ØªØ±ÙÙŠØ¹ Ù„Ù„Ø­Ø²Ø§Ù… Ø§Ù„ØªØ§Ù„ÙŠ Ù…Ø¨Ø§Ø´Ø±Ø©",children:[u?e.jsx(Ne,{size:14}):e.jsx(Ae,{size:14}),u?"Ø£Ø¹Ù„Ù‰ Ø±ØªØ¨Ø©":"ØªØ±ÙÙŠØ¹ ØªÙ„Ù‚Ø§Ø¦ÙŠ"]})})]},d.id)})})]})})}),e.jsx("div",{className:"md:hidden grid gap-4",children:c.map(d=>{const u=V.indexOf(d.belt)>=V.length-1;return e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex flex-col gap-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-800 text-lg",children:d.name}),e.jsxs("div",{className:"mt-2 relative inline-block",children:[e.jsx("select",{className:`appearance-none pl-8 pr-4 py-1 rounded text-[10px] font-bold border w-full ${mt(d.belt)}`,value:d.belt,onChange:j=>v(d,j.target.value),children:V.map(j=>e.jsx("option",{value:j,className:"bg-white text-gray-800",children:j},j))}),e.jsx(Ee,{size:10,className:"absolute top-1/2 -translate-y-1/2 left-2 opacity-50 pointer-events-none"})]})]}),e.jsx("div",{className:"text-gray-400 bg-gray-50 p-2 rounded-full",children:e.jsx(Nt,{size:20})})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-xl border border-gray-100",children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-500 mb-1 block",children:"ØªØ§Ø±ÙŠØ® Ø§Ù„ÙØ­Øµ Ø§Ù„Ù‚Ø§Ø¯Ù…"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{size:16,className:"text-gray-400"}),e.jsx("input",{type:"date",className:"bg-transparent w-full outline-none text-gray-800 font-bold text-sm",value:d.nextTestDate||"",onChange:j=>w(d.id,j.target.value)})]})]}),e.jsxs("button",{onClick:()=>m(d),disabled:u,className:`w-full py-3 rounded-xl font-bold flex items-center justify-center gap-2 transition-all
                                    ${u?"bg-gray-100 text-gray-400":"bg-green-600 text-white shadow-lg shadow-green-600/20 active:scale-95"}`,children:[u?e.jsx(Ne,{size:18}):e.jsx(Ae,{size:18}),u?"ÙˆØµÙ„ Ù„Ø£Ø¹Ù„Ù‰ Ø±ØªØ¨Ø©":"ØªØ±ÙÙŠØ¹ Ù„Ù„Ø­Ø²Ø§Ù… Ø§Ù„ØªØ§Ù„ÙŠ"]})]},d.id)})}),c.length===0&&e.jsx("div",{className:"text-center py-10 text-gray-400",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø§Ø¨ Ù…Ø·Ø§Ø¨Ù‚ÙŠÙ† Ù„Ù„Ø¨Ø­Ø«"})]})}function ks({students:a,payments:r,expenses:n,activityLogs:x,registrations:l,adminNotes:i,selectedBranch:s}){const m=new Date,v=new Date(m.getFullYear(),m.getMonth(),1).toISOString().split("T")[0],w=new Date().toISOString().split("T")[0],[c,d]=b.useState(v),[S,u]=b.useState(w),j=N=>{if(!N)return!1;const $=new Date(N);$.setHours(0,0,0,0);const H=new Date(c);H.setHours(0,0,0,0);const g=new Date(S);return g.setHours(0,0,0,0),$>=H&&$<=g},h=N=>{if(!N)return{label:"Ù…Ù†ØªÙ‡ÙŠ",color:"#fee2e2",text:"#991b1b"};const $=new Date,H=new Date(N);$.setHours(0,0,0,0),H.setHours(0,0,0,0);const g=H-$,R=Math.ceil(g/(1e3*60*60*24));return R<0?{label:"Ù…Ù†ØªÙ‡ÙŠ",color:"#fee2e2",text:"#991b1b"}:R<=7?{label:"Ù‚Ø§Ø±Ø¨ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡",color:"#ffedd5",text:"#9a3412"}:{label:"ÙØ¹Ø§Ù„",color:"#dcfce7",text:"#166534"}},f=r.filter(N=>N.branch===s&&j(N.date)),p=n.filter(N=>N.branch===s&&j(N.date)),I=f.reduce((N,$)=>N+(Number($.amount)||0),0),o=p.reduce((N,$)=>N+(Number($.amount)||0),0),k=I-o,A=x?x.filter(N=>N.branch===s&&j(N.timestamp)):[],O=i||[],M=a.filter(N=>N.branch===s).map(N=>{let $=0;N.attendance&&Object.keys(N.attendance).forEach(_=>{j(_)&&$++});const H=r.filter(_=>_.studentId===N.id||_.name===N.name).sort((_,W)=>new Date(W.date)-new Date(_.date)),g=H.length>0?H[0].date:"-";let R=[];N.note&&R.push(`[Ù‚Ø¯ÙŠÙ…: ${N.note}]`),N.notes&&N.notes.length>0&&N.notes.forEach(_=>R.push(_.text)),N.internalNotes&&N.internalNotes.length>0&&N.internalNotes.forEach(_=>R.push(`(Ø®Ø§Øµ: ${_.text})`));const K=R.join(" | ");return{...N,attendanceCount:$,lastPaymentDate:g,notesString:K||"-",statusInfo:h(N.subEnd)}}),T=()=>{const N=window.open("","PRINT","height=800,width=1000"),$=window.location.origin+oe.LOGO,H=`
            <!DOCTYPE html>
            <html lang="ar" dir="rtl">
            <head>
                <meta charset="UTF-8">
                <title>Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ø§Ù…Ù„ - ${s}</title>
                <style>
                    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap');
                    body { font-family: 'Cairo', sans-serif; padding: 15px; color: #1f2937; font-size: 10px; }
                    .header { text-align: center; border-bottom: 2px solid #fbbf24; padding-bottom: 10px; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; }
                    .header-content { text-align: center; flex: 1; }
                    .logo { height: 60px; object-fit: contain; }
                    h1 { margin: 0; color: #000; font-size: 18px; }
                    h2 { font-size: 14px; background: #f3f4f6; padding: 6px 10px; margin-top: 20px; border-right: 4px solid #000; font-weight: 700; }
                    
                    table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
                    th, td { border: 1px solid #ccc; padding: 5px; text-align: right; vertical-align: middle; }
                    th { background-color: #f9fafb; font-weight: 700; white-space: nowrap; font-size: 10px; }
                    td { font-size: 10px; }
                    
                    .financial-grid { display: flex; gap: 15px; }
                    .box { flex: 1; border: 1px solid #ddd; padding: 8px; text-align: center; border-radius: 5px; }
                    .amount { font-size: 14px; font-weight: bold; display: block; margin-bottom: 2px; }
                    
                    .status-badge { padding: 2px 6px; border-radius: 4px; font-weight: bold; display: inline-block; font-size: 9px; }
                    
                    @media print {
                        @page { size: A4 landscape; margin: 10mm; }
                        body { -webkit-print-color-adjust: exact; }
                        button { display: none; }
                    }
                </style>
            </head>
            <body>
                <div class="header">
                    <div style="font-size:10px; text-align:right;">
                        Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date().toLocaleDateString("ar-EG")}<br>
                        Ø§Ù„ÙØ±Ø¹: <strong>${s}</strong>
                    </div>
                    <div class="header-content">
                        <h1>Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ ÙˆØ§Ù„Ù…Ø§Ù„ÙŠ Ø§Ù„Ø´Ø§Ù…Ù„</h1>
                        <p style="margin:2px 0 0 0; color:#666;">Ø§Ù„ÙØªØ±Ø©: Ù…Ù† ${c} Ø¥Ù„Ù‰ ${S}</p>
                    </div>
                    <img src="${$}" class="logo" onerror="this.style.display='none'"/>
                </div>

                <h2>Ø£ÙˆÙ„Ø§Ù‹: Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø§Ù„ÙŠ (Ø®Ù„Ø§Ù„ Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©)</h2>
                <div class="financial-grid">
                    <div class="box" style="background:#f0fdf4; border-color:#86efac;">
                        <span class="amount" style="color:#166534;">${I} JD</span>
                        <span>Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</span>
                    </div>
                    <div class="box" style="background:#fef2f2; border-color:#fca5a5;">
                        <span class="amount" style="color:#991b1b;">${o} JD</span>
                        <span>Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ</span>
                    </div>
                    <div class="box" style="background:#eff6ff; border-color:#93c5fd;">
                        <span class="amount" style="color:#1e40af;">${k} JD</span>
                        <span>ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­</span>
                    </div>
                </div>

                <div class="financial-grid" style="margin-top:10px;">
                    <div style="flex:1;">
                        <h3 style="margin:5px 0; font-size:11px; color:green;">ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙˆØµÙˆÙ„Ø§Øª (Ø§Ù„ÙˆØ§Ø±Ø¯Ø§Øª)</h3>
                        <table>
                            <thead><tr><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø§Ù„Ø·Ø§Ù„Ø¨</th><th>Ø§Ù„Ù…Ø¨Ù„Øº</th><th>Ø§Ù„Ø¨ÙŠØ§Ù†</th></tr></thead>
                            <tbody>
                                ${f.map(g=>`<tr><td>${g.date}</td><td>${g.name}</td><td>${g.amount}</td><td>${g.reason||"-"}</td></tr>`).join("")}
                                ${f.length===0?'<tr><td colspan="4" style="text-align:center">-</td></tr>':""}
                            </tbody>
                        </table>
                    </div>
                    <div style="flex:1;">
                        <h3 style="margin:5px 0; font-size:11px; color:red;">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ</h3>
                        <table>
                            <thead><tr><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø§Ù„Ø¨Ù†Ø¯</th><th>Ø§Ù„Ù…Ø¨Ù„Øº</th></tr></thead>
                            <tbody>
                                ${p.map(g=>`<tr><td>${g.date}</td><td>${g.title}</td><td>${g.amount}</td></tr>`).join("")}
                                ${p.length===0?'<tr><td colspan="3" style="text-align:center">-</td></tr>':""}
                            </tbody>
                        </table>
                    </div>
                </div>

                <h2>Ø«Ø§Ù†ÙŠØ§Ù‹: Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© (Ø§Ù„Ù†Ø´Ø·Ø© Ø­Ø§Ù„ÙŠØ§Ù‹)</h2>
                <table>
                    <thead><tr><th width="15%">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø¶Ø§ÙØ©</th><th>Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©</th></tr></thead>
                    <tbody>
                        ${O.map(g=>`<tr><td>${g.date||"-"}</td><td>${g.text||g.content}</td></tr>`).join("")}
                        ${O.length===0?'<tr><td colspan="2" style="text-align:center">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¯Ø§Ø±ÙŠØ©</td></tr>':""}
                    </tbody>
                </table>

                <h2>Ø«Ø§Ù„Ø«Ø§Ù‹: Ø³Ø¬Ù„ Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙˆØ§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ© (Logs)</h2>
                <table>
                    <thead><tr><th width="15%">Ø§Ù„ÙˆÙ‚Øª ÙˆØ§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ù†ÙˆØ¹ Ø§Ù„Ø­Ø±ÙƒØ©</th><th>Ø§Ù„ØªÙØ§ØµÙŠÙ„</th><th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th></tr></thead>
                    <tbody>
                        ${A.map(g=>`
                            <tr>
                                <td dir="ltr" style="text-align:right">${new Date(g.timestamp).toLocaleString("ar-EG")}</td>
                                <td>${g.action}</td>
                                <td>${g.details}</td>
                                <td>${g.performedBy}</td>
                            </tr>
                        `).join("")}
                        ${A.length===0?'<tr><td colspan="4" style="text-align:center">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø­Ø±ÙƒØ§Øª ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©</td></tr>':""}
                    </tbody>
                </table>

                <h2>Ø±Ø§Ø¨Ø¹Ø§Ù‹: Ø³Ø¬Ù„ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ø´Ø§Ù…Ù„ (Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ)</h2>
                <table>
                    <thead>
                        <tr>
                            <th width="2%">#</th>
                            <th width="12%">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                            <th width="6%">Ø§Ù„Ø­Ø²Ø§Ù…</th>
                            <th width="8%">Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</th>
                            <th width="8%">ÙŠÙ†ØªÙ‡ÙŠ ÙÙŠ</th>
                            <th width="8%">Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø§Ù„ÙŠ</th>
                            <th width="8%">Ø¢Ø®Ø± ÙˆØµÙ„</th>
                            <th width="5%">Ø­Ø¶ÙˆØ±*</th>
                            <th width="8%">ÙØ­Øµ Ù‚Ø§Ø¯Ù…</th>
                            <th>Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª (ÙƒÙ„ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹)</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${M.map((g,R)=>`
                            <tr>
                                <td>${R+1}</td>
                                <td style="font-weight:bold;">${g.name}</td>
                                <td>${g.belt}</td>
                                <td style="text-align:center;">
                                    <span class="status-badge" style="background:${g.statusInfo.color}; color:${g.statusInfo.text};">
                                        ${g.statusInfo.label}
                                    </span>
                                </td>
                                <td>${g.subEnd||"-"}</td>
                                <td>
                                    ${Number(g.balance)>0?`<span style="color:red; font-weight:bold;">Ø¹Ù„ÙŠÙ‡ ${g.balance}</span>`:'<span style="color:green;">Ø®Ø§Ù„Øµ</span>'}
                                </td>
                                <td>${g.lastPaymentDate}</td>
                                <td style="text-align:center; font-weight:bold;">${g.attendanceCount}</td>
                                <td>${g.nextTestDate||"-"}</td>
                                <td style="font-size:9px; color:#555;">${g.notesString}</td>
                            </tr>
                        `).join("")}
                    </tbody>
                </table>
                <p style="font-size:9px; margin-top:5px;">* Ø¹Ø¯Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„Ø­Ø¶ÙˆØ± ÙŠØªÙ… Ø­Ø³Ø§Ø¨Ù‡ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© ÙÙŠ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙÙ‚Ø·.</p>

                <script>window.onload = function() { window.print(); }<\/script>
            </body>
            </html>
        `;N.document.write(H),N.document.close()};return e.jsxs("div",{className:"space-y-6 animate-fade-in pb-20 md:pb-0",children:[e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 sticky top-0 z-20",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-black text-gray-800 flex items-center gap-2",children:[e.jsx(ve,{className:"text-yellow-500"})," Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ø§Ù…Ù„Ø©"]}),e.jsx("p",{className:"text-gray-500 text-xs mt-1",children:"ÙŠØ¸Ù‡Ø± Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©ØŒ Ø¨ÙŠÙ†Ù…Ø§ ÙŠØªÙ… ÙÙ„ØªØ±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙˆØ§Ù„Ø­Ø¶ÙˆØ± Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ®."})]}),e.jsxs("button",{onClick:T,className:"bg-gray-900 text-white px-6 py-2.5 rounded-xl font-bold flex items-center gap-2 hover:bg-black shadow-lg hover:shadow-xl transition-all w-full md:w-auto justify-center",children:[e.jsx(ue,{size:18})," Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ± (PDF)"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 bg-gray-50 p-3 rounded-xl border border-gray-200",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"Ù…Ù† ØªØ§Ø±ÙŠØ® (Ù„Ù„Ù…Ø§Ù„ÙŠØ© ÙˆØ§Ù„Ø­Ø¶ÙˆØ±)"}),e.jsx("input",{type:"date",value:c,onChange:N=>d(N.target.value),className:"w-full p-2 rounded-lg border-2 border-gray-200 outline-none focus:border-yellow-500 font-bold text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ® (Ù„Ù„Ù…Ø§Ù„ÙŠØ© ÙˆØ§Ù„Ø­Ø¶ÙˆØ±)"}),e.jsx("input",{type:"date",value:S,onChange:N=>u(N.target.value),className:"w-full p-2 rounded-lg border-2 border-gray-200 outline-none focus:border-yellow-500 font-bold text-sm"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(J,{className:"border-green-100 bg-green-50/50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg text-green-600",children:e.jsx(De,{size:20})}),e.jsx("h3",{className:"font-bold text-gray-600 text-sm",children:"Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª"})]}),e.jsxs("p",{className:"text-2xl font-black text-green-700",children:[I," JD"]})]}),e.jsxs(J,{className:"border-red-100 bg-red-50/50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg text-red-600",children:e.jsx(Xe,{size:20})}),e.jsx("h3",{className:"font-bold text-gray-600 text-sm",children:"Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ"})]}),e.jsxs("p",{className:"text-2xl font-black text-red-700",children:[o," JD"]})]}),e.jsxs(J,{className:"border-blue-100 bg-blue-50/50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg text-blue-600",children:e.jsx(De,{size:20})}),e.jsx("h3",{className:"font-bold text-gray-600 text-sm",children:"ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­"})]}),e.jsxs("p",{className:"text-2xl font-black text-blue-700",children:[k," JD"]})]}),e.jsxs(J,{className:"border-yellow-100 bg-yellow-50/50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg text-yellow-600",children:e.jsx(ye,{size:20})}),e.jsx("h3",{className:"font-bold text-gray-600 text-sm",children:"Ø§Ù„Ø·Ù„Ø§Ø¨ (Ø§Ù„ÙØ±Ø¹)"})]}),e.jsx("p",{className:"text-2xl font-black text-yellow-700",children:M.length})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-50 bg-gray-50 flex justify-between items-center",children:[e.jsxs("h3",{className:"font-bold text-green-700 flex items-center gap-2",children:[e.jsx(De,{size:18})," Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª"]}),e.jsxs("span",{className:"text-xs font-bold bg-green-100 text-green-800 px-2 py-1 rounded-full",children:[f.length," ÙˆØµÙ„"]})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto custom-scrollbar",children:e.jsxs("table",{className:"w-full text-xs text-right",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-500 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"Ø§Ù„ØªØ§Ø±ÙŠØ®"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„Ø·Ø§Ù„Ø¨"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„Ù…Ø¨Ù„Øº"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-50",children:[f.map(N=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 text-gray-500",children:N.date}),e.jsx("td",{className:"p-3 font-bold text-gray-700",children:N.name}),e.jsx("td",{className:"p-3 font-bold text-green-600",children:N.amount})]},N.id)),f.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"p-4 text-center text-gray-400",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¥ÙŠØ±Ø§Ø¯Ø§Øª"})})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-50 bg-gray-50 flex justify-between items-center",children:[e.jsxs("h3",{className:"font-bold text-red-700 flex items-center gap-2",children:[e.jsx(Xe,{size:18})," Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ"]}),e.jsxs("span",{className:"text-xs font-bold bg-red-100 text-red-800 px-2 py-1 rounded-full",children:[p.length," Ø­Ø±ÙƒØ©"]})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto custom-scrollbar",children:e.jsxs("table",{className:"w-full text-xs text-right",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-500 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"Ø§Ù„ØªØ§Ø±ÙŠØ®"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„Ø¨Ù†Ø¯"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„Ù…Ø¨Ù„Øº"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-50",children:[p.map(N=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 text-gray-500",children:N.date}),e.jsx("td",{className:"p-3 font-bold text-gray-700",children:N.title}),e.jsx("td",{className:"p-3 font-bold text-red-600",children:N.amount})]},N.id)),p.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"p-4 text-center text-gray-400",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ØµØ§Ø±ÙŠÙ"})})]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-50 bg-yellow-50/50 flex justify-between items-center",children:[e.jsxs("h3",{className:"font-bold text-yellow-800 flex items-center gap-2",children:[e.jsx(Bt,{size:18})," Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© (Ø§Ù„ÙƒÙ„)"]}),e.jsxs("span",{className:"text-xs font-bold bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full",children:[O.length," Ù…Ù„Ø§Ø­Ø¸Ø©"]})]}),e.jsx("div",{className:"max-h-48 overflow-y-auto custom-scrollbar p-0",children:e.jsxs("table",{className:"w-full text-xs text-right",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-500 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 w-32",children:"Ø§Ù„ØªØ§Ø±ÙŠØ®"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-50",children:[O.map((N,$)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 text-gray-500",children:N.date||"-"}),e.jsx("td",{className:"p-3 text-gray-700",children:N.text||N.content})]},$)),O.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"2",className:"p-4 text-center text-gray-400",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¯Ø§Ø±ÙŠØ©"})})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-50 bg-gray-50 flex justify-between items-center",children:[e.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(ke,{size:18})," Ø³Ø¬Ù„ Ø§Ù„Ø­Ø±ÙƒØ§Øª (Ø®Ù„Ø§Ù„ Ø§Ù„ÙØªØ±Ø©)"]}),e.jsxs("span",{className:"text-xs font-bold bg-gray-200 text-gray-800 px-2 py-1 rounded-full",children:[A.length," Ø­Ø±ÙƒØ©"]})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto custom-scrollbar p-0",children:e.jsxs("table",{className:"w-full text-xs text-right",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-500 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"Ø§Ù„ÙˆÙ‚Øª"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„Ø­Ø¯Ø«"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„ØªÙØ§ØµÙŠÙ„"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-50",children:[A.map((N,$)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 text-gray-500 dir-ltr text-right",children:new Date(N.timestamp).toLocaleDateString("ar-EG")}),e.jsx("td",{className:"p-3 font-bold text-gray-700",children:N.action}),e.jsx("td",{className:"p-3 text-gray-600",children:N.details}),e.jsx("td",{className:"p-3 text-blue-600",children:N.performedBy})]},$)),A.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"p-4 text-center text-gray-400",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø­Ø±ÙƒØ§Øª ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©"})})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-50 bg-blue-50/50 flex justify-between items-center",children:e.jsxs("h3",{className:"font-bold text-blue-800 flex items-center gap-2",children:[e.jsx(ye,{size:18})," Ø³Ø¬Ù„ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ø´Ø§Ù…Ù„"]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-xs text-right",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"#"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„Ø·Ø§Ù„Ø¨"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„Ø­Ø²Ø§Ù…"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„Ù…Ø§Ù„ÙŠØ©"}),e.jsx("th",{className:"p-3",children:"Ø¢Ø®Ø± ÙˆØµÙ„"}),e.jsx("th",{className:"p-3",children:"Ø§Ù„Ø­Ø¶ÙˆØ±"}),e.jsx("th",{className:"p-3",children:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:M.map((N,$)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 text-gray-400",children:$+1}),e.jsx("td",{className:"p-3 font-bold text-gray-800",children:N.name}),e.jsx("td",{className:"p-3 text-gray-600",children:N.belt}),e.jsx("td",{className:"p-3",children:e.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold ${N.statusInfo.color} ${N.statusInfo.text}`,children:N.statusInfo.label})}),e.jsx("td",{className:"p-3 dir-ltr text-right text-gray-500",children:N.subEnd||"-"}),e.jsx("td",{className:"p-3",children:Number(N.balance)>0?e.jsxs("span",{className:"text-red-600 font-bold bg-red-50 px-2 py-0.5 rounded",children:["Ø¹Ù„ÙŠÙ‡ ",N.balance]}):e.jsx("span",{className:"text-green-600",children:"Ø®Ø§Ù„Øµ"})}),e.jsx("td",{className:"p-3 text-gray-500",children:N.lastPaymentDate}),e.jsx("td",{className:"p-3 font-bold text-center",children:N.attendanceCount}),e.jsx("td",{className:"p-3 text-gray-500 max-w-xs truncate",title:N.notesString,children:N.notesString!=="-"?N.notesString:""})]},N.id))})]})})]})]})}const Ue=a=>{if(!a)return"expired";const r=new Date,n=new Date(a);r.setHours(0,0,0,0),n.setHours(0,0,0,0);const x=n-r,l=Math.ceil(x/(1e3*60*60*24));return l<0?"expired":l<=7?"near_end":"active"},Ss=a=>{switch(a){case"active":return"ÙØ¹Ø§Ù„ (Working)";case"near_end":return"Ù‚Ø§Ø±Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ (About to finish)";case"expired":return"Ù…Ù†ØªÙ‡ÙŠ (Finished)";default:return"-"}};function Ds({students:a,studentsCollection:r,logActivity:n,selectedBranch:x}){const[l,i]=b.useState(null),[s,m]=b.useState("all"),[v,w]=b.useState(null),[c,d]=b.useState(""),S=async(p,I)=>{const o=p.subEnd?new Date(p.subEnd):new Date,k=new Date(o);k.setMonth(k.getMonth()+I);const A=k.toISOString().split("T")[0];window.confirm(`ØªØ¬Ø¯ÙŠØ¯ Ø§Ø´ØªØ±Ø§Ùƒ ${p.name} Ù„Ù…Ø¯Ø© ${I} Ø´Ù‡Ø±ØŸ
Ù…Ù†: ${p.subEnd||"Ø§Ù„ÙŠÙˆÙ…"}
Ø¥Ù„Ù‰: ${A}`)&&(await r.update(p.id,{subEnd:A}),n&&n("ØªØ¬Ø¯ÙŠØ¯ Ø³Ø±ÙŠØ¹",`ØªØ¬Ø¯ÙŠØ¯ Ø§Ø´ØªØ±Ø§Ùƒ Ù„Ù„Ø·Ø§Ù„Ø¨ ${p.name} (+${I} Ø´Ù‡Ø±) Ù„ÙŠØµØ¨Ø­ ${A}`))},u=async p=>{if(!c)return;const I=a.find(k=>k.id===p),o=I?I.name:"Ø·Ø§Ù„Ø¨ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ";await r.update(p,{subEnd:c}),n&&n("ØªØ¹Ø¯ÙŠÙ„ Ø§Ø´ØªØ±Ø§Ùƒ",`ØªØ¹Ø¯ÙŠÙ„ ØªØ§Ø±ÙŠØ® Ø§Ø´ØªØ±Ø§Ùƒ Ù„Ù„Ø·Ø§Ù„Ø¨ ${o} ÙŠØ¯ÙˆÙŠØ§Ù‹ Ø¥Ù„Ù‰ ${c}`),w(null)},j=p=>{w(p.id),d(p.subEnd||new Date().toISOString().split("T")[0])},h=b.useMemo(()=>a.filter(p=>{const I=l?p.id===l:!0,o=Ue(p.subEnd);return I&&(s==="all"||o===s)}).sort((p,I)=>new Date(p.subEnd||0)-new Date(I.subEnd||0)),[a,l,s]),f=()=>{const p=window.open("","PRINT","height=800,width=1000"),I=window.location.origin+oe.LOGO,o=new Date().toLocaleDateString("ar-EG"),k=`
            <!DOCTYPE html>
            <html lang="ar" dir="rtl">
            <head>
                <meta charset="UTF-8">
                <title>ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª - ${x||""}</title>
                <style>
                    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap');
                    body { font-family: 'Cairo', sans-serif; padding: 20px; }
                    .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 20px; }
                    .logo { height: 80px; margin-bottom: 10px; }
                    table { width: 100%; border-collapse: collapse; font-size: 12px; }
                    th, td { border: 1px solid #ddd; padding: 8px; text-align: right; }
                    th { background-color: #f3f4f6; }
                    .status-active { color: green; font-weight: bold; }
                    .status-near_end { color: orange; font-weight: bold; }
                    .status-expired { color: red; font-weight: bold; }
                    @media print { button { display: none; } }
                </style>
            </head>
            <body>
                <div class="header">
                    <img src="${I}" class="logo" onerror="this.style.display='none'"/>
                    <h2>ØªÙ‚Ø±ÙŠØ± Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</h2>
                    <p>Ø§Ù„ØªØ§Ø±ÙŠØ®: ${o}</p>
                    <p>Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨ ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©: ${h.length}</p>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                            <th>Ø§Ù„Ø­Ø²Ø§Ù…</th>
                            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</th>
                            <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${h.map((A,O)=>{const M=Ue(A.subEnd),T=Ss(M),N=`status-${M}`;return`
                                <tr>
                                    <td>${O+1}</td>
                                    <td>${A.name}</td>
                                    <td>${A.belt}</td>
                                    <td style="direction:ltr; text-align:right">${A.subEnd||"-"}</td>
                                    <td class="${N}">${T}</td>
                                </tr>
                            `}).join("")}
                    </tbody>
                </table>
                <script>window.onload = function() { window.print(); }<\/script>
            </body>
            </html>
        `;p.document.write(k),p.document.close()};return e.jsxs("div",{className:"space-y-6 animate-fade-in pb-20 md:pb-0",children:[e.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-100 flex flex-col md:flex-row gap-4 justify-between items-end sticky top-0 z-20",children:[e.jsxs("div",{className:"relative w-full md:w-1/3",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 mb-1 block",children:"Ø¨Ø­Ø« Ø¹Ù† Ø·Ø§Ù„Ø¨ (Thinker Search)"}),e.jsx(Ge,{students:a,onSelect:p=>i(p.id),onClear:()=>i(null),placeholder:"Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨...",showAllOption:!0})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto overflow-x-auto pb-1 md:pb-0",children:[e.jsx("button",{onClick:()=>m("all"),className:`px-4 py-2.5 rounded-xl text-xs font-bold transition-all whitespace-nowrap ${s==="all"?"bg-gray-800 text-white":"bg-gray-100 text-gray-600"}`,children:"Ø§Ù„ÙƒÙ„"}),e.jsx("button",{onClick:()=>m("active"),className:`px-4 py-2.5 rounded-xl text-xs font-bold transition-all whitespace-nowrap ${s==="active"?"bg-green-600 text-white":"bg-green-50 text-green-600"}`,children:"Ø³Ø§Ø±ÙŠ Ø§Ù„Ù…ÙØ¹ÙˆÙ„"}),e.jsx("button",{onClick:()=>m("near_end"),className:`px-4 py-2.5 rounded-xl text-xs font-bold transition-all whitespace-nowrap ${s==="near_end"?"bg-orange-500 text-white":"bg-orange-50 text-orange-600"}`,children:"Ù‚Ø±Ø¨ ÙŠÙ†ØªÙ‡ÙŠ"}),e.jsx("button",{onClick:()=>m("expired"),className:`px-4 py-2.5 rounded-xl text-xs font-bold transition-all whitespace-nowrap ${s==="expired"?"bg-red-600 text-white":"bg-red-50 text-red-600"}`,children:"Ù…Ù†ØªÙ‡ÙŠ"})]}),e.jsxs(L,{onClick:f,className:"bg-blue-600 hover:bg-blue-700 text-white shadow-blue-200",children:[e.jsx(ue,{size:18,className:"ml-2"})," Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©"]})]}),e.jsx("div",{className:"hidden md:block",children:e.jsx(J,{noPadding:!0,children:e.jsxs("table",{className:"w-full text-sm text-right",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Ø§Ù„Ø·Ø§Ù„Ø¨"}),e.jsx("th",{className:"p-4",children:"Ø§Ù„Ø­Ø§Ù„Ø©"}),e.jsx("th",{className:"p-4",children:"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø­Ø§Ù„ÙŠ"}),e.jsx("th",{className:"p-4 text-center",children:"ØªØ¬Ø¯ÙŠØ¯ Ø³Ø±ÙŠØ¹"}),e.jsx("th",{className:"p-4 text-center",children:"ØªØ¹Ø¯ÙŠÙ„ ÙŠØ¯ÙˆÙŠ"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100",children:[h.map(p=>e.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[e.jsx("td",{className:"p-4 font-bold text-gray-800",children:p.name}),e.jsx("td",{className:"p-4",children:e.jsx(Me,{status:Ue(p.subEnd)})}),e.jsx("td",{className:"p-4 font-mono text-gray-600 dir-ltr text-right",children:p.subEnd||"ØºÙŠØ± Ù…Ø­Ø¯Ø¯"}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx("button",{onClick:()=>S(p,1),className:"bg-green-50 hover:bg-green-100 text-green-700 px-3 py-1 rounded-lg text-xs font-bold transition border border-green-200",children:"+1 Ø´Ù‡Ø±"}),e.jsx("button",{onClick:()=>S(p,2),className:"bg-blue-50 hover:bg-blue-100 text-blue-700 px-3 py-1 rounded-lg text-xs font-bold transition border border-blue-200",children:"+2 Ø´Ù‡Ø±"}),e.jsx("button",{onClick:()=>S(p,3),className:"bg-purple-50 hover:bg-purple-100 text-purple-700 px-3 py-1 rounded-lg text-xs font-bold transition border border-purple-200",children:"+3 Ø´Ù‡Ø±"})]})}),e.jsx("td",{className:"p-4 text-center",children:v===p.id?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("input",{type:"date",className:"border rounded p-1 text-xs",value:c,onChange:I=>d(I.target.value)}),e.jsx("button",{onClick:()=>u(p.id),className:"text-green-600 hover:bg-green-50 p-1 rounded",children:e.jsx(Ne,{size:18})}),e.jsx("button",{onClick:()=>w(null),className:"text-red-500 hover:bg-red-50 p-1 rounded",children:e.jsx(Kt,{size:18})})]}):e.jsx("button",{onClick:()=>j(p),className:"text-gray-400 hover:text-blue-600 flex items-center justify-center gap-1 mx-auto",children:e.jsx(Ee,{size:16})})})]},p.id)),h.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center p-8 text-gray-400",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø§Ø¨ Ù…Ø·Ø§Ø¨Ù‚ÙŠÙ† Ù„Ù„Ø¨Ø­Ø«"})})]})]})})}),e.jsxs("div",{className:"md:hidden grid gap-4",children:[h.map(p=>{const I=Ue(p.subEnd);return e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-100 relative overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 left-0 w-1 h-full ${I==="active"?"bg-green-500":I==="near_end"?"bg-orange-500":"bg-red-500"}`}),e.jsxs("div",{className:"flex justify-between items-start mb-4 pl-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-800 text-lg",children:p.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-gray-500 text-xs",children:[e.jsx(Re,{size:12})," ÙŠÙ†ØªÙ‡ÙŠ: ",p.subEnd||"ØºÙŠØ± Ù…Ø­Ø¯Ø¯"]})]}),e.jsx(Me,{status:I})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[e.jsx("button",{onClick:()=>S(p,1),className:"bg-green-50 text-green-700 py-2 rounded-lg text-xs font-bold border border-green-100 hover:bg-green-100",children:"+ Ø´Ù‡Ø±"}),e.jsx("button",{onClick:()=>S(p,2),className:"bg-blue-50 text-blue-700 py-2 rounded-lg text-xs font-bold border border-blue-100 hover:bg-blue-100",children:"+ Ø´Ù‡Ø±ÙŠÙ†"}),e.jsx("button",{onClick:()=>S(p,3),className:"bg-purple-50 text-purple-700 py-2 rounded-lg text-xs font-bold border border-purple-100 hover:bg-purple-100",children:"+ 3 Ø´Ù‡ÙˆØ±"})]}),e.jsxs("div",{className:"bg-gray-50 p-2 rounded-lg flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 whitespace-nowrap",children:"ØªØ¹Ø¯ÙŠÙ„ ÙŠØ¯ÙˆÙŠ:"}),e.jsx("input",{type:"date",className:"flex-1 bg-white border border-gray-200 rounded p-1 text-xs outline-none focus:border-blue-500",defaultValue:p.subEnd,onBlur:o=>{o.target.value!==p.subEnd&&window.confirm("Ø­ÙØ¸ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¬Ø¯ÙŠØ¯ØŸ")&&r.update(p.id,{subEnd:o.target.value})}})]})]},p.id)}),h.length===0&&e.jsx("div",{className:"text-center p-10 text-gray-400 bg-white rounded-xl border border-dashed",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬"})]})]})}function Cs({students:a,studentsCollection:r,logActivity:n,selectedBranch:x}){const[l,i]=b.useState(null),[s,m]=b.useState(""),[v,w]=b.useState("private"),[c,d]=b.useState(null),S=o=>{if(!o)return[];let k=[];o.note&&typeof o.note=="string"&&o.note.trim()!==""&&k.push({id:"legacy_note",text:o.note,type:"private",date:"Ø³Ø¬Ù„ Ù‚Ø¯ÙŠÙ…",isLegacy:!0});const A=o.notes||[],O=o.internalNotes||[];if(Array.isArray(A)&&(k=[...k,...A]),Array.isArray(O)){const M=new Set(k.map(T=>T.id));O.forEach(T=>{M.has(T.id)||k.push({...T,type:"private"})})}return k.sort((M,T)=>M.isLegacy?1:T.isLegacy?-1:T.id>M.id?1:-1)},u=b.useMemo(()=>a.filter(o=>{const k=o.note&&o.note.trim().length>0,A=o.notes&&o.notes.length>0||o.internalNotes&&o.internalNotes.length>0;return k||A}),[a]),j=async()=>{if(!l||!s.trim())return;let o={};if(c)c.isLegacy?(o={note:s},n("ØªØ¹Ø¯ÙŠÙ„ Ù…Ù„Ø§Ø­Ø¸Ø©",`ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„Ø·Ø§Ù„Ø¨ ${l.name}`)):(o={notes:(l.notes||[]).map(O=>O.id===c.id?{...O,text:s,type:v}:O)},n("ØªØ¹Ø¯ÙŠÙ„ Ù…Ù„Ø§Ø­Ø¸Ø©",`ØªØ¹Ø¯ÙŠÙ„ Ù…Ù„Ø§Ø­Ø¸Ø© ÙÙŠ Ø§Ù„Ø³Ø¬Ù„ Ù„Ù„Ø·Ø§Ù„Ø¨ ${l.name}`));else{const k={id:Date.now().toString(),text:s,type:v,date:new Date().toISOString().split("T")[0],branch:x},A=l.notes||[];o={notes:[k,...A]},n("Ù…Ù„Ø§Ø­Ø¸Ø© Ø¬Ø¯ÙŠØ¯Ø©",`Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ø§Ø­Ø¸Ø© (${v==="private"?"Ø®Ø§ØµØ©":"Ø¹Ø§Ù…Ø©"}) Ù„Ù„Ø·Ø§Ù„Ø¨ ${l.name}`)}await r.update(l.id,o),i(k=>({...k,...o})),m(""),d(null),w("private")},h=async o=>{if(!confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ"))return;let k={};if(o.isLegacy)k={note:""};else if(k={notes:(l.notes||[]).filter(M=>M.id!==o.id)},l.internalNotes){const M=l.internalNotes.filter(T=>T.id!==o.id);M.length!==l.internalNotes.length&&(k.internalNotes=M)}await r.update(l.id,k),n("Ø­Ø°Ù Ù…Ù„Ø§Ø­Ø¸Ø©",`Ø­Ø°Ù Ù…Ù„Ø§Ø­Ø¸Ø© Ù„Ù„Ø·Ø§Ù„Ø¨ ${l.name}`),i(A=>({...A,...k})),(c==null?void 0:c.id)===o.id&&(d(null),m(""))},f=o=>{d(o),m(o.text),w(o.type||"private")},p=()=>{const o=window.open("","PRINT","height=800,width=1000"),k=window.location.origin+oe.LOGO,A=`
            <!DOCTYPE html>
            <html lang="ar" dir="rtl">
            <head>
                <meta charset="UTF-8">
                <title>Ø³Ø¬Ù„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª - ${x}</title>
                <style>
                    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap');
                    body { font-family: 'Cairo', sans-serif; padding: 20px; font-size: 12px; color: #333; }
                    .header { text-align: center; border-bottom: 3px solid #fbbf24; padding-bottom: 20px; margin-bottom: 30px; }
                    .logo { height: 70px; margin-bottom: 10px; }
                    .student-box { border: 1px solid #eee; margin-bottom: 20px; border-radius: 8px; overflow: hidden; page-break-inside: avoid; }
                    .student-header { background: #f9fafb; padding: 10px 15px; border-bottom: 1px solid #eee; font-weight: bold; display: flex; justify-content: space-between; }
                    .note-row { padding: 10px 15px; border-bottom: 1px solid #f0f0f0; display: flex; gap: 15px; align-items: flex-start; }
                    .note-label { padding: 2px 8px; border-radius: 4px; font-size: 10px; font-weight: bold; min-width: 80px; text-align: center; }
                    .label-private { background: #fee2e2; color: #991b1b; }
                    .label-public { background: #dcfce7; color: #166534; }
                    .note-text { flex: 1; line-height: 1.5; }
                    .note-date { color: #999; font-size: 10px; margin-top: 4px; }
                </style>
            </head>
            <body>
                <div class="header">
                    <img src="${k}" class="logo" onerror="this.style.display='none'"/>
                    <h2>Ø³Ø¬Ù„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª ÙˆØ§Ù„Ø±Ø³Ø§Ø¦Ù„</h2>
                    <p>Ø§Ù„ÙØ±Ø¹: ${x} | Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date().toLocaleDateString("ar-EG")}</p>
                </div>
                ${u.map(O=>{const M=S(O);return`
                    <div class="student-box">
                        <div class="student-header">
                            <span>${O.name}</span>
                            <span style="color:#666; font-size:11px;">${O.belt}</span>
                        </div>
                        ${M.map(T=>`
                            <div class="note-row">
                                <div>
                                    <div class="note-label ${T.type==="private"?"label-private":"label-public"}">
                                        ${T.type==="private"?"Ø¥Ø¯Ø§Ø±ÙŠØ©":"Ø¹Ø§Ù…Ø©"}
                                    </div>
                                    <div class="note-date">${T.date}</div>
                                </div>
                                <div class="note-text">${T.text}</div>
                            </div>
                        `).join("")}
                    </div>
                    `}).join("")}
                <script>window.onload = function() { window.print(); }<\/script>
            </body>
            </html>
        `;o.document.write(A),o.document.close()},I=S(l);return e.jsxs("div",{className:"h-[calc(100vh-140px)] flex flex-col md:flex-row gap-6 animate-fade-in",children:[e.jsxs("div",{className:"w-full md:w-1/3 flex flex-col gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-100",children:[e.jsxs("h2",{className:"text-lg font-black text-gray-800 flex items-center gap-2 mb-4",children:[e.jsx(ve,{className:"text-yellow-500"})," Ø³Ø¬Ù„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª"]}),e.jsx(Ge,{students:a,onSelect:i,onClear:()=>i(null),placeholder:"Ø§Ø¨Ø­Ø« Ø¹Ù† Ø·Ø§Ù„Ø¨..."}),e.jsxs(L,{onClick:p,variant:"outline",className:"w-full mt-3 text-xs",children:[e.jsx(ue,{size:16})," Ø·Ø¨Ø§Ø¹Ø© ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª"]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 flex-1 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-3 bg-gray-50 border-b border-gray-100 font-bold text-gray-500 text-xs",children:["Ø·Ù„Ø§Ø¨ Ù„Ø¯ÙŠÙ‡Ù… Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ø³Ø¬Ù„Ø© (",u.length,")"]}),e.jsx("div",{className:"overflow-y-auto custom-scrollbar p-2 space-y-1 flex-1",children:u.length>0?u.map(o=>e.jsxs("button",{onClick:()=>i(o),className:`w-full text-right p-3 rounded-xl border transition-all flex justify-between items-center group
                                    ${(l==null?void 0:l.id)===o.id?"bg-yellow-50 border-yellow-400 shadow-sm":"bg-white border-transparent hover:bg-gray-50 hover:border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold ${(l==null?void 0:l.id)===o.id?"bg-yellow-200 text-yellow-800":"bg-gray-100 text-gray-500"}`,children:o.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-sm text-gray-800",children:o.name}),e.jsx("p",{className:"text-[10px] text-gray-400",children:o.belt})]})]}),e.jsxs("div",{className:"flex gap-1",children:[S(o).some(k=>k.type==="private")&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"}),S(o).some(k=>k.type==="public")&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"})]})]},o.id)):e.jsx("div",{className:"text-center py-10 text-gray-400 text-xs",children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ø³Ø¬Ù„Ø©"})})]})]}),e.jsx("div",{className:"w-full md:w-2/3 bg-white rounded-2xl shadow-sm border border-gray-100 flex flex-col overflow-hidden",children:l?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-black text-yellow-500 rounded-xl flex items-center justify-center font-bold text-lg",children:e.jsx(We,{size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-800",children:l.name}),e.jsx("span",{className:"text-xs text-gray-500 bg-gray-200 px-2 py-0.5 rounded text-[10px]",children:l.belt})]})]}),e.jsxs("div",{className:"text-xs text-gray-400 font-mono",children:["ID: ",l.id.substring(0,6)]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar bg-gray-50/30",children:[I.length===0&&e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 opacity-50",children:[e.jsx(ve,{size:48,className:"mb-2"}),e.jsx("p",{children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ø·Ø§Ù„Ø¨"})]}),I.map((o,k)=>e.jsxs("div",{className:`relative group p-4 rounded-2xl border transition-all hover:shadow-md
                                        ${o.type==="private"?"bg-white border-red-100 border-r-4 border-r-red-400":"bg-white border-green-100 border-r-4 border-r-green-400"}
                                        ${(c==null?void 0:c.id)===o.id?"ring-2 ring-yellow-400":""}
                                    `,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[o.type==="private"?e.jsxs("span",{className:"bg-red-100 text-red-700 text-[10px] px-2 py-1 rounded-lg font-bold flex items-center gap-1",children:[e.jsx(ge,{size:10})," Ø¥Ø¯Ø§Ø±ÙŠØ© (Ø®Ø§Øµ)"]}):e.jsxs("span",{className:"bg-green-100 text-green-700 text-[10px] px-2 py-1 rounded-lg font-bold flex items-center gap-1",children:[e.jsx(be,{size:10})," Ø¹Ø§Ù…Ø© (Ù„Ù„Ø·Ø§Ù„Ø¨)"]}),e.jsx("span",{className:"text-[10px] text-gray-400 font-bold",children:o.date}),o.isLegacy&&e.jsx("span",{className:"bg-gray-200 text-gray-600 text-[9px] px-1.5 py-0.5 rounded",children:"Ø³Ø¬Ù„ Ù‚Ø¯ÙŠÙ…"})]}),e.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>f(o),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg",title:"ØªØ¹Ø¯ÙŠÙ„",children:e.jsx(Ee,{size:14})}),e.jsx("button",{onClick:()=>h(o),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"Ø­Ø°Ù",children:e.jsx(de,{size:14})})]})]}),e.jsx("p",{className:"text-gray-700 text-sm whitespace-pre-line leading-relaxed pl-2 border-r-2 border-gray-100 mr-1",children:o.text})]},o.id||k))]}),e.jsxs("div",{className:"p-4 bg-white border-t border-gray-100",children:[c&&e.jsxs("div",{className:"flex justify-between items-center bg-yellow-50 px-3 py-2 rounded-lg mb-2 text-xs text-yellow-800 border border-yellow-200",children:[e.jsx("span",{children:"Ø¬Ø§Ø±ÙŠ ØªØ¹Ø¯ÙŠÙ„ Ù…Ù„Ø§Ø­Ø¸Ø©..."}),e.jsx("button",{onClick:()=>{d(null),m("")},children:e.jsx(xe,{size:14})})]}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsxs("button",{onClick:()=>w("private"),className:`flex-1 py-1.5 text-xs font-bold rounded-lg transition-all flex items-center justify-center gap-1
                                        ${v==="private"?"bg-red-100 text-red-700 ring-1 ring-red-200":"bg-gray-50 text-gray-400 hover:bg-gray-100"}`,children:[e.jsx(ge,{size:12})," Ø®Ø§ØµØ©"]}),e.jsxs("button",{onClick:()=>w("public"),className:`flex-1 py-1.5 text-xs font-bold rounded-lg transition-all flex items-center justify-center gap-1
                                        ${v==="public"?"bg-green-100 text-green-700 ring-1 ring-green-200":"bg-gray-50 text-gray-400 hover:bg-gray-100"}`,children:[e.jsx(be,{size:12})," Ø¹Ø§Ù…Ø©"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{className:"w-full bg-gray-50 border-2 border-gray-100 rounded-xl p-3 pr-4 pl-12 text-sm outline-none focus:border-yellow-400 focus:bg-white transition-all min-h-[50px] max-h-[120px]",placeholder:"Ø§ÙƒØªØ¨ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© Ù‡Ù†Ø§...",value:s,onChange:o=>m(o.target.value)}),e.jsx("button",{onClick:j,disabled:!s.trim(),className:"absolute left-2 bottom-2 bg-black text-yellow-500 p-2 rounded-lg hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:c?e.jsx(Ne,{size:18}):e.jsx(Ce,{size:18})})]})]})]}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-300",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-50 rounded-full flex items-center justify-center mb-4",children:e.jsx(Fe,{size:32})}),e.jsx("p",{className:"font-bold",children:"Ø§Ø®ØªØ± Ø·Ø§Ù„Ø¨Ø§Ù‹ Ù„Ù„Ø¨Ø¯Ø¡"})]})})]})}const Ve=a=>{if(!a)return"expired";const r=new Date,n=new Date(a);r.setHours(0,0,0,0),n.setHours(0,0,0,0);const x=n-r,l=Math.ceil(x/(1e3*60*60*24));return l<0?"expired":l<=7?"near_end":"active"},zs=async(a,r,n,x)=>{try{await Le(he(te,"artifacts",ce,"public","data","activity_logs"),{action:a,details:r,branch:n,performedBy:x.name||"Admin",role:x.role||"admin",timestamp:new Date().toISOString()})}catch(l){console.error("Log error",l)}},ht=({title:a,icon:r,items:n,activeTab:x,onSelect:l})=>{const[i,s]=b.useState(!1),m=b.useRef(null);b.useEffect(()=>{function w(c){m.current&&!m.current.contains(c.target)&&s(!1)}return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[m]);const v=n.some(w=>w.id===x);return e.jsxs("div",{className:"relative",ref:m,children:[e.jsxs("button",{onClick:()=>s(!i),className:`flex items-center gap-2 px-3 py-2 rounded-xl transition-all font-bold text-sm 
                    ${v?"text-yellow-400 bg-gray-800":"text-gray-300 hover:text-white hover:bg-gray-800"}`,children:[e.jsx(r,{size:18}),e.jsx("span",{children:a}),e.jsx(Zt,{size:14,className:`transition-transform ${i?"rotate-180":""}`})]}),i&&e.jsx("div",{className:"absolute top-full right-0 mt-2 w-64 bg-white rounded-xl shadow-xl border border-gray-100 overflow-hidden z-50 animate-fade-in",children:n.map((w,c)=>e.jsxs("button",{onClick:()=>{w.action?w.action():l(w.id),s(!1)},className:`w-full text-right px-4 py-3 flex items-center gap-3 transition-colors text-sm font-bold border-b border-gray-50 last:border-0
                                ${x===w.id?"bg-yellow-50 text-yellow-700":"text-gray-600 hover:bg-gray-50"}
                                ${w.special?"text-green-600 bg-green-50 hover:bg-green-100":""}
                            `,children:[e.jsx(w.icon,{size:16,className:x===w.id?"text-yellow-600":w.special?"text-green-600":"text-gray-400"}),w.label,w.badge>0&&e.jsx("span",{className:"mr-auto bg-red-500 text-white text-[10px] px-1.5 rounded-full",children:w.badge})]},c))})]})},$s=({user:a,selectedBranch:r,studentsCollection:n,scheduleCollection:x,handleLogout:l,onSwitchBranch:i})=>{const[s,m]=b.useState("dashboard"),[v,w]=b.useState(!1),c=le("payments"),d=le("expenses"),S=le("archive"),u=le("registrations"),j=le("captains"),h=le("groups"),f=le("news"),p=le("finance_reasons"),I=le("activity_logs"),o=le("admin_notes"),k=(n==null?void 0:n.data)||[],A=(c==null?void 0:c.data)||[],O=(d==null?void 0:d.data)||[],M=(u==null?void 0:u.data)||[],T=(x==null?void 0:x.data)||[],N=(j==null?void 0:j.data)||[],$=(h==null?void 0:h.data)||[],H=(f==null?void 0:f.data)||[],g=(p==null?void 0:p.data)||[],R=(I==null?void 0:I.data)||[],K=(o==null?void 0:o.data)||[],_=b.useMemo(()=>k.filter(z=>z.branch===r),[k,r]),W=b.useMemo(()=>A.filter(z=>z.branch===r),[A,r]),y=b.useMemo(()=>O.filter(z=>z.branch===r),[O,r]),q=b.useMemo(()=>M.filter(z=>z.branch===r),[M,r]),X=b.useMemo(()=>$.filter(z=>z.branch===r),[$,r]),re=b.useMemo(()=>g.filter(z=>z.branch===r),[g,r]),ae=K,me=b.useMemo(()=>R.filter(z=>z.branch===r).sort((z,Z)=>new Date(Z.timestamp)-new Date(z.timestamp)),[R,r]),D=W.reduce((z,Z)=>z+Number(Z.amount||0),0),P=y.reduce((z,Z)=>z+Number(Z.amount||0),0),U=D-P,E=_.filter(z=>Ve(z.subEnd)==="active").length,t=_.filter(z=>Ve(z.subEnd)==="near_end").length,C=_.filter(z=>Ve(z.subEnd)==="expired").length,F=_.length,G=new Date,Y=`${G.getFullYear()}-${String(G.getMonth()+1).padStart(2,"0")}`,Q=_.reduce((z,Z)=>Z.attendance?z+Object.keys(Z.attendance).filter(fe=>fe.startsWith(Y)).length:z,0),B=(z,Z)=>zs(z,Z,r,a),ee=()=>{if(!confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ­Ù…ÙŠÙ„ Ù†Ø³Ø®Ø© ÙƒØ§Ù…Ù„Ø© Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ"))return;const z={date:new Date().toISOString(),branch:r,students:_,payments:W,expenses:y,registrations:q,schedule:T,news:H,groups:X,captains:N,activityLogs:me,adminNotes:ae},Z="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(z,null,2)),fe=document.createElement("a");fe.setAttribute("href",Z),fe.setAttribute("download",`brave_backup_${r}_${new Date().toISOString().split("T")[0]}.json`),document.body.appendChild(fe),fe.click(),fe.remove()},ne=[{id:"students",icon:ye,label:"Ø§Ù„Ø·Ù„Ø§Ø¨"},{id:"student_notes",icon:Qt,label:"Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª ÙˆØ§Ù„Ø±Ø³Ø§Ø¦Ù„"},{id:"subscriptions",icon:pe,label:"Ø§Ø´ØªØ±Ø§ÙƒØ§Øª"},{id:"tests",icon:Nt,label:"ÙØ­Øµ"},{id:"finance",icon:at,label:"ÙˆØµÙˆÙ„Ø§Øª"},{id:"archive",icon:Oe,label:"Ø§Ù„Ø£Ø±Ø´ÙŠÙ"}],ie=[{id:"registrations",icon:yt,label:"Ø·Ù„Ø¨Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„",badge:q.length},{id:"schedule",icon:Re,label:"Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø­ØµØµ"},{id:"notes",label:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©",icon:ve},{id:"news",icon:we,label:"Ø§Ù„Ø§Ø®Ø¨Ø§Ø± ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶"},{id:"reports",icon:ve,label:"Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ø§Ù…Ù„Ø©"},{id:"captains",icon:qe,label:"Ø§Ù„ÙƒØ¨Ø§ØªÙ† ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª",role:"admin"},{id:"backup",icon:Vt,label:"Ø¨Ø§Ùƒ Ø§Ø¨ Ø¯Ø§ØªØ§Ø¨ÙŠØ³",role:"admin",action:ee,special:!0}].filter(z=>!z.role||z.role===a.role);return e.jsxs("div",{className:"min-h-screen bg-gray-50 text-right font-sans flex flex-col",dir:"rtl",children:[e.jsxs("header",{className:"bg-black text-white shadow-lg sticky top-0 z-40",children:[e.jsxs("div",{className:"container mx-auto px-4 h-16 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:oe.LOGO,alt:"Logo",className:"w-10 h-10 rounded-lg object-contain bg-white",onError:z=>{z.target.style.display="none"}}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-lg hidden md:block",children:"Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø§Ù„Ø´Ø¬Ø§Ø¹"}),e.jsxs("div",{className:"text-xs text-yellow-500 font-bold flex items-center gap-1",children:[a.name,e.jsx("span",{className:"text-gray-500",children:"|"}),r==="Ø´ÙØ§ Ø¨Ø¯Ø±Ø§Ù†"?"ÙØ±Ø¹ Ø´ÙØ§ Ø¨Ø¯Ø±Ø§Ù†":"ÙØ±Ø¹ Ø£Ø¨Ùˆ Ù†ØµÙŠØ±"]})]})]}),e.jsxs("nav",{className:"hidden md:flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>m("dashboard"),className:`flex items-center gap-2 px-3 py-2 rounded-xl transition-all font-bold text-sm ${s==="dashboard"?"text-yellow-400 bg-gray-800":"text-gray-300 hover:text-white hover:bg-gray-800"}`,children:[e.jsx(ke,{size:18})," Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"]}),e.jsx("div",{className:"w-px h-6 bg-gray-700 mx-2"}),e.jsx(ht,{title:"Ø·Ù„Ø§Ø¨",icon:ye,items:ne,activeTab:s,onSelect:m}),e.jsxs("button",{onClick:()=>m("attendance"),className:`flex items-center gap-2 px-4 py-2 mx-2 rounded-xl transition-all font-bold text-sm border-2 border-yellow-500 ${s==="attendance"?"bg-yellow-500 text-black":"text-yellow-500 hover:bg-yellow-500 hover:text-black"}`,children:[e.jsx(Ne,{size:22})," Ø­Ø¶ÙˆØ± ÙˆØºÙŠØ§Ø¨"]}),e.jsx(ht,{title:"Ø§Ù„Ø§Ø¯Ø§Ø±Ø©",icon:qe,items:ie,activeTab:s,onSelect:m})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[i&&e.jsxs("div",{className:"hidden md:block relative group",children:[e.jsx($e,{size:20,className:"text-gray-400 group-hover:text-yellow-500 cursor-pointer"}),e.jsxs("select",{value:r,onChange:z=>i(z.target.value),className:"absolute inset-0 opacity-0 cursor-pointer",children:[e.jsx("option",{value:"Ø´ÙØ§ Ø¨Ø¯Ø±Ø§Ù†",children:"Ø´ÙØ§ Ø¨Ø¯Ø±Ø§Ù†"}),e.jsx("option",{value:"Ø£Ø¨Ùˆ Ù†ØµÙŠØ±",children:"Ø£Ø¨Ùˆ Ù†ØµÙŠØ±"})]})]}),e.jsx("button",{onClick:l,className:"p-2 text-red-400 hover:bg-gray-800 rounded-lg transition-colors",title:"Ø®Ø±ÙˆØ¬",children:e.jsx(ut,{size:20})}),e.jsx("button",{className:"md:hidden p-2 text-white",onClick:()=>w(!v),children:v?e.jsx(xe,{size:24}):e.jsx(gt,{size:24})})]})]}),v&&e.jsxs("div",{className:"md:hidden bg-gray-900 border-t border-gray-800 p-4 space-y-4 animate-fade-in absolute w-full left-0 z-50 shadow-2xl h-[calc(100vh-64px)] overflow-y-auto",children:[i&&e.jsxs("div",{className:"bg-gray-800 p-3 rounded-xl flex items-center justify-between mb-4",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ:"}),e.jsxs("select",{value:r,onChange:z=>i(z.target.value),className:"bg-black text-yellow-500 font-bold p-2 rounded-lg outline-none text-sm",children:[e.jsx("option",{value:"Ø´ÙØ§ Ø¨Ø¯Ø±Ø§Ù†",children:"Ø´ÙØ§ Ø¨Ø¯Ø±Ø§Ù†"}),e.jsx("option",{value:"Ø£Ø¨Ùˆ Ù†ØµÙŠØ±",children:"Ø£Ø¨Ùˆ Ù†ØµÙŠØ±"})]})]}),e.jsxs("button",{onClick:()=>{m("dashboard"),w(!1)},className:"w-full flex items-center gap-3 p-3 rounded-xl bg-gray-800 text-white font-bold",children:[e.jsx(ke,{size:20,className:"text-yellow-500"})," Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"]}),e.jsxs("button",{onClick:()=>{m("attendance"),w(!1)},className:"w-full flex items-center gap-3 p-3 rounded-xl bg-yellow-600 text-white font-bold shadow-lg shadow-yellow-900/20",children:[e.jsx(Ne,{size:20})," Ø­Ø¶ÙˆØ± ÙˆØºÙŠØ§Ø¨"]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-bold text-gray-500 mb-2 px-2 uppercase",children:"Ø·Ù„Ø§Ø¨"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:ne.map(z=>e.jsxs("button",{onClick:()=>{m(z.id),w(!1)},className:`flex flex-col items-center justify-center gap-2 p-3 rounded-xl text-xs font-bold border transition-all ${s===z.id?"bg-yellow-500 text-black border-yellow-500":"bg-gray-800 text-gray-300 border-gray-700"}`,children:[e.jsx(z.icon,{size:20})," ",z.label]},z.id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-bold text-gray-500 mb-2 px-2 uppercase",children:"Ø§Ù„Ø§Ø¯Ø§Ø±Ø©"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:ie.map(z=>e.jsxs("button",{onClick:()=>{z.action?z.action():m(z.id),w(!1)},className:`flex flex-col items-center justify-center gap-2 p-3 rounded-xl text-xs font-bold border transition-all 
                                      ${z.special?"text-green-400 border-green-900 bg-green-900/20":s===z.id?"bg-yellow-500 text-black border-yellow-500":"bg-gray-800 text-gray-300 border-gray-700"}`,children:[e.jsx(z.icon,{size:20})," ",z.label]},z.id))})]})]})]}),e.jsxs("main",{className:"flex-1 w-full px-4 md:px-8 py-6 animate-fade-in mx-auto",children:[s==="dashboard"&&e.jsx(ns,{user:a,selectedBranch:r,branchStudents:_,netProfit:U,totalAttendance:Q,expiredCount:C,activeStudentsCount:E,nearEndCount:t,totalStudents:F,branchRegistrations:q,branchPayments:W,activityLogs:me}),s==="students"&&e.jsx(xs,{students:_,groups:X,studentsCollection:n,archiveCollection:S,selectedBranch:r,logActivity:B}),s==="tests"&&e.jsx(ws,{students:_,studentsCollection:n,logActivity:B}),s==="reports"&&e.jsx(ks,{students:_,payments:W,expenses:y,activityLogs:me,registrations:q,adminNotes:ae,selectedBranch:r}),s==="subscriptions"&&e.jsx(Ds,{students:_,studentsCollection:n,logActivity:B,selectedBranch:r}),s==="finance"&&e.jsx(gs,{students:_,payments:W,expenses:y,paymentsCollection:c,expensesCollection:d,financeReasons:re,financeReasonsCollection:p,selectedBranch:r,logActivity:B}),s==="attendance"&&e.jsx(us,{students:_,groups:X,groupsCollection:h,studentsCollection:n,selectedBranch:r}),s==="registrations"&&e.jsx(js,{registrations:q,students:k,registrationsCollection:u,studentsCollection:n,selectedBranch:r,logActivity:B}),s==="schedule"&&e.jsx(ys,{schedule:T,scheduleCollection:x}),s==="archive"&&e.jsx(ms,{archiveCollection:S,studentsCollection:n,payments:A,logActivity:B}),s==="captains"&&e.jsx(Ns,{captains:N,captainsCollection:j}),s==="news"&&e.jsx(vs,{news:H,newsCollection:f,selectedBranch:r}),s==="notes"&&e.jsx(rs,{}),s==="student_notes"&&e.jsx(Cs,{students:_,studentsCollection:n,logActivity:B,selectedBranch:r})]})]})},Qe="brave-academy-live-data";function Is(){const[a,r]=b.useState(()=>{const j=localStorage.getItem("braveUser");return j?JSON.parse(j):null}),[n,x]=b.useState(()=>typeof window<"u"&&localStorage.getItem("braveUser")?JSON.parse(localStorage.getItem("braveUser")).role==="student"?"student_portal":"admin_dashboard":"home"),[l,i]=b.useState(()=>a&&a.branch?a.branch:se.SHAFA),[s,m]=b.useState(!0),v=le("students"),w=le("schedule"),c=le("news"),d=j=>{x(j),window.history.pushState({view:j},"","")};b.useEffect(()=>{window.history.replaceState({view:n},"","");const j=h=>{h.state&&h.state.view?x(h.state.view):x("home")};return window.addEventListener("popstate",j),()=>window.removeEventListener("popstate",j)},[]);const S=async(j,h)=>{try{const f=he(te,"artifacts",Qe,"public","data","students"),p=ze(f,Se("username","==",j),Se("password","==",h)),I=await Ze(p);if(!I.empty){const O=I.docs[0],M=O.data(),T={role:"student",familyId:M.familyId,name:M.familyName||M.name,id:O.id};r(T),localStorage.setItem("braveUser",JSON.stringify(T)),d("student_portal");return}const o=he(te,"artifacts",Qe,"public","data","captains"),k=ze(o,Se("username","==",j),Se("password","==",h)),A=await Ze(k);if(!A.empty){const O=A.docs[0],M=O.data(),T={role:"captain",...M,id:O.id};r(T),localStorage.setItem("braveUser",JSON.stringify(T)),i(M.branch),d("admin_dashboard");return}if(j.includes("@")||j==="admin1"){let O=j;j==="admin1"&&(O="admin@brave.com"),await St(Be,O,h);return}alert("Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø®Ø§Ø·Ø¦Ø©! ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±.")}catch(f){console.error("Login Error:",f),alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.")}};b.useEffect(()=>{const j=kt(Be,async h=>{if(h){const f=h.email;let p={email:f};f==="admin@brave.com"?p={...p,role:"admin",isSuper:!0,name:"Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…",branch:se.SHAFA}:f==="shafa@brave.com"?p={...p,role:"admin",isSuper:!1,name:"Ù…Ø¯ÙŠØ± Ø´ÙØ§ Ø¨Ø¯Ø±Ø§Ù†",branch:se.SHAFA}:f==="abunseir@brave.com"?p={...p,role:"admin",isSuper:!1,name:"Ù…Ø¯ÙŠØ± Ø£Ø¨Ùˆ Ù†ØµÙŠØ±",branch:se.ABU_NSEIR}:f==="jehad@yahoo.com"?p={...p,role:"admin",isSuper:!1,name:"Ø¬Ù‡Ø§Ø¯ ÙƒØ¹ÙˆØ´",branch:se.ABU_NSEIR}:f==="nseir@brave.com"&&(p={...p,role:"admin",isSuper:!1,name:"ÙƒÙ…Ø§Ù„ ÙƒØ¹ÙˆØ´",branch:se.ABU_NSEIR});try{const I=je(te,"artifacts",Qe,"public","data","admin_profiles",f),o=await Lt(I);o.exists()&&o.data().name&&(p.name=o.data().name)}catch{console.log("Profile fetch warning")}r(p),i(p.branch),localStorage.setItem("braveUser",JSON.stringify(p)),x("admin_dashboard")}else localStorage.getItem("braveUser")||r(null);m(!1)});return()=>j()},[]);const u=async()=>{await Dt(Be),localStorage.removeItem("braveUser"),r(null),d("home")};return s&&a?e.jsx("div",{className:"flex h-screen items-center justify-center font-bold text-xl text-yellow-600 bg-gray-50",children:"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª..."}):e.jsxs(e.Fragment,{children:[n==="home"&&e.jsx(ss,{setView:d,schedule:w.data}),n==="login"&&e.jsx(as,{setView:d,handleLogin:S}),n==="student_portal"&&a&&e.jsx(ls,{user:a,students:v.data,schedule:w.data,news:c.data,handleLogout:u}),n==="admin_dashboard"&&a&&e.jsx($s,{user:a,selectedBranch:l,onSwitchBranch:a.isSuper?i:null,studentsCollection:v,scheduleCollection:w,handleLogout:u})]})}vt(document.getElementById("root")).render(e.jsx(b.StrictMode,{children:e.jsx(Is,{})}));
